/*! For license information please see 709.js.LICENSE.txt */
"use strict";(self.webpackChunkstarling_word_addin=self.webpackChunkstarling_word_addin||[]).push([[709],{85709:function(n,t,e){function s(n){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},s(n)}function a(n,t){var e="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!e){if(Array.isArray(n)||(e=function(n,t){if(n){if("string"==typeof n)return i(n,t);var e={}.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?i(n,t):void 0}}(n))||t&&n&&"number"==typeof n.length){e&&(n=e);var s=0,a=function(){};return{s:a,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(n){throw n},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,r=!1;return{s:function(){e=e.call(n)},n:function(){var n=e.next();return o=n.done,n},e:function(n){r=!0,c=n},f:function(){try{o||null==e.return||e.return()}finally{if(r)throw c}}}}function i(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,s=Array(t);e<t;e++)s[e]=n[e];return s}function c(){c=function(){return t};var n,t={},e=Object.prototype,a=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",r=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function d(n,t,e,s){Object.defineProperty(n,t,{value:e,enumerable:!s,configurable:!s,writable:!s})}try{d({},"")}catch(n){d=function(n,t,e){return n[t]=e}}function u(t,e,s,a){var i=e&&e.prototype instanceof m?e:m,c=Object.create(i.prototype);return d(c,"_invoke",function(t,e,s){var a=1;return function(i,c){if(3===a)throw Error("Generator is already running");if(4===a){if("throw"===i)throw c;return{value:n,done:!0}}for(s.method=i,s.arg=c;;){var o=s.delegate;if(o){var r=x(o,s);if(r){if(r===v)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(1===a)throw a=4,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);a=3;var l=p(t,e,s);if("normal"===l.type){if(a=s.done?4:2,l.arg===v)continue;return{value:l.arg,done:s.done}}"throw"===l.type&&(a=4,s.method="throw",s.arg=l.arg)}}}(t,s,new E(a||[])),!0),c}function p(n,t,e){try{return{type:"normal",arg:n.call(t,e)}}catch(n){return{type:"throw",arg:n}}}t.wrap=u;var v={};function m(){}function g(){}function f(){}var h={};d(h,o,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(R([])));b&&b!==e&&a.call(b,o)&&(h=b);var w=f.prototype=m.prototype=Object.create(h);function C(n){["next","throw","return"].forEach((function(t){d(n,t,(function(n){return this._invoke(t,n)}))}))}function k(n,t){function e(i,c,o,r){var l=p(n[i],n,c);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==s(u)&&a.call(u,"__await")?t.resolve(u.__await).then((function(n){e("next",n,o,r)}),(function(n){e("throw",n,o,r)})):t.resolve(u).then((function(n){d.value=n,o(d)}),(function(n){return e("throw",n,o,r)}))}r(l.arg)}var i;d(this,"_invoke",(function(n,s){function a(){return new t((function(t,a){e(n,s,t,a)}))}return i=i?i.then(a,a):a()}),!0)}function x(t,e){var s=e.method,a=t.i[s];if(a===n)return e.delegate=null,"throw"===s&&t.i.return&&(e.method="return",e.arg=n,x(t,e),"throw"===e.method)||"return"!==s&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+s+"' method")),v;var i=p(a,t.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,v;var c=i.arg;return c?c.done?(e[t.r]=c.value,e.next=t.n,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,v):c:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function S(n){this.tryEntries.push(n)}function A(t){var e=t[4]||{};e.type="normal",e.arg=n,t[4]=e}function E(n){this.tryEntries=[[-1]],n.forEach(S,this),this.reset(!0)}function R(t){if(null!=t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,c=function e(){for(;++i<t.length;)if(a.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=n,e.done=!0,e};return c.next=c}}throw new TypeError(s(t)+" is not iterable")}return g.prototype=f,d(w,"constructor",f),d(f,"constructor",g),d(f,l,g.displayName="GeneratorFunction"),t.isGeneratorFunction=function(n){var t="function"==typeof n&&n.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,d(n,l,"GeneratorFunction")),n.prototype=Object.create(w),n},t.awrap=function(n){return{__await:n}},C(k.prototype),d(k.prototype,r,(function(){return this})),t.AsyncIterator=k,t.async=function(n,e,s,a,i){void 0===i&&(i=Promise);var c=new k(u(n,e,s,a),i);return t.isGeneratorFunction(e)?c:c.next().then((function(n){return n.done?n.value:c.next()}))},C(w),d(w,l,"Generator"),d(w,o,(function(){return this})),d(w,"toString",(function(){return"[object Generator]"})),t.keys=function(n){var t=Object(n),e=[];for(var s in t)e.unshift(s);return function n(){for(;e.length;)if((s=e.pop())in t)return n.value=s,n.done=!1,n;return n.done=!0,n}},t.values=R,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var n=this.tryEntries[0][4];if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function s(n){c.type="throw",c.arg=t,e.next=n}for(var a=e.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i[4],o=this.prev,r=i[1],l=i[2];if(-1===i[0])return s("end"),!1;if(!r&&!l)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=o){if(o<r)return this.method="next",this.arg=n,s(r),!0;if(o<l)return s(l),!1}}},abrupt:function(n,t){for(var e=this.tryEntries.length-1;e>=0;--e){var s=this.tryEntries[e];if(s[0]>-1&&s[0]<=this.prev&&this.prev<s[2]){var a=s;break}}a&&("break"===n||"continue"===n)&&a[0]<=t&&t<=a[2]&&(a=null);var i=a?a[4]:{};return i.type=n,i.arg=t,a?(this.method="next",this.next=a[2],v):this.complete(i)},complete:function(n,t){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&t&&(this.next=t),v},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e[2]===n)return this.complete(e[4],e[3]),A(e),v}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e[0]===n){var s=e[4];if("throw"===s.type){var a=s.arg;A(e)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,e,s){return this.delegate={i:R(t),r:e,n:s},"next"===this.method&&(this.arg=n),v}},t}function o(n,t,e,s,a,i,c){try{var o=n[i](c),r=o.value}catch(n){return void e(n)}o.done?t(r):Promise.resolve(r).then(s,a)}function r(n){return function(){var t=this,e=arguments;return new Promise((function(s,a){var i=n.apply(t,e);function c(n){o(i,s,a,c,r,"next",n)}function r(n){o(i,s,a,c,r,"throw",n)}c(void 0)}))}}function l(n,t,e,s){var a=document.getElementById("results-content"),i=document.getElementById("results-section"),c=n.contract_structure,o=c.articles.reduce((function(n,t){return n+t.clauses.filter((function(n){var t;return null===(t=n.changeStatus)||void 0===t?void 0:t.isModified})).length}),0),r=c.articles.reduce((function(n,t){return n+t.clauses.length}),0),l='\n    <div class="analysis-results">\n      \x3c!-- 1. CONTRACT STRUCTURE BREAKDOWN (FIRST) --\x3e\n      <div class="analysis-section contract-structure">\n        <h3>📋 Contract Structure</h3>\n        <div class="structure-overview">\n          <p><strong>Total Articles:</strong> '.concat(c.articles.length,"</p>\n          <p><strong>Total Clauses:</strong> ").concat(r,'</p>\n        </div>\n        \n        <div class="articles-breakdown">');c.articles.forEach((function(n){l+='\n          <div class="article-item">\n            <h4 class="article-title">'.concat(n.number,". ").concat(n.title,'</h4>\n            <div class="clauses-list">'),n.clauses.forEach((function(n){var t,e,s=null!==(t=n.changeStatus)&&void 0!==t&&t.isModified?"modified":"unmodified",a=null!==(e=n.changeStatus)&&void 0!==e&&e.isModified?"red":"green";l+='\n              <div class="clause-item '.concat(s,'">\n                <span class="clause-number" style="color: ').concat(a,';">').concat(n.number,'</span>\n                <span class="clause-text">').concat(n.text.substring(0,100)).concat(n.text.length>100?"...":"","</span>\n              </div>")})),l+="\n            </div>\n          </div>"})),l+='\n        </div>\n      </div>\n\n      \x3c!-- 2. TRACK CHANGES SUMMARY (AFTER STRUCTURE) --\x3e\n      <div class="analysis-section track-changes-summary">\n        <h3>🔄 Track Changes Summary</h3>\n        '.concat(c.trackChanges?'\n          <div class="change-tracking-info">\n            <p><strong>Track Changes:</strong> '.concat(c.trackChanges.enabled?"Enabled":"Disabled","</p>\n            ").concat(c.trackChanges.enabled?'\n              <p><strong>Modified Clauses:</strong> <span class="modified-count">'.concat(o,"</span> / ").concat(r,'</p>\n              <p><strong>Unmodified Clauses:</strong> <span class="unmodified-count">').concat(r-o,"</span> / ").concat(r,"</p>\n            "):"","\n            ").concat(c.trackChanges.note?'<p class="track-changes-note"><em>'.concat(c.trackChanges.note,"</em></p>"):"","\n            ").concat(c.trackChanges.demoMode?'<p class="demo-note"><em>Demo mode - simulated changes for testing</em></p>':"","\n          </div>\n          ").concat(c.trackChanges.enabled?'\n            <div class="change-legend">\n              <div class="legend-item">\n                <span class="legend-indicator modified"></span>\n                <span>Modified Clause</span>\n              </div>\n              <div class="legend-item">\n                <span class="legend-indicator unmodified"></span>\n                <span>Unmodified Clause</span>\n              </div>\n            </div>\n          ':"","\n        "):"",'\n      </div>\n\n      \x3c!-- 3. EXECUTIVE SUMMARY SECTION --\x3e\n      <div class="analysis-summary">\n        <h3>').concat(s.title,'</h3>\n        <div class="summary-overview">\n          <p>').concat(s.overview,'</p>\n        </div>\n        \n        <div class="summary-metrics">\n          <div class="metric-item">\n            <span class="metric-label">Contract Type:</span>\n            <span class="metric-value">').concat(n.contract_type,'</span>\n          </div>\n          <div class="metric-item">\n            <span class="metric-label">Word Count:</span>\n            <span class="metric-value">').concat(n.word_count,'</span>\n          </div>\n          <div class="metric-item">\n            <span class="metric-label">Compliance Score:</span>\n            <span class="metric-value compliance-score">').concat(n.compliance_score,'%</span>\n          </div>\n          <div class="metric-item">\n            <span class="metric-label">Risk Score:</span>\n            <span class="metric-value risk-score">').concat(t.risk_score,'%</span>\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- 4. DETAILED ANALYSIS SECTIONS --\x3e\n      <div class="detailed-analysis">\n        \n        \x3c!-- Risk Analysis --\x3e\n        <div class="analysis-section risks">\n          <h3>⚠️ Risk Analysis</h3>\n          <p class="section-summary">').concat(t.summary,'</p>\n          \n          <div class="risks-list">'),t.risks.forEach((function(n){var t="severity-".concat(n.severity);l+='\n            <div class="risk-item '.concat(t,'">\n              <div class="risk-header">\n                <span class="risk-severity">').concat(n.severity.toUpperCase(),'</span>\n                <span class="risk-title">').concat(n.title,'</span>\n              </div>\n              <p class="risk-description">').concat(n.description,'</p>\n              <p class="risk-suggestion"><strong>Suggestion:</strong> ').concat(n.suggestion,"</p>\n            </div>")})),l+='\n          </div>\n        </div>\n\n        \x3c!-- Change Suggestions --\x3e\n        <div class="analysis-section suggestions">\n          <h3>💡 Improvement Suggestions</h3>\n          <p class="section-summary">'.concat(e.summary,'</p>\n          \n          <div class="suggestions-list">'),e.suggestions.forEach((function(n){var t="priority-".concat(n.priority);l+='\n            <div class="suggestion-item '.concat(t,'">\n              <div class="suggestion-header">\n                <span class="suggestion-priority">').concat(n.priority.toUpperCase(),'</span>\n                <span class="suggestion-title">').concat(n.title,'</span>\n              </div>\n              <div class="suggestion-details">\n                <p><strong>Current:</strong> ').concat(n.current,"</p>\n                <p><strong>Suggested:</strong> ").concat(n.suggested,"</p>\n                <p><strong>Benefit:</strong> ").concat(n.benefit,"</p>\n              </div>\n            </div>")})),l+='\n          </div>\n        </div>\n\n        \x3c!-- Key Terms --\x3e\n        <div class="analysis-section key-terms">\n          <h3>🔑 Key Terms Identified</h3>\n          <div class="terms-list">',n.key_terms.forEach((function(n){l+='<span class="term-tag">'.concat(n,"</span>")})),l+='\n          </div>\n        </div>\n\n        \x3c!-- Recommendations --\x3e\n        <div class="analysis-section recommendations">\n          <h3>📝 Recommendations</h3>\n          <ul class="recommendations-list">',n.recommendations.forEach((function(n){l+="<li>".concat(n,"</li>")})),l+="\n          </ul>\n        </div>\n      </div>\n    </div>",a.innerHTML=l,i.style.display="block",d(e)}function d(n){var t=document.getElementById("suggestions-section"),e=document.getElementById("suggestions-content"),s='\n    <div class="suggestions-header">\n      <h3>💡 Contract Improvement Suggestions</h3>\n      <p>Review and apply the following suggestions to improve your contract:</p>\n    </div>\n    \n    <div class="suggestions-list">';n.suggestions.forEach((function(n,t){var e="priority-".concat(n.priority);s+='\n      <div class="suggestion-card '.concat(e,'">\n        <div class="suggestion-header">\n          <span class="priority-badge ').concat(n.priority,'">').concat(n.priority.toUpperCase(),"</span>\n          <h4>").concat(n.title,'</h4>\n        </div>\n        <div class="suggestion-content">\n          <div class="current-state">\n            <strong>Current:</strong> ').concat(n.current,'\n          </div>\n          <div class="suggested-change">\n            <strong>Suggested:</strong> ').concat(n.suggested,'\n          </div>\n          <div class="benefit">\n            <strong>Benefit:</strong> ').concat(n.benefit,'\n          </div>\n        </div>\n        <div class="suggestion-actions">\n          <button class="apply-suggestion-btn" onclick="applySuggestion(').concat(t,')">\n            Apply This Change\n          </button>\n        </div>\n      </div>')})),s+='\n    </div>\n    \n    <div class="suggestions-actions">\n      <button id="apply-all-changes-btn" class="primary-button" onclick="applyAllChanges()">\n        Apply All Changes\n      </button>\n      <button id="dismiss-suggestions-btn" class="secondary-button" onclick="dismissSuggestions()">\n        Dismiss Suggestions\n      </button>\n    </div>',e.innerHTML=s,t.style.display="block"}function u(n){var t,e,s=document.getElementById("results-content"),a=document.getElementById("results-section"),i='\n    <div class="contract-results">\n      <h3>✅ Contract Generated Successfully</h3>\n      <div class="contract-info">\n        <p><strong>Contract Type:</strong> '.concat((null===(t=n.metadata)||void 0===t?void 0:t.template_used)||"Content Management Agreement","</p>\n        <p><strong>Generated:</strong> ").concat(new Date((null===(e=n.metadata)||void 0===e?void 0:e.generated_at)||new Date).toLocaleString(),'</p>\n        <p><strong>Status:</strong> <span class="status-success">Ready for Review</span></p>\n      </div>\n      \n      <div class="contract-actions">\n        <button id="review-contract-btn" class="primary-button" onclick="reviewGeneratedContract()">\n          📋 Review Contract\n        </button>\n        <button id="analyze-new-contract-btn" class="secondary-button" onclick="analyzeContract()">\n          🔍 Analyze Generated Contract\n        </button>\n      </div>\n      \n      <div class="next-steps">\n        <h4>Next Steps:</h4>\n        <ul>\n          <li>Review the generated contract content</li>\n          <li>Run contract analysis to check for risks</li>\n          <li>Make any necessary modifications</li>\n          <li>Save and share with relevant parties</li>\n        </ul>\n      </div>\n    </div>');s.innerHTML=i,a.style.display="block"}function p(n){var t=document.getElementById("results-content"),e=document.getElementById("results-section");if(n.structured_analysis){var s=n.structured_analysis,a='\n    <div class="structured-analysis-results">\n      <div class="analysis-header">\n        <h2>📋 AI Contract Analysis Report</h2>\n        <div class="analysis-meta">\n          <p><strong>Contract Type:</strong> '.concat(n.contract_type,"</p>\n          <p><strong>Analysis Date:</strong> ").concat(new Date(s.analysis_timestamp).toLocaleString(),"</p>\n          <p><strong>AI Prompt:</strong> ").concat(s.ai_prompt_used,'</p>\n        </div>\n      </div>\n\n      \x3c!-- 1. ARTICLE STRUCTURE (Following numbering: 1, 1.1, 1.1.1, 2, 2.1, etc.) --\x3e\n      <div class="analysis-section article-structure">\n        <h3>📑 Contract Structure Analysis</h3>\n        <div class="structure-summary">\n          <p>Articles identified and numbered according to legal standards:</p>\n        </div>\n\n        <div class="articles-breakdown">');s.article_structure.forEach((function(n){a+='\n          <div class="article-container">\n            <div class="article-header">\n              <h4 class="article-number">Article '.concat(n.number,'</h4>\n              <h5 class="article-title">').concat(n.title,'</h5>\n            </div>\n\n            <div class="clauses-container">'),n.clauses.forEach((function(n){a+='\n              <div class="clause-item">\n                <span class="clause-number">'.concat(n.number,'</span>\n                <div class="clause-content">\n                  <p>').concat(n.content,'</p>\n                  <small class="line-reference">Line ').concat(n.line_number,"</small>\n                </div>\n              </div>")})),a+="\n            </div>\n          </div>"})),a+='\n        </div>\n      </div>\n\n      \x3c!-- 2. DEVIATION ANALYSIS --\x3e\n      <div class="analysis-section deviation-analysis">\n        <h3>⚖️ Standard Library Comparison</h3>\n        <div class="deviations-summary">\n          <p>Deviations from company standard clauses:</p>\n        </div>\n\n        <div class="deviations-list">',s.deviation_analysis.forEach((function(n){var t="negotiable"===n.negotiable_status?"negotiable":"non-negotiable",e="risk-".concat(n.risk_level);a+='\n          <div class="deviation-item '.concat(t," ").concat(e,'">\n            <div class="deviation-header">\n              <span class="clause-ref">Clause ').concat(n.clause_reference,'</span>\n              <span class="negotiable-badge ').concat(n.negotiable_status,'">\n                ').concat(n.negotiable_status.toUpperCase(),'\n              </span>\n              <span class="risk-badge ').concat(n.risk_level,'">\n                ').concat(n.risk_level.toUpperCase(),' RISK\n              </span>\n            </div>\n\n            <div class="deviation-content">\n              <h5>').concat(n.clause_title,'</h5>\n              <p class="deviation-description">').concat(n.deviation_description,'</p>\n\n              <div class="language-comparison">\n                <div class="current-language">\n                  <strong>Current Language:</strong>\n                  <p>').concat(n.current_language,'</p>\n                </div>\n                <div class="standard-language">\n                  <strong>Standard Library:</strong>\n                  <p>').concat(n.standard_language,'</p>\n                </div>\n              </div>\n\n              <div class="business-impact">\n                <strong>Business Impact:</strong> ').concat(n.business_impact,"\n              </div>\n            </div>\n          </div>")})),a+='\n        </div>\n      </div>\n\n      \x3c!-- 3. IMPROVEMENT RECOMMENDATIONS --\x3e\n      <div class="analysis-section improvement-recommendations">\n        <h3>💡 Improvement Recommendations</h3>\n        <div class="recommendations-summary">\n          <p>Specific language revisions and compliance recommendations:</p>\n        </div>\n\n        <div class="recommendations-list">',s.improvement_recommendations.forEach((function(n){var t="priority-".concat(n.priority),e="type-".concat(n.recommendation_type);a+='\n          <div class="recommendation-item '.concat(t," ").concat(e,'">\n            <div class="recommendation-header">\n              <span class="clause-ref">Clause ').concat(n.clause_reference,'</span>\n              <span class="priority-badge ').concat(n.priority,'">\n                ').concat(n.priority.toUpperCase(),'\n              </span>\n              <span class="type-badge ').concat(n.recommendation_type,'">\n                ').concat(n.recommendation_type.toUpperCase(),'\n              </span>\n            </div>\n\n            <div class="recommendation-content">\n              <div class="risk-score">\n                <strong>Current Risk Score:</strong>\n                <span class="score">').concat(n.current_risk_score,'/100</span>\n              </div>\n\n              <div class="improved-language">\n                <strong>Recommended Language:</strong>\n                <p>').concat(n.improved_language,'</p>\n              </div>\n\n              <div class="benefits">\n                <div class="risk-mitigation">\n                  <strong>Risk Mitigation:</strong> ').concat(n.risk_mitigation,'\n                </div>\n                <div class="business-benefit">\n                  <strong>Business Benefit:</strong> ').concat(n.business_benefit,'\n                </div>\n              </div>\n\n              <div class="implementation">\n                <strong>Implementation Notes:</strong> ').concat(n.implementation_notes,"\n              </div>\n            </div>\n          </div>")})),a+='\n        </div>\n      </div>\n\n      \x3c!-- 4. SUMMARY METRICS --\x3e\n      <div class="analysis-section summary-metrics">\n        <h3>📊 Analysis Summary</h3>\n        <div class="metrics-grid">\n          <div class="metric-card">\n            <span class="metric-label">Total Articles</span>\n            <span class="metric-value">'.concat(s.article_structure.length,'</span>\n          </div>\n          <div class="metric-card">\n            <span class="metric-label">Deviations Found</span>\n            <span class="metric-value">').concat(s.deviation_analysis.length,'</span>\n          </div>\n          <div class="metric-card">\n            <span class="metric-label">Recommendations</span>\n            <span class="metric-value">').concat(s.improvement_recommendations.length,'</span>\n          </div>\n          <div class="metric-card">\n            <span class="metric-label">Compliance Score</span>\n            <span class="metric-value">').concat(n.compliance_score,"%</span>\n          </div>\n        </div>\n      </div>\n    </div>"),t.innerHTML=a,e.style.display="block",s.improvement_recommendations.length>0&&function(n){var t=document.getElementById("suggestions-section"),e=document.getElementById("suggestions-content"),s='\n    <div class="structured-suggestions-header">\n      <h3>🔧 Apply Recommended Changes</h3>\n      <p>Review and apply AI-recommended improvements to optimize your contract:</p>\n    </div>\n\n    <div class="structured-suggestions-list">';n.forEach((function(n,t){var e="priority-".concat(n.priority),a="type-".concat(n.recommendation_type);s+='\n      <div class="structured-suggestion-card '.concat(e," ").concat(a,'">\n        <div class="suggestion-header">\n          <span class="clause-ref">Clause ').concat(n.clause_reference,'</span>\n          <span class="priority-badge ').concat(n.priority,'">').concat(n.priority.toUpperCase(),'</span>\n          <span class="type-badge ').concat(n.recommendation_type,'">').concat(n.recommendation_type.toUpperCase(),'</span>\n        </div>\n        <div class="suggestion-content">\n          <div class="risk-info">\n            <strong>Current Risk Score:</strong> <span class="risk-score">').concat(n.current_risk_score,'/100</span>\n          </div>\n          <div class="improved-language">\n            <strong>Recommended Language:</strong>\n            <p>').concat(n.improved_language,'</p>\n          </div>\n          <div class="benefits">\n            <p><strong>Business Benefit:</strong> ').concat(n.business_benefit,'</p>\n          </div>\n        </div>\n        <div class="suggestion-actions">\n          <button class="apply-structured-suggestion-btn" onclick="applyStructuredSuggestion(').concat(t,')">\n            Apply This Change\n          </button>\n        </div>\n      </div>')})),s+='\n    </div>\n\n    <div class="structured-suggestions-actions">\n      <button id="apply-all-structured-changes-btn" class="primary-button" onclick="applyAllStructuredChanges()">\n        Apply All Recommendations\n      </button>\n      <button id="dismiss-structured-suggestions-btn" class="secondary-button" onclick="dismissSuggestions()">\n        Dismiss Suggestions\n      </button>\n    </div>',e.innerHTML=s,t.style.display="block"}(s.improvement_recommendations)}else console.log("No structured analysis found, using legacy display")}function v(n){var t,s=document.getElementById("results-content"),a=document.getElementById("results-section"),i=n.acceptabilityStatus,o=n.complianceAnalysis,l=n.revisionPlan,d=(n.nonAcceptableClauses,n.clauseBreakdown),u={"ready-for-legal":"status-success","minor-revisions":"status-warning","major-revisions":"status-error","not-acceptable":"status-critical"}[i.status]||"status-info",p='\n    <div class="contract-review-results">\n      \x3c!-- Overall Status Header --\x3e\n      <div class="review-header">\n        <h2>📋 Contract Review Results</h2>\n        <div class="acceptability-status '.concat(u,'">\n          <div class="status-indicator">\n            <span class="status-icon">').concat((t=i.status,{"ready-for-legal":"✅","minor-revisions":"⚠️","major-revisions":"🔧","not-acceptable":"❌"}[t]||"📋"),'</span>\n            <span class="status-text">').concat(i.message,'</span>\n          </div>\n          <div class="status-metrics">\n            <span class="metric">\n              <strong>').concat(i.acceptablePercentage,'%</strong> Acceptable\n            </span>\n            <span class="metric">\n              <strong>').concat(i.problematicClauses,'</strong> Issues Found\n            </span>\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- Quick Actions --\x3e\n      <div class="review-actions">\n        ').concat(function(n,t){var e="";if("ready-for-legal"===n.status)e='\n      <button class="primary-button" onclick="submitToLegal()">\n        📤 Submit to Legal Review\n      </button>\n      <button class="secondary-button" onclick="generateContractSummary()">\n        📄 Generate Summary\n      </button>';else if(t.totalRevisions>0){var s=t.revisions.filter((function(n){return n.autoReplaceable})).length;e='\n      <button class="primary-button" onclick="applyAutomaticRevisions()" '.concat(0===s?"disabled":"",">\n        🔧 Apply ").concat(s,' Automatic Revisions\n      </button>\n      <button class="secondary-button" onclick="reviewManualChanges()">\n        👁️ Review Manual Changes (').concat(t.totalRevisions-s,')\n      </button>\n      <button class="tertiary-button" onclick="rerunAnalysis()">\n        🔄 Re-run Analysis\n      </button>')}return e}(i,l),'\n      </div>\n\n      \x3c!-- Compliance Overview --\x3e\n      <div class="compliance-overview">\n        <h3>📊 Compliance Analysis</h3>\n        <div class="compliance-grid">\n          <div class="compliance-card acceptable">\n            <div class="card-number">').concat(o.acceptableClauses.length,'</div>\n            <div class="card-label">Acceptable Clauses</div>\n          </div>\n          <div class="compliance-card problematic">\n            <div class="card-number">').concat(o.problematicClauses.length,'</div>\n            <div class="card-label">Issues Found</div>\n          </div>\n          <div class="compliance-card missing">\n            <div class="card-number">').concat(o.missingClauses.length,'</div>\n            <div class="card-label">Missing Clauses</div>\n          </div>\n          <div class="compliance-card score">\n            <div class="card-number">').concat(o.overallScore,'%</div>\n            <div class="card-label">Compliance Score</div>\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- Detailed Clause Breakdown --\x3e\n      ').concat(function(n){if(!n)return'<div class="clause-breakdown-section"><p>Clause breakdown not available.</p></div>';var t=n.clausesNeedingModification>0;return'\n    <div class="clause-breakdown-section">\n      <div class="breakdown-header">\n        <h3>📋 Article & Clause Analysis</h3>\n        <div class="breakdown-summary">\n          <span class="summary-item acceptable">\n            ✅ '.concat(n.clausesAcceptable,' Acceptable\n          </span>\n          <span class="summary-item needs-modification">\n            🔧 ').concat(n.clausesNeedingModification," Need Modification\n          </span>\n        </div>\n      </div>\n\n      ").concat(t?'\n        <div class="auto-update-controls">\n          <label class="auto-update-checkbox">\n            <input type="checkbox" id="auto-update-all" onchange="toggleAutoUpdate(this.checked)">\n            <span class="checkmark"></span>\n            Automatically Update All Clauses\n          </label>\n          <button class="accept-all-button" onclick="acceptAllChanges()" '.concat(t?"":"disabled",">\n            ✅ Accept All Changes (").concat(n.clausesNeedingModification,")\n          </button>\n        </div>"):"",'\n\n      <div class="articles-container">\n        ').concat(n.articles.map((function(n){return function(n){return'\n    <div class="article-section">\n      <div class="article-header">\n        <h4>'.concat(n.articleNumber,". ").concat(n.title,'</h4>\n        <div class="article-summary">\n          ').concat(n.clausesNeedingModification>0?'<span class="modification-count">'.concat(n.clausesNeedingModification," modification").concat(n.clausesNeedingModification>1?"s":""," needed</span>"):'<span class="no-modifications">No modifications needed</span>','\n        </div>\n      </div>\n\n      <div class="clauses-container">\n        ').concat(n.clauses.map((function(n){return function(n){var t=n.needsModification?"🔧":"✅",e=n.needsModification?"needs-modification":"acceptable",s=n.needsModification?"Will be modified":"No changes needed";return'\n    <div class="clause-item '.concat(e,'" data-clause-number="').concat(n.clauseNumber,'">\n      <div class="clause-header">\n        <div class="clause-number-status">\n          <span class="clause-number">').concat(n.clauseNumber,'</span>\n          <span class="status-indicator">\n            <span class="status-icon">').concat(t,'</span>\n            <span class="status-text">').concat(s,"</span>\n          </span>\n        </div>\n        ").concat(n.needsModification?'\n          <div class="clause-actions">\n            <button class="modify-button" onclick="applyClauseModification(\''.concat(n.clauseNumber,'\')">\n              🔧 Apply Change\n            </button>\n            <button class="preview-button" onclick="previewClauseChange(\'').concat(n.clauseNumber,"')\">\n              👁️ Preview\n            </button>\n          </div>"):"",'\n      </div>\n\n      <div class="clause-content">\n        <div class="current-text">\n          <strong>Current:</strong> ').concat(n.text.substring(0,150)).concat(n.text.length>150?"...":"","\n        </div>\n\n        ").concat(n.needsModification&&n.recommendedText?'\n          <div class="recommended-text">\n            <strong>Recommended:</strong> '.concat(n.recommendedText.substring(0,150)).concat(n.recommendedText.length>150?"...":"",'\n          </div>\n          <div class="change-reason">\n            <strong>Reason:</strong> ').concat(n.changeReason,"\n          </div>"):"","\n      </div>\n    </div>")}(n)})).join(""),"\n      </div>\n    </div>")}(n)})).join(""),"\n      </div>\n    </div>")}(d),'\n\n      \x3c!-- Next Steps --\x3e\n      <div class="next-steps-section">\n        <h3>📝 Next Steps</h3>\n        <ol class="next-steps-list">\n          ').concat(i.nextSteps.map((function(n){return"<li>".concat(n,"</li>")})).join(""),'\n        </ol>\n      </div>\n\n      \x3c!-- Detailed Issues (Collapsible) --\x3e\n      <div class="detailed-issues">\n        <h3>🔍 Detailed Analysis</h3>\n        <div class="issues-accordion">\n          ').concat(function(n){return'\n    <div class="accordion-item">\n      <div class="accordion-header" onclick="toggleAccordion(\'problematic-clauses\')">\n        <span>❌ Problematic Clauses ('.concat(n.problematicClauses.length,')</span>\n        <span class="accordion-icon">▼</span>\n      </div>\n      <div class="accordion-content" id="problematic-clauses">\n        ').concat(n.problematicClauses.map((function(n){return'\n          <div class="issue-item">\n            <strong>Clause '.concat(n.clauseId,":</strong> ").concat(n.issues.map((function(n){return n.description})).join(", "),"\n          </div>\n        ")})).join(""),'\n      </div>\n    </div>\n\n    <div class="accordion-item">\n      <div class="accordion-header" onclick="toggleAccordion(\'missing-clauses\')">\n        <span>➕ Missing Clauses (').concat(n.missingClauses.length,')</span>\n        <span class="accordion-icon">▼</span>\n      </div>\n      <div class="accordion-content" id="missing-clauses">\n        ').concat(n.missingClauses.map((function(n){return'\n          <div class="issue-item">\n            <strong>'.concat(n.title,":</strong> ").concat(n.content.substring(0,100),"...\n          </div>\n        ")})).join(""),"\n      </div>\n    </div>")}(o),"\n        </div>\n      </div>\n    </div>");s.innerHTML=p,a.style.display="block",function(n){window.currentReviewResults=n,window.toggleAccordion=function(n){var t=document.getElementById(n),e=t.previousElementSibling.querySelector(".accordion-icon");"none"!==t.style.display&&t.style.display?(t.style.display="none",e.textContent="▼"):(t.style.display="block",e.textContent="▲")},window.applyClauseModification=function(){var n=r(c().mark((function n(t){var s,a,i,o,r,l,d;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.e(75).then(e.bind(e,23075));case 3:return s=n.sent,a=s.contractReviewer,n.next=7,e.e(199).then(e.bind(e,79199));case 7:if(i=n.sent,o=i.updateStatus,(r=m(t))&&r.recommendedText){n.next=13;break}return o("No recommended text found for clause ".concat(t),"error"),n.abrupt("return");case 13:return o("Applying modification to clause ".concat(t,"..."),"info"),n.next=16,a.applyClauseModification(t,r.recommendedText);case 16:(l=n.sent).success?(o("Clause ".concat(t," modified successfully!"),"success"),g(t,!0),(d=document.getElementById("auto-update-all"))&&d.checked&&setTimeout((function(){var n;(n=document.querySelector(".clause-item.needs-modification .modify-button"))&&n.click()}),500)):o("Failed to modify clause ".concat(t,": ").concat(l.error),"error"),n.next=27;break;case 20:return n.prev=20,n.t0=n.catch(0),n.next=24,e.e(199).then(e.bind(e,79199));case 24:(0,n.sent.updateStatus)("Error modifying clause ".concat(t,": ").concat(n.t0.message),"error");case 27:case"end":return n.stop()}}),n,null,[[0,20]])})));return function(t){return n.apply(this,arguments)}}(),window.previewClauseChange=function(n){var t=m(n);if(t){var e=document.createElement("div");e.className="clause-preview-modal",e.innerHTML='\n      <div class="modal-content">\n        <div class="modal-header">\n          <h3>Preview Change - Clause '.concat(n,'</h3>\n          <button class="close-modal" onclick="closePreviewModal()">&times;</button>\n        </div>\n        <div class="modal-body">\n          <div class="before-after">\n            <div class="before-section">\n              <h4>Current Text:</h4>\n              <div class="text-content">').concat(t.text,'</div>\n            </div>\n            <div class="after-section">\n              <h4>Recommended Text:</h4>\n              <div class="text-content">').concat(t.recommendedText,'</div>\n            </div>\n            <div class="reason-section">\n              <h4>Reason for Change:</h4>\n              <div class="reason-content">').concat(t.changeReason,'</div>\n            </div>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <button class="primary-button" onclick="applyClauseModification(\'').concat(n,'\'); closePreviewModal();">\n            Apply Change\n          </button>\n          <button class="secondary-button" onclick="closePreviewModal()">\n            Cancel\n          </button>\n        </div>\n      </div>\n    '),document.body.appendChild(e)}},window.closePreviewModal=function(){var n=document.querySelector(".clause-preview-modal");n&&n.remove()},window.acceptAllChanges=r(c().mark((function n(){var t,s,a,i,o;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.e(75).then(e.bind(e,23075));case 3:return t=n.sent,s=t.contractReviewer,n.next=7,e.e(199).then(e.bind(e,79199));case 7:return a=n.sent,(i=a.updateStatus)("Applying all clause modifications...","info"),n.next=12,s.applyAllModifications();case 12:(o=n.sent).applied.length>0&&(i("Successfully applied ".concat(o.applied.length," modifications!"),"success"),o.applied.forEach((function(n){g(n.clauseNumber,!0)})),setTimeout((function(){window.rerunAnalysis()}),1e3)),o.failed.length>0&&(i("".concat(o.failed.length," modifications failed. Check console for details."),"warning"),console.error("Failed modifications:",o.failed)),n.next=24;break;case 17:return n.prev=17,n.t0=n.catch(0),n.next=21,e.e(199).then(e.bind(e,79199));case 21:(0,n.sent.updateStatus)("Error applying modifications: ".concat(n.t0.message),"error");case 24:case"end":return n.stop()}}),n,null,[[0,17]])}))),window.toggleAutoUpdate=function(n){var t,e=document.querySelector(".accept-all-button");e&&(n?(e.textContent="🔄 Auto-Applying Changes...",e.disabled=!0,setTimeout((function(){return window.acceptAllChanges()}),500)):(e.textContent="✅ Accept All Changes (".concat((null===(t=window.currentReviewResults)||void 0===t||null===(t=t.clauseBreakdown)||void 0===t?void 0:t.clausesNeedingModification)||0,")"),e.disabled=!1))}}(n)}function m(n){if(!window.currentReviewResults||!window.currentReviewResults.clauseBreakdown)return null;var t,e=a(window.currentReviewResults.clauseBreakdown.articles);try{for(e.s();!(t=e.n()).done;){var s,i=a(t.value.clauses);try{for(i.s();!(s=i.n()).done;){var c=s.value;if(c.clauseNumber===n)return c}}catch(n){i.e(n)}finally{i.f()}}}catch(n){e.e(n)}finally{e.f()}return null}function g(n,t){var e=document.querySelector('[data-clause-number="'.concat(n,'"]'));if(e&&t){e.classList.remove("needs-modification"),e.classList.add("acceptable");var s=e.querySelector(".status-icon"),a=e.querySelector(".status-text"),i=e.querySelector(".clause-actions");s&&(s.textContent="✅"),a&&(a.textContent="Applied"),i&&(i.style.display="none")}}e.r(t),e.d(t,{displayCombinedAnalysisResults:function(){return l},displayContractResults:function(){return u},displayContractReviewResults:function(){return v},displayStructuredAnalysisResults:function(){return p},showSuggestionsSection:function(){return d}})}}]);
//# sourceMappingURL=709.js.map