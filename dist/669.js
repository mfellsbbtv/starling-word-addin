/*! For license information please see 669.js.LICENSE.txt */
"use strict";(self.webpackChunkstarling_word_addin=self.webpackChunkstarling_word_addin||[]).push([[669],{50669:function(t,e,n){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],s=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);s=!0);}catch(t){u=!0,o=t}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function i(){i=function(){return e};var t,e={},n=Object.prototype,o=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,n,r){Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function f(e,n,r,o){var a=n&&n.prototype instanceof y?n:y,i=Object.create(a.prototype);return l(i,"_invoke",function(e,n,r){var o=1;return function(a,i){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===a)throw i;return{value:t,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=p(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new _(o||[])),!0),i}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h={};function y(){}function m(){}function v(){}var d={};l(d,c,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(P([])));b&&b!==n&&o.call(b,c)&&(d=b);var w=v.prototype=y.prototype=Object.create(d);function k(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(a,i,c,s){var u=p(t[a],t,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==r(f)&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,c,s)}),(function(t){n("throw",t,c,s)})):e.resolve(f).then((function(t){l.value=t,c(l)}),(function(t){return n("throw",t,c,s)}))}s(u.arg)}var a;l(this,"_invoke",(function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return a=a?a.then(o,o):o()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var a=p(o,e.i,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,h;var i=a.arg;return i?i.done?(n[e.r]=i.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function E(t){this.tryEntries.push(t)}function S(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function P(e){if(null!=e){var n=e[c];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function n(){for(;++a<e.length;)if(o.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(r(e)+" is not iterable")}return m.prototype=v,l(w,"constructor",v),l(v,"constructor",m),l(v,u,m.displayName="GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,u,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},k(T.prototype),l(T.prototype,s,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new T(f(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},k(w),l(w,u,"Generator"),l(w,c,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=P,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){i.type="throw",i.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a[4],c=this.prev,s=a[1],u=a[2];if(-1===a[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var a=o?o[4]:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),S(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:P(e),r:n,n:r},"next"===this.method&&(this.arg=t),h}},e}function c(t,e,n,r,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){c(a,r,o,i,s,"next",t)}function s(t){c(a,r,o,i,s,"throw",t)}i(void 0)}))}}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l(r.key),r)}}function l(t){var e=function(t){if("object"!=r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(e)?e:e+""}n.r(e),n.d(e,{PlaybookService:function(){return f},playbookService:function(){return p}});var f=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.playbooks=new Map,this.loadedPlaybooks=new Set},e=[{key:"loadPlaybook",value:(y=s(i().mark((function t(e,n){var r,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r="".concat(e,"-").concat(n),!this.playbooks.has(r)){t.next=3;break}return t.abrupt("return",this.playbooks.get(r));case 3:return t.prev=3,t.next=6,this.fetchPlaybookFiles(e,n);case 6:return o=t.sent,this.playbooks.set(r,o),this.loadedPlaybooks.add(r),console.log("Loaded playbook: ".concat(r)),t.abrupt("return",o);case 13:return t.prev=13,t.t0=t.catch(3),console.error("Failed to load playbook ".concat(r,":"),t.t0),t.abrupt("return",this.getFallbackPlaybook(e,n));case 17:case"end":return t.stop()}}),t,this,[[3,13]])}))),function(t,e){return y.apply(this,arguments)})},{key:"fetchPlaybookFiles",value:(h=s(i().mark((function t(e,n){var r,a,c,s,u,l,f,p;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.getPlaybookBaseUrl(),a="".concat(e,"/").concat(n),t.next=4,Promise.all([this.fetchJsonFile("".concat(r,"/").concat(a,"/template.json")),this.fetchJsonFile("".concat(r,"/").concat(a,"/clauses.json")),this.fetchJsonFile("".concat(r,"/").concat(a,"/risk-rules.json")).catch((function(){return null})),this.fetchJsonFile("".concat(r,"/").concat(a,"/form-fields.json")).catch((function(){return null}))]);case 4:return c=t.sent,s=o(c,4),u=s[0],l=s[1],f=s[2],p=s[3],t.abrupt("return",{metadata:{agreementType:e,contentType:n,loadedAt:(new Date).toISOString()},template:u,clauses:l,riskRules:f,formFields:p});case 11:case"end":return t.stop()}}),t,this)}))),function(t,e){return h.apply(this,arguments)})},{key:"getPlaybookBaseUrl",value:function(){return"localhost"===window.location.hostname?"/playbooks":"https://mfellsbbtv.github.io/starling-word-addin/playbooks"}},{key:"fetchJsonFile",value:(p=s(i().mark((function t(e){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:if((n=t.sent).ok){t.next=5;break}throw new Error("Failed to fetch ".concat(e,": ").concat(n.status));case 5:return t.next=7,n.json();case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t)}))),function(t){return p.apply(this,arguments)})},{key:"getTemplate",value:(f=s(i().mark((function t(e,n){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadPlaybook(e,n);case 2:return r=t.sent,t.abrupt("return",r.template);case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return f.apply(this,arguments)})},{key:"getClauses",value:(l=s(i().mark((function t(e,n){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadPlaybook(e,n);case 2:return r=t.sent,t.abrupt("return",r.clauses);case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return l.apply(this,arguments)})},{key:"getRiskRules",value:(c=s(i().mark((function t(e,n){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadPlaybook(e,n);case 2:return r=t.sent,t.abrupt("return",r.riskRules);case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return c.apply(this,arguments)})},{key:"getFormFields",value:(a=s(i().mark((function t(e,n){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadPlaybook(e,n);case 2:return r=t.sent,t.abrupt("return",r.formFields);case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"generateContract",value:(r=s(i().mark((function t(e,n,r){var o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getTemplate(e,n);case 2:if(o=t.sent){t.next=5;break}throw new Error("No template found for ".concat(e,"-").concat(n));case 5:return t.abrupt("return",this.processTemplate(o,r));case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return r.apply(this,arguments)})},{key:"processTemplate",value:function(t,e){var n=this,r="".concat(t.template.title,"\n\n");return t.template.sections.forEach((function(t){r+="".concat(t.title,"\n\n"),r+=n.replaceVariables(t.content,e)+"\n\n"})),r}},{key:"replaceVariables",value:function(t,e){var n=t;if(Object.keys(e).forEach((function(t){var r="[".concat(t.toUpperCase(),"]"),o=e[t]||"[".concat(t.toUpperCase(),"]");n=n.replace(new RegExp(r,"g"),o)})),e.revenue_split){var r=100-parseFloat(e.revenue_split);n=n.replace(/\[ARTIST_SPLIT\]/g,r.toString())}return n=e.advance_amount&&parseFloat(e.advance_amount)>0?n.replace(/\[ADVANCE_CLAUSE\]/g,"Manager shall provide an advance of $".concat(e.advance_amount,", which shall be recoupable from Artist's future earnings.")):n.replace(/\[ADVANCE_CLAUSE\]/g,"No advance payment is provided under this Agreement.")}},{key:"assessRisks",value:(n=s(i().mark((function t(e,n,r){var o,a,c,s=this;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getRiskRules(n,r);case 2:if(o=t.sent){t.next=5;break}return t.abrupt("return",this.getBasicRiskAssessment(e));case 5:return a=[],c=e.toLowerCase(),o.risk_rules.forEach((function(t){s.evaluateRiskRule(t,c)&&a.push({id:t.id,severity:t.severity,title:t.title,description:t.description,recommendation:t.recommendation,category:t.category})})),t.abrupt("return",{risks:a,complianceScore:this.calculateComplianceScore(a,o.scoring_algorithm),assessmentDate:(new Date).toISOString()});case 9:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return n.apply(this,arguments)})},{key:"evaluateRiskRule",value:function(t,e){var n=t.detection;switch(n.type){case"keyword_absence":return!n.keywords.some((function(t){return e.includes(t.toLowerCase())}));case"keyword_analysis":return n.keywords.filter((function(t){return e.includes(t.toLowerCase())})).length<n.threshold;default:return!1}}},{key:"calculateComplianceScore",value:function(t,e){if(!e)return 75;var n=e.base_score;return t.forEach((function(t){var r=e.deductions[t.severity]||10;n-=r})),Math.max(e.minimum_score,Math.min(e.maximum_score,n))}},{key:"getFallbackPlaybook",value:function(t,e){return{metadata:{agreementType:t,contentType:e,fallback:!0},template:this.getBasicTemplate(t,e),clauses:this.getBasicClauses(),riskRules:null,formFields:null}}},{key:"getBasicTemplate",value:function(t,e){return{template:{title:"".concat(t.toUpperCase()," AGREEMENT"),sections:[{id:"basic",title:"AGREEMENT",content:"This ".concat(t," agreement covers ").concat(e," content management services.")}]}}}},{key:"getBasicClauses",value:function(){return{clauses:[{id:"basic_termination",category:"termination",title:"Basic Termination",content:"Either party may terminate with 30 days notice.",keywords:["termination","terminate"]}]}}},{key:"getBasicRiskAssessment",value:function(t){var e=[];return t.toLowerCase().includes("termination")||e.push({severity:"high",title:"Missing Termination Clause",description:"Contract lacks termination provisions"}),{risks:e,complianceScore:0===e.length?85:65,assessmentDate:(new Date).toISOString()}}},{key:"getAvailablePlaybooks",value:function(){return[{agreementType:"content-management",contentType:"music"},{agreementType:"content-management",contentType:"non-music"},{agreementType:"content-management",contentType:"both"},{agreementType:"licensing",contentType:"music"},{agreementType:"licensing",contentType:"non-music"},{agreementType:"licensing",contentType:"both"},{agreementType:"distribution",contentType:"music"},{agreementType:"distribution",contentType:"non-music"},{agreementType:"distribution",contentType:"both"},{agreementType:"talent",contentType:"music"},{agreementType:"talent",contentType:"non-music"},{agreementType:"talent",contentType:"both"}]}}],e&&u(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,a,c,l,f,p,h,y}(),p=new f}}]);
//# sourceMappingURL=669.js.map