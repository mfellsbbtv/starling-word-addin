/*! For license information please see 1cddefd12d2e360eb0d7.js.LICENSE.txt */
function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(t,n,r,o){var a=n&&n.prototype instanceof f?n:f,i=Object.create(a.prototype);return c(i,"_invoke",function(t,n,r){var o=1;return function(a,i){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var s=r.delegate;if(s){var c=A(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var l=u(t,n,r);if("normal"===l.type){if(o=r.done?4:2,l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=4,r.method="throw",r.arg=l.arg)}}}(t,r,new _(o||[])),!0),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var d={};function f(){}function p(){}function g(){}var m={};c(m,a,(function(){return this}));var h=Object.getPrototypeOf,y=h&&h(h(k([])));y&&y!==n&&r.call(y,a)&&(m=y);var v=g.prototype=f.prototype=Object.create(m);function I(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function n(o,a,i,s){var c=u(e[o],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,i,s)}),(function(e){n("throw",e,i,s)})):t.resolve(d).then((function(e){l.value=e,i(l)}),(function(e){return n("throw",e,i,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function a(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(a,a):a()}),!0)}function A(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var a=u(o,t.i,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,d;var i=a.arg;return i?i.done?(n[t.r]=i.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function E(e){this.tryEntries.push(e)}function w(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function _(e){this.tryEntries=[[-1]],e.forEach(E,this),this.reset(!0)}function k(t){if(null!=t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(_typeof(t)+" is not iterable")}return p.prototype=g,c(v,"constructor",g),c(g,"constructor",p),c(g,s,p.displayName="GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},I(b.prototype),c(b.prototype,i,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new b(l(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},I(v),c(v,s,"Generator"),c(v,a,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=k,_.prototype={constructor:_,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(w),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){i.type="throw",i.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a[4],s=this.prev,c=a[1],l=a[2];if(-1===a[0])return r("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<l)return r(l),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var a=o?o[4]:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),w(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;w(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:k(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function asyncGeneratorStep(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){asyncGeneratorStep(a,r,o,i,s,"next",e)}function s(e){asyncGeneratorStep(a,r,o,i,s,"throw",e)}i(void 0)}))}}function safeInitialize(){return _safeInitialize.apply(this,arguments)}function _safeInitialize(){return(_safeInitialize=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Starting safe initialization..."),e.prev=1,e.next=4,import("../shared/utils.js");case 4:t=e.sent,n=t.initializeTheme,r=t.updateStatus,n(),setupEventListeners(),initializeBasicUI(),"undefined"!=typeof Office?(console.log("Office.js is available, waiting for Office.onReady..."),Office.onReady((function(e){console.log("Office.onReady called with info:",e),window.OFFICE_READY=!0,e.host===Office.HostApplication.Word?(console.log("RHEI AI Legal Assistant loaded successfully in Word"),checkWordAPIAvailabilityWithRetry()):(console.error("This add-in is designed for Microsoft Word only. Current host:",e.host),r("Error: This add-in requires Microsoft Word","error"))}))):(console.error("Office.js is not available"),r("Error: Office.js not loaded. Please refresh the page.","error"),initializeLimitedMode()),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.error("Error during initialization:",e.t0),basicInitialization();case 17:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function checkWordAPIAvailabilityWithRetry(){console.log("Starting enhanced Word API availability check...");var e=0,t=setTimeout((function(){console.log("Auto-fallback triggered - Word API test taking too long"),clearInterval(n),handleWordAPIUnavailable()}),8e3),n=setInterval((function(){e++,console.log("Word API check attempt ".concat(e,"/").concat(6));try{if("undefined"!=typeof Word&&"function"==typeof Word.run)return console.log("Word API is available!"),clearInterval(n),clearTimeout(t),window.WORD_API_AVAILABLE=!0,window.WORD_API_READY=!0,void testWordAPIWithFallback();if(e>=6)return console.log("Word API not available after maximum attempts"),clearInterval(n),clearTimeout(t),void handleWordAPIUnavailable()}catch(r){console.error("Error checking Word API (attempt ".concat(e,"):"),r),e>=6&&(clearInterval(n),clearTimeout(t),handleWordAPIUnavailable())}}),500)}function testWordAPIWithFallback(){return _testWordAPIWithFallback.apply(this,arguments)}function _testWordAPIWithFallback(){return(_testWordAPIWithFallback=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Testing Word API with automatic fallback..."),t=setTimeout((function(){showSkipTestButton()}),4e3),n=setTimeout((function(){console.log("Word API test hanging - auto-falling back to demo mode"),hideSkipTestButton(),handleWordAPIUnavailable()}),1e4),e.prev=3,e.next=6,testWordAPI();case 6:clearTimeout(n),clearTimeout(t),hideSkipTestButton(),e.next=18;break;case 11:e.prev=11,e.t0=e.catch(3),clearTimeout(n),clearTimeout(t),hideSkipTestButton(),console.error("Word API test failed, falling back:",e.t0),handleWordAPIUnavailable();case 18:case"end":return e.stop()}}),e,null,[[3,11]])})))).apply(this,arguments)}function showSkipTestButton(){console.log("Showing skip test button...");var e=document.getElementById("skip-test-section");e&&(e.style.display="block")}function hideSkipTestButton(){var e=document.getElementById("skip-test-section");e&&(e.style.display="none")}function skipWordAPITest(){return _skipWordAPITest.apply(this,arguments)}function _skipWordAPITest(){return(_skipWordAPITest=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("User chose to skip Word API test"),e.prev=1,e.next=4,import("../shared/utils.js");case 4:(0,e.sent.updateStatus)("Skipping Word API test - continuing in demo mode","warning"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Error importing updateStatus:",e.t0);case 12:hideSkipTestButton(),handleWordAPIUnavailable();case 14:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function checkWordAPIAvailability(){console.log("Checking Word API availability (fallback method)...");try{"undefined"!=typeof Word&&"function"==typeof Word.run?(console.log("Word API is available!"),window.WORD_API_AVAILABLE=!0,testWordAPI()):(console.log("Word API is not available"),handleWordAPIUnavailable())}catch(e){console.error("Error checking Word API:",e),handleWordAPIUnavailable()}}function testWordAPI(){return _testWordAPI.apply(this,arguments)}function _testWordAPI(){return _testWordAPI=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,r,o,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Testing Word API functionality with ultra-minimal test..."),e.prev=1,e.next=4,import("../shared/utils.js");case 4:return t=e.sent,(n=t.updateStatus)("Testing Word API connection...","info"),r=new Promise((function(e,t){try{Word.run(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(n){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Word.run context created successfully"),e(!0);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch(t)}catch(e){t(e)}})),o=new Promise((function(e,t){setTimeout((function(){return t(new Error("Word API test timeout"))}),3e3)})),e.next=11,Promise.race([r,o]);case 11:console.log("Word API test completed successfully!"),n("Word API available - all features enabled","success"),window.INITIALIZATION_COMPLETE=!0,enableWordFeatures(),e.next=35;break;case 17:return e.prev=17,e.t0=e.catch(1),console.error("Word API test failed:",e.t0),a="Word API test failed",e.t0.message.includes("timeout")?a="Word API connection timeout":e.t0.message.includes("InvalidApiCallInContext")?a="Word API context not ready":e.t0.message.includes("permission")?a="Insufficient permissions for Word API":e.t0.message.includes("GeneralException")?a="Word API general error":e.t0.message.includes("ItemNotFound")&&(a="Word API item not found"),console.log("Word API test failed: ".concat(a,", switching to demo mode")),e.prev=23,e.next=26,import("../shared/utils.js");case 26:(0,e.sent.updateStatus)(a+" - switching to demo mode","warning"),e.next=34;break;case 31:e.prev=31,e.t1=e.catch(23),console.error("Error importing updateStatus:",e.t1);case 34:handleWordAPIUnavailable();case 35:case"end":return e.stop()}}),e,null,[[1,17],[23,31]])}))),_testWordAPI.apply(this,arguments)}function handleWordAPIUnavailable(){return _handleWordAPIUnavailable.apply(this,arguments)}function _handleWordAPIUnavailable(){return(_handleWordAPIUnavailable=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Word API is unavailable - enabling demo mode"),window.WORD_API_AVAILABLE=!1,e.prev=2,e.next=5,import("../shared/utils.js");case 5:(0,e.sent.updateStatus)("Demo mode - Word API not available. Some features limited.","warning"),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),console.error("Error importing updateStatus:",e.t0),(t=document.getElementById("status-message"))&&(t.textContent="Demo mode - Word API not available. Some features limited.");case 15:enableDemoMode();case 16:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}function basicInitialization(){console.log("Running basic initialization fallback..."),document.body.classList.add("ms-font-m","ms-welcome","ms-Fabric");var e=document.getElementById("status-message");e&&(e.textContent="Add-in loaded in basic mode. Limited functionality available."),document.querySelectorAll("button").forEach((function(e){e.disabled=!0,e.title="Feature not available in basic mode"})),console.log("Basic initialization complete")}function enableWordFeatures(){console.log("Enabling Word-dependent features..."),["generate-contract","analyze-contract","toggle-track-changes","highlight-risks","suggest-changes"].forEach((function(e){var t=document.getElementById(e);t&&(t.disabled=!1,t.title="")}));var e=document.getElementById("generate-button-group");e&&(e.style.display="block")}function enableDemoMode(){console.log("Enabling demo mode..."),["analyze-contract"].forEach((function(e){var t=document.getElementById(e);t&&(t.disabled=!1,t.title="Demo mode - uses sample data")})),["generate-contract","toggle-track-changes","highlight-risks","suggest-changes"].forEach((function(e){var t=document.getElementById(e);t&&(t.disabled=!0,t.title="Requires Word API - not available in current environment")}));var e=document.getElementById("generate-button-group");e&&(e.style.display="none")}function initializeLimitedMode(){return _initializeLimitedMode.apply(this,arguments)}function _initializeLimitedMode(){return(_initializeLimitedMode=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Initializing in limited mode without Word API"),e.prev=1,e.next=4,import("../shared/utils.js");case 4:t=e.sent,n=t.initializeTheme,r=t.updateStatus,n(),setupEventListeners(),initializeLimitedUI(),r("Add-in loaded in limited mode. Some features may not be available.","warning"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.error("Error in limited mode initialization:",e.t0),basicInitialization();case 17:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function showDiagnosticInfo(){var e,t,n,r,o,a={officeVersion:(null===(e=Office)||void 0===e||null===(e=e.context)||void 0===e||null===(e=e.diagnostics)||void 0===e?void 0:e.version)||"Unknown",platform:(null===(t=Office)||void 0===t||null===(t=t.context)||void 0===t||null===(t=t.diagnostics)||void 0===t?void 0:t.platform)||"Unknown",host:(null===(n=Office)||void 0===n||null===(n=n.context)||void 0===n||null===(n=n.diagnostics)||void 0===n?void 0:n.host)||"Unknown",officeJsLoaded:"undefined"!=typeof Office,wordApiAvailable:"undefined"!=typeof Word,wordRunAvailable:"function"==typeof(null===(r=Word)||void 0===r?void 0:r.run),wordApiReady:window.WORD_API_READY||!1,wordApiAvailableGlobal:window.WORD_API_AVAILABLE||!1,requirements:(null===(o=Office)||void 0===o||null===(o=o.context)||void 0===o?void 0:o.requirements)||"Not available",userAgent:navigator.userAgent||"Unknown",location:window.location.href,officeReady:window.OFFICE_READY||!1,initializationComplete:window.INITIALIZATION_COMPLETE||!1,isOnline:navigator.onLine,cookiesEnabled:navigator.cookieEnabled,language:navigator.language,timestamp:(new Date).toISOString()};console.log("Enhanced Diagnostic Information:",a);var i="Diagnostic - Office: ".concat(a.officeVersion,", Platform: ").concat(a.platform,", Word API: ").concat(a.wordApiAvailable?"Available":"Not Available",", Ready: ").concat(a.wordApiReady);try{updateStatus(i,"info")}catch(e){console.error("Error updating status:",e)}return displayDiagnosticInfo(a),a}function displayDiagnosticInfo(e){var t=document.getElementById("status-message");t&&(t.innerHTML='\n      <div class="diagnostic-info" style="text-align: left; font-size: 11px; line-height: 1.4;">\n        <h4 style="margin: 0 0 10px 0; color: #0078d4;">Word API Diagnostic Information</h4>\n\n        <div style="margin-bottom: 8px;">\n          <strong>Office Environment:</strong><br>\n          ‚Ä¢ Version: '.concat(e.officeVersion,"<br>\n          ‚Ä¢ Platform: ").concat(e.platform,"<br>\n          ‚Ä¢ Host: ").concat(e.host,"<br>\n          ‚Ä¢ Online: ").concat(e.isOnline?"Yes":"No",'\n        </div>\n\n        <div style="margin-bottom: 8px;">\n          <strong>Word API Status:</strong><br>\n          ‚Ä¢ Word Object: ').concat(e.wordApiAvailable?"‚úÖ Available":"‚ùå Not Available","<br>\n          ‚Ä¢ Word.run Function: ").concat(e.wordRunAvailable?"‚úÖ Available":"‚ùå Not Available","<br>\n          ‚Ä¢ API Ready: ").concat(e.wordApiReady?"‚úÖ Yes":"‚ùå No","<br>\n          ‚Ä¢ Global Available: ").concat(e.wordApiAvailableGlobal?"‚úÖ Yes":"‚ùå No",'\n        </div>\n\n        <div style="margin-bottom: 8px;">\n          <strong>Initialization:</strong><br>\n          ‚Ä¢ Office.js: ').concat(e.officeJsLoaded?"‚úÖ Loaded":"‚ùå Not Loaded","<br>\n          ‚Ä¢ Office Ready: ").concat(e.officeReady?"‚úÖ Yes":"‚ùå No","<br>\n          ‚Ä¢ Init Complete: ").concat(e.initializationComplete?"‚úÖ Yes":"‚ùå No",'\n        </div>\n\n        <div style="margin-bottom: 8px;">\n          <strong>Environment:</strong><br>\n          ‚Ä¢ Browser: ').concat(e.userAgent.split(" ").slice(-2).join(" "),"<br>\n          ‚Ä¢ Language: ").concat(e.language,"<br>\n          ‚Ä¢ Cookies: ").concat(e.cookiesEnabled?"Enabled":"Disabled",'\n        </div>\n\n        <div style="margin-top: 10px; padding: 8px; background: #f0f0f0; border-radius: 4px;">\n          <strong>Troubleshooting:</strong><br>\n          ').concat(e.wordApiAvailable?"‚úÖ Word API is available. If features aren't working, try refreshing.":"‚ùå Word API not available. Try: 1) Refresh page, 2) Restart Word, 3) Check network connection",'\n        </div>\n\n        <div style="margin-top: 8px; font-size: 10px; color: #666;">\n          Generated: ').concat(e.timestamp,"\n        </div>\n      </div>\n    "))}function setupEventListeners(){var e=document.getElementById("generate-contract");e&&e.addEventListener("click",safeGenerateContract);var t=document.getElementById("analyze-contract");t&&t.addEventListener("click",safeAnalyzeContract);var n=document.getElementById("agreement-type");n&&n.addEventListener("change",safeHandleAgreementTypeChange);var r=document.getElementById("content-type");r&&r.addEventListener("change",safeHandleContentTypeChange);var o=document.getElementById("clear-results");o&&o.addEventListener("click",safeClearResults);var a=document.getElementById("clear-suggestions");a&&a.addEventListener("click",safeClearSuggestions);var i=document.getElementById("toggle-track-changes");i&&i.addEventListener("click",toggleTrackChanges);var s=document.getElementById("highlight-risks");s&&s.addEventListener("click",highlightRisks);var c=document.getElementById("check-compliance");c&&c.addEventListener("click",checkCompliance);var l=document.getElementById("suggest-changes");l&&l.addEventListener("click",suggestChanges);var u=document.getElementById("show-diagnostics");u&&u.addEventListener("click",showDiagnosticInfo);var d=document.getElementById("skip-word-api-test");d&&d.addEventListener("click",skipWordAPITest),console.log("Event listeners set up successfully")}function initializeBasicUI(){return _initializeBasicUI.apply(this,arguments)}function _initializeBasicUI(){return(_initializeBasicUI=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,r,o,a,i,s;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("dynamic-form"),n=document.getElementById("generate-button-group"),r=document.getElementById("content-type-group"),o=document.getElementById("results-section"),a=document.getElementById("suggestions-section"),i=document.getElementById("progress-section"),t&&(t.style.display="none"),n&&(n.style.display="none"),r&&(r.style.display="none"),o&&(o.style.display="none"),a&&(a.style.display="none"),i&&(i.style.display="none"),["generate-contract","analyze-contract","toggle-track-changes","highlight-risks","suggest-changes","check-compliance"].forEach((function(e){var t=document.getElementById(e);t&&(t.disabled=!0,t.title="Initializing...")})),e.prev=14,e.next=17,import("../shared/utils.js");case 17:(0,e.sent.updateStatus)("Initializing add-in...","info"),e.next=27;break;case 22:e.prev=22,e.t0=e.catch(14),console.error("Error importing updateStatus:",e.t0),(s=document.getElementById("status-message"))&&(s.textContent="Initializing add-in...");case 27:console.log("Basic UI initialized successfully");case 28:case"end":return e.stop()}}),e,null,[[14,22]])})))).apply(this,arguments)}function initializeLimitedUI(){var e=document.getElementById("dynamic-form"),t=document.getElementById("generate-button-group"),n=document.getElementById("content-type-group"),r=document.getElementById("results-section"),o=document.getElementById("suggestions-section"),a=document.getElementById("progress-section");e&&(e.style.display="none"),t&&(t.style.display="none"),n&&(n.style.display="none"),r&&(r.style.display="none"),o&&(o.style.display="none"),a&&(a.style.display="none"),["generate-contract","analyze-contract","toggle-track-changes","highlight-risks","suggest-changes"].forEach((function(e){var t=document.getElementById(e);t&&(t.disabled=!0,t.title="Word API not available - feature disabled")})),console.log("Limited UI initialized successfully")}function safeHandleError(e){return _safeHandleError.apply(this,arguments)}function _safeHandleError(){return(_safeHandleError=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,import("../shared/utils.js");case 3:(0,e.sent.handleError)(t),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error importing handleError:",e.t0),(n=document.getElementById("status-message"))&&(n.textContent="Error: ".concat(t.message||t),n.className="status-message ms-font-s error");case 13:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function safeClearResults(){return _safeClearResults.apply(this,arguments)}function _safeClearResults(){return(_safeClearResults=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,import("../shared/utils.js");case 3:(0,e.sent.clearResults)(),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error importing clearResults:",e.t0),(t=document.getElementById("results-section"))&&(t.style.display="none");case 13:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function safeClearSuggestions(){return _safeClearSuggestions.apply(this,arguments)}function _safeClearSuggestions(){return(_safeClearSuggestions=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,import("../shared/utils.js");case 3:(0,e.sent.clearSuggestions)(),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error importing clearSuggestions:",e.t0),(t=document.getElementById("suggestions-section"))&&(t.style.display="none");case 13:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function safeGenerateContract(){return _safeGenerateContract.apply(this,arguments)}function _safeGenerateContract(){return(_safeGenerateContract=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.WORD_API_AVAILABLE){e.next=13;break}return e.prev=1,e.next=4,import("../shared/utils.js");case 4:(0,e.sent.updateStatus)("Error: Word API not available. Cannot generate contract.","error"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Error importing updateStatus:",e.t0);case 12:return e.abrupt("return");case 13:return e.prev=13,e.next=16,import("./modules/event-handlers.js");case 16:return t=e.sent,n=t.generateContract,e.next=20,n();case 20:e.next=36;break;case 22:return e.prev=22,e.t1=e.catch(13),console.error("Error importing or calling generateContract:",e.t1),e.prev=25,e.next=28,import("../shared/utils.js");case 28:(0,e.sent.updateStatus)("Error: Failed to generate contract. "+e.t1.message,"error"),e.next=36;break;case 33:e.prev=33,e.t2=e.catch(25),console.error("Error importing updateStatus:",e.t2);case 36:case"end":return e.stop()}}),e,null,[[1,9],[13,22],[25,33]])})))).apply(this,arguments)}function safeAnalyzeContract(){return _safeAnalyzeContract.apply(this,arguments)}function _safeAnalyzeContract(){return(_safeAnalyzeContract=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!window.WORD_API_AVAILABLE){e.next=10;break}return e.next=4,import("./modules/event-handlers.js");case 4:return t=e.sent,n=t.analyzeContract,e.next=8,n();case 8:e.next=12;break;case 10:return e.next=12,analyzeDemoContract();case 12:e.next=28;break;case 14:return e.prev=14,e.t0=e.catch(0),console.error("Error in contract analysis:",e.t0),e.prev=17,e.next=20,import("../shared/utils.js");case 20:(0,e.sent.updateStatus)("Error: Failed to analyze contract. "+e.t0.message,"error"),e.next=28;break;case 25:e.prev=25,e.t1=e.catch(17),console.error("Error importing updateStatus:",e.t1);case 28:case"end":return e.stop()}}),e,null,[[0,14],[17,25]])})))).apply(this,arguments)}function safeHandleAgreementTypeChange(e){return _safeHandleAgreementTypeChange.apply(this,arguments)}function _safeHandleAgreementTypeChange(){return(_safeHandleAgreementTypeChange=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,import("./modules/event-handlers.js");case 3:(0,e.sent.handleAgreementTypeChange)(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error handling agreement type change:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function safeHandleContentTypeChange(e){return _safeHandleContentTypeChange.apply(this,arguments)}function _safeHandleContentTypeChange(){return(_safeHandleContentTypeChange=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,import("./modules/event-handlers.js");case 3:(0,e.sent.handleContentTypeChange)(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error handling content type change:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function analyzeDemoContract(){return _analyzeDemoContract.apply(this,arguments)}function _analyzeDemoContract(){return(_analyzeDemoContract=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,r,o,a,i,s,c,l,u,d,f,p,g,m;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,import("../shared/utils.js");case 3:return t=e.sent,(n=t.updateStatus)("Running demo analysis with sample contract...","info"),e.prev=6,e.next=9,import("./services/contract-analyzer.js");case 9:return r=e.sent,o=r.generateDemoAnalysis,a=r.generateRiskAnalysis,i=r.generateChangeSuggestions,e.next=15,import("./modules/ui-display.js");case 15:return s=e.sent,c=s.displayCombinedAnalysisResults,l="SAMPLE CONTENT MANAGEMENT AGREEMENT\n\nThis Content Management Agreement is entered into between Company A and Company B.\n\n1. SCOPE OF SERVICES\nThe Manager will provide content management services including distribution and marketing.\n\n2. COMPENSATION\nRevenue will be split 80% to Artist and 20% to Manager.\n\n3. TERM\nThis agreement is effective for 2 years from the date of signing.",e.next=20,Promise.all([o(l),a(l),i(l)]);case 20:u=e.sent,d=_slicedToArray(u,3),f=d[0],p=d[1],g=d[2],c(f,p,g,{title:"üìä Executive Summary (Demo)",overview:"This is a demo analysis using sample contract data. In real mode, this would analyze your actual Word document."}),n("Demo analysis complete! This used sample data.","success"),e.next=34;break;case 30:e.prev=30,e.t0=e.catch(6),console.error("Error in demo analysis:",e.t0),n("Error: Failed to run demo analysis. "+e.t0.message,"error");case 34:e.next=41;break;case 36:e.prev=36,e.t1=e.catch(0),console.error("Error importing updateStatus:",e.t1),(m=document.getElementById("status-message"))&&(m.textContent="Error: Failed to run demo analysis.");case 41:case"end":return e.stop()}}),e,null,[[0,36],[6,30]])})))).apply(this,arguments)}function toggleTrackChanges(){updateStatus("Toggling track changes...","info")}function highlightRisks(){updateStatus("Highlighting risks...","info")}function checkCompliance(){updateStatus("Checking compliance...","info")}function suggestChanges(){updateStatus("Applying suggested changes...","info")}window.WORD_API_AVAILABLE=!1,window.OFFICE_READY=!1,window.WORD_API_READY=!1,window.INITIALIZATION_COMPLETE=!1,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",safeInitialize):safeInitialize(),window.addEventListener("error",(function(e){console.error("Global error:",e.error),safeHandleError(e.error)})),window.addEventListener("unhandledrejection",(function(e){console.error("Unhandled promise rejection:",e.reason),safeHandleError(e.reason)})),console.log("RHEI AI Legal Assistant module loaded");