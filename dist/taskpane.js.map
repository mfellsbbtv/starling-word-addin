{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://starling-word-addin/./src/shared/utils.js","webpack://starling-word-addin/./src/shared/config.js","webpack://starling-word-addin/./src/shared/api-service.js","webpack://starling-word-addin/./src/taskpane/services/contract-analyzer.js","webpack://starling-word-addin/./src/taskpane/services/contract-generator.js","webpack://starling-word-addin/./src/taskpane/modules/ui-display.js","webpack://starling-word-addin/./src/taskpane/modules/event-handlers.js","webpack://starling-word-addin/./src/taskpane/taskpane.js"],"sourcesContent":["// Shared utility functions\n\n// Enhanced button state management\nexport function setButtonLoading(buttonId, isLoading) {\n  const button = document.getElementById(buttonId);\n  if (isLoading) {\n    button.classList.add(\"loading\");\n    button.disabled = true;\n  } else {\n    button.classList.remove(\"loading\");\n    button.disabled = false;\n  }\n}\n\n// Helper functions\nexport function updateStatus(message, type = \"info\") {\n  const statusElement = document.getElementById(\"status-message\");\n  statusElement.textContent = message;\n  statusElement.className = `status-message ms-font-s ${type} slide-in`;\n\n  // Add success animation for success messages\n  if (type === \"success\") {\n    statusElement.classList.add(\"success-animation\");\n    setTimeout(() => {\n      statusElement.classList.remove(\"success-animation\");\n    }, 600);\n  }\n}\n\nexport function showProgressSection(message) {\n  document.getElementById(\"progress-section\").style.display = \"block\";\n  document.getElementById(\"progress-text\").textContent = message;\n  simulateProgress();\n}\n\nexport function hideProgressSection() {\n  document.getElementById(\"progress-section\").style.display = \"none\";\n}\n\n// Progress simulation\nfunction simulateProgress() {\n  const progressBar = document.getElementById(\"progress-bar\");\n  let progress = 0;\n  \n  const interval = setInterval(() => {\n    progress += Math.random() * 15;\n    if (progress > 90) progress = 90;\n    \n    progressBar.style.width = progress + \"%\";\n    \n    if (progress >= 90) {\n      clearInterval(interval);\n    }\n  }, 200);\n}\n\n// Error handling\nexport function handleError(error) {\n  console.error(\"Error:\", error);\n  let errorMessage = \"An error occurred\";\n  \n  if (error.message) {\n    errorMessage = error.message;\n  } else if (typeof error === 'string') {\n    errorMessage = error;\n  }\n  \n  updateStatus(errorMessage, \"error\");\n  hideProgressSection();\n}\n\n// Clear results functions\nexport function clearResults() {\n  const resultsSection = document.getElementById(\"results-section\");\n  const resultsContent = document.getElementById(\"results-content\");\n  \n  resultsSection.style.display = \"none\";\n  resultsContent.innerHTML = \"\";\n  \n  updateStatus(\"Results cleared\", \"info\");\n}\n\nexport function clearSuggestions() {\n  const suggestionsSection = document.getElementById(\"suggestions-section\");\n  const suggestionsContent = document.getElementById(\"suggestions-content\");\n  \n  suggestionsSection.style.display = \"none\";\n  suggestionsContent.innerHTML = \"\";\n  \n  updateStatus(\"Suggestions cleared\", \"info\");\n}\n\n// Theme detection and initialization\nexport function initializeTheme() {\n  // Detect Office theme\n  if (Office.context && Office.context.officeTheme) {\n    const theme = Office.context.officeTheme;\n    document.body.className = `office-theme-${theme.bodyBackgroundColor}`;\n  }\n}\n","// Application Configuration\n\n// API Configuration\nexport const API_CONFIG = {\n  USE_REAL_API: false, // Toggle between real API and demo mode\n  baseUrl: \"https://api.starling-ai.com/v1\",\n  demoMode: true,\n  endpoints: {\n    analyze: \"/analyze-contract\",\n    generate: \"/generate-contract\",\n    suggestions: \"/suggest-changes\"\n  },\n  headers: {\n    'Content-Type': 'application/json',\n    'Accept': 'application/json'\n  }\n};\n\n// Demo Data Configuration\nexport const DEMO_CONFIG = {\n  // Contract templates for generation\n  contractTemplates: {\n    'content-management': {\n      'music': {\n        title: 'Music Content Management Agreement',\n        baseContent: `MUSIC CONTENT MANAGEMENT AGREEMENT\n\nThis Music Content Management Agreement (\"Agreement\") is entered into on [DATE] between [ENTITY_NAME], a limited liability company (\"Manager\"), and [CONTENT_CREATOR] (\"Artist\").\n\n1. SCOPE OF SERVICES\nManager agrees to provide comprehensive music content management services including:\n- Digital distribution across all major streaming platforms\n- Rights management and royalty collection\n- Marketing and promotional campaigns\n- Performance tracking and analytics\n\n2. REVENUE SHARING\nArtist and Manager agree to the following revenue split:\n- Artist: [ARTIST_PERCENTAGE]%\n- Manager: [MANAGER_PERCENTAGE]%\n\n3. TERM AND TERRITORY\nThis Agreement shall remain in effect for [TERM_LENGTH] and covers [TERRITORY].\n\n4. RIGHTS GRANTED\nArtist grants Manager the right to manage [MUSIC_RIGHTS] for the specified territory and term.\n\n5. TERMINATION\nEither party may terminate this Agreement with [TERMINATION_NOTICE] days written notice.\n\nIN WITNESS WHEREOF, the parties have executed this Agreement as of the date first written above.\n\n[SIGNATURE BLOCKS]`\n      },\n      'non-music': {\n        title: 'Content Management Agreement',\n        baseContent: `CONTENT MANAGEMENT AGREEMENT\n\nThis Content Management Agreement (\"Agreement\") is entered into on [DATE] between [ENTITY_NAME] (\"Manager\") and [CONTENT_CREATOR] (\"Creator\").\n\n1. CONTENT MANAGEMENT SERVICES\nManager will provide comprehensive content management including:\n- [CONTENT_TYPE] optimization and strategy\n- Platform management for [PLATFORM_FOCUS]\n- Brand partnership facilitation\n- Revenue optimization and analytics\n\n2. COMPENSATION\nRevenue sharing: Creator [CREATOR_PERCENTAGE]%, Manager [MANAGER_PERCENTAGE]%\n\n3. TERM AND SCOPE\nDuration: [TERM_LENGTH]\nTerritory: [TERRITORY]\n\n4. TERMINATION\n[TERMINATION_NOTICE] days written notice required.\n\n[SIGNATURE BLOCKS]`\n      }\n    }\n  },\n\n  // Analysis response templates\n  analysisTemplates: {\n    risks: [\n      {\n        severity: 'high',\n        category: 'Missing Clause',\n        title: 'No Termination Clause',\n        description: 'Contract lacks clear termination conditions.',\n        suggestion: 'Add comprehensive termination clause with notice periods.'\n      },\n      {\n        severity: 'medium',\n        category: 'Legal Risk',\n        title: 'Liability Limitations',\n        description: 'Consider adding liability limitation clauses.',\n        suggestion: 'Include mutual liability caps and indemnification.'\n      }\n    ],\n    suggestions: [\n      {\n        type: 'Language Improvement',\n        priority: 'medium',\n        title: 'Clarify Payment Terms',\n        current: 'Payment terms are vague',\n        suggested: 'Specify exact payment schedules and methods',\n        benefit: 'Reduces payment disputes and improves cash flow'\n      }\n    ]\n  }\n};\n\n// UI Configuration\nexport const UI_CONFIG = {\n  animations: {\n    fadeInDuration: 300,\n    slideInDuration: 400,\n    progressUpdateInterval: 200\n  },\n  \n  themes: {\n    default: 'office-light',\n    supported: ['office-light', 'office-dark', 'office-colorful']\n  },\n  \n  validation: {\n    maxContractLength: 50000, // characters\n    minContractLength: 100,   // characters\n    requiredFields: ['agreement-type', 'content-type']\n  }\n};\n\n// Feature Flags\nexport const FEATURES = {\n  trackChanges: true,\n  realTimeAnalysis: false,\n  advancedSuggestions: true,\n  contractGeneration: true,\n  riskAnalysis: true\n};\n\n// AI Prompts Configuration\nexport const AI_PROMPTS = {\n  contractReview: {\n    systemPrompt: `You are an expert legal AI specialized in contract analysis. Given:\n\nAn active Microsoft Word document containing a commercial or legal contract.\n\nA predefined company standard clauses database (\"Standard Library\") with negotiable and non-negotiable terms clearly marked.\n\nPerform the following tasks step-by-step:\n\nContract Analysis:\n- Identify and extract all Articles and Clauses from the active Word document.\n- Clearly segment the contract into distinct clauses or sections.\n- Use numbers to define each article and clause (e.g. the first article of the first clause would be 1.1, the first sub-clause would be 1.1.1. The second article would be 2, while the first clause of article 2 would be 2.1, and so on)\n\nClause Comparison:\n- Compare each extracted clause against the corresponding clause from the Standard Library.\n- Highlight deviations clearly using Word's Track Changes feature.\n\nDeviation Summary:\n- Provide a concise summary detailing each deviation from the Standard Library.\n- Classify deviations into negotiable (flexible) and non-negotiable (must adhere strictly to the standard).\n\nImprovement Recommendations:\n- Suggest precise language revisions for clauses identified as negotiable to optimize the company's position.\n- For non-negotiable clauses, recommend specific edits that restore compliance with the Standard Library.\n- Quantify risks on current clauses and provide reasons for why the updated clause would be best.\n\nOutput Format:\n- Generate the tracked-changes directly within the Word document.\n- Provide a structured textual summary including:\n  * Clause reference (number/title)\n  * Brief description of the deviation\n  * Negotiable/non-negotiable status\n  * Recommended language improvements or restorations\n\nEnsure the analysis is thorough, professional, and actionable. Maintain accuracy and clarity in recommendations, prioritizing the company's legal and commercial interests. The recommendations must align with best legal practices and strategic objectives defined in the Standard Library.`,\n\n    userPromptTemplate: `Please analyze the following contract document:\n\nCONTRACT TEXT:\n{documentText}\n\nCONTRACT TYPE: {contractType}\n\nPlease provide a comprehensive analysis following the system instructions above, with particular attention to:\n1. Article and clause numbering (1, 1.1, 1.1.1, 2, 2.1, etc.)\n2. Deviation classification (negotiable vs non-negotiable)\n3. Risk quantification for each clause\n4. Specific language recommendations\n\nReturn the analysis in the structured format specified.`\n  },\n\n  riskAssessment: {\n    systemPrompt: `You are a legal risk assessment specialist. Analyze contracts for potential legal, financial, and operational risks.`,\n\n    userPromptTemplate: `Assess the risks in this contract:\n\n{documentText}\n\nFocus on:\n- Legal compliance risks\n- Financial exposure\n- Operational constraints\n- Termination risks\n- Liability issues\n\nProvide risk severity (high/medium/low) and mitigation strategies.`\n  },\n\n  clauseImprovement: {\n    systemPrompt: `You are a contract optimization expert. Suggest improvements to contract language that protect the company's interests while maintaining enforceability.`,\n\n    userPromptTemplate: `Improve the following contract clauses:\n\n{documentText}\n\nFor each clause, provide:\n- Current language assessment\n- Improved language suggestion\n- Business benefit explanation\n- Legal rationale`\n  }\n};\n","// API Service Layer - following augment-guidelines: centralized API calls\nimport { AI_PROMPTS } from './config.js';\n\nexport class APIService {\n  constructor(config) {\n    this.config = config;\n  }\n\n  async makeRequest(endpoint, options = {}) {\n    if (!this.config.USE_REAL_API) {\n      console.log(`[DEMO MODE] Would call API: ${endpoint}`, options);\n      return this.getMockResponse(endpoint, options);\n    }\n\n    const url = `${this.config.baseUrl}${endpoint}`;\n    const requestOptions = {\n      method: options.method || 'GET',\n      headers: {\n        ...this.config.headers,\n        ...options.headers\n      },\n      ...options\n    };\n\n    if (options.body && typeof options.body === 'object') {\n      requestOptions.body = JSON.stringify(options.body);\n    }\n\n    try {\n      const response = await fetch(url, requestOptions);\n\n      if (!response.ok) {\n        throw new Error(`API Error: ${response.status} ${response.statusText}`);\n      }\n\n      return await response.json();\n    } catch (error) {\n      console.error('API Request failed:', error);\n      throw error;\n    }\n  }\n\n  // Mock responses for demo mode\n  getMockResponse(endpoint, options) {\n    if (endpoint.includes('/analyze')) {\n      return this.getMockAnalysisResponse(options.body);\n    } else if (endpoint.includes('/generate')) {\n      return this.getMockGenerationResponse(options.body);\n    } else if (endpoint.includes('/health')) {\n      return { status: 'healthy', timestamp: new Date().toISOString() };\n    }\n\n    return { message: 'Mock response', endpoint, options };\n  }\n\n  getMockAnalysisResponse(requestData) {\n    // Return mock analysis data (existing demo logic)\n    return {\n      contract_type: \"Content Management Agreement\",\n      compliance_score: 85,\n      summary: \"This contract appears well-structured with standard clauses.\",\n      risks: [\n        { severity: \"medium\", description: \"Consider adding force majeure clause\" },\n        { severity: \"low\", description: \"Termination notice period could be more specific\" }\n      ],\n      key_terms: [\"Payment Terms\", \"Geographic Scope\", \"Rights Management\"],\n      recommendations: [\n        \"Consider legal review before execution\",\n        \"Ensure all parties review terms carefully\"\n      ]\n    };\n  }\n\n  getMockGenerationResponse(requestData) {\n    // Return mock generation data\n    return {\n      contract_text: \"Generated contract content would be here...\",\n      metadata: {\n        template_used: requestData?.agreement_type || \"content-management\",\n        generated_at: new Date().toISOString()\n      }\n    };\n  }\n\n  // API Methods\n  async analyzeContract(documentText, contractType = 'general') {\n    // Prepare the AI prompt for real API calls\n    const userPrompt = AI_PROMPTS.contractReview.userPromptTemplate\n      .replace('{documentText}', documentText)\n      .replace('{contractType}', contractType);\n\n    return this.makeRequest('/contracts/analyze', {\n      method: 'POST',\n      body: {\n        document_text: documentText,\n        contract_type: contractType,\n        analysis_type: 'comprehensive',\n        ai_prompt: {\n          system_prompt: AI_PROMPTS.contractReview.systemPrompt,\n          user_prompt: userPrompt\n        },\n        requirements: {\n          article_numbering: true,\n          deviation_classification: true,\n          risk_quantification: true,\n          track_changes: true\n        }\n      }\n    });\n  }\n\n  async generateContract(formData) {\n    return this.makeRequest('/contracts/generate', {\n      method: 'POST',\n      body: formData\n    });\n  }\n\n  async checkHealth() {\n    return this.makeRequest('/health');\n  }\n}\n","// Contract Analysis Service\nimport { updateStatus, showProgressSection, hideProgressSection, handleError, setButtonLoading } from '../../shared/utils.js';\nimport { AI_PROMPTS } from '../../shared/config.js';\n\n// Analyze track changes in the document\nexport async function analyzeTrackChanges() {\n  try {\n    // Ensure Word API is available\n    if (typeof Word === 'undefined') {\n      throw new Error('Word API not available. Please ensure you are running this add-in in Microsoft Word.');\n    }\n\n    // Additional check for Office.js initialization\n    if (!Office.context || !Office.context.document) {\n      throw new Error('Office.js not properly initialized. Please refresh the add-in.');\n    }\n\n    return await Word.run(async (context) => {\n      const body = context.document.body;\n      const revisions = context.document.revisions;\n\n      // Load revisions and their properties\n      revisions.load(\"items\");\n      body.load(\"text\");\n\n      await context.sync();\n\n      const changeData = {\n        hasChanges: revisions.items.length > 0,\n        totalRevisions: revisions.items.length,\n        revisions: []\n      };\n\n      // Analyze each revision\n      for (let i = 0; i < revisions.items.length; i++) {\n        const revision = revisions.items[i];\n        revision.load([\"range\", \"type\", \"author\", \"date\"]);\n        await context.sync();\n\n        revision.range.load([\"text\", \"start\", \"end\"]);\n        await context.sync();\n\n        changeData.revisions.push({\n          type: revision.type,\n          text: revision.range.text,\n          author: revision.author,\n          date: revision.date,\n          start: revision.range.start,\n          end: revision.range.end\n        });\n      }\n\n      return changeData;\n    });\n  } catch (error) {\n    console.error(\"Error analyzing track changes:\", error);\n    return { hasChanges: false, totalRevisions: 0, revisions: [] };\n  }\n}\n\n// Check if a specific text range has been modified\nexport async function checkClauseModifications(clauseText, startPosition) {\n  try {\n    // Ensure Word API is available\n    if (typeof Word === 'undefined') {\n      throw new Error('Word API not available. Please ensure you are running this add-in in Microsoft Word.');\n    }\n\n    // Additional check for Office.js initialization\n    if (!Office.context || !Office.context.document) {\n      throw new Error('Office.js not properly initialized. Please refresh the add-in.');\n    }\n\n    return await Word.run(async (context) => {\n      const body = context.document.body;\n      const searchResults = body.search(clauseText, { matchCase: false, matchWholeWord: false });\n      searchResults.load([\"items\"]);\n\n      await context.sync();\n\n      if (searchResults.items.length === 0) {\n        return { isModified: false, hasChanges: false };\n      }\n\n      const range = searchResults.items[0];\n      range.load([\"start\", \"end\", \"text\"]);\n      await context.sync();\n\n      // Check for revisions in this range\n      const revisions = context.document.revisions;\n      revisions.load(\"items\");\n      await context.sync();\n\n      let hasModifications = false;\n      const modifications = [];\n\n      for (let i = 0; i < revisions.items.length; i++) {\n        const revision = revisions.items[i];\n        revision.load([\"range\", \"type\", \"author\", \"date\"]);\n        await context.sync();\n\n        revision.range.load([\"start\", \"end\", \"text\"]);\n        await context.sync();\n\n        // Check if revision overlaps with our clause range\n        if (revision.range.start >= range.start && revision.range.end <= range.end) {\n          hasModifications = true;\n          modifications.push({\n            type: revision.type,\n            text: revision.range.text,\n            author: revision.author,\n            date: revision.date\n          });\n        }\n      }\n\n      return {\n        isModified: hasModifications,\n        hasChanges: hasModifications,\n        modifications: modifications,\n        originalText: clauseText,\n        currentText: range.text\n      };\n    });\n  } catch (error) {\n    console.error(\"Error checking clause modifications:\", error);\n    return { isModified: false, hasChanges: false };\n  }\n}\n\n// Generate demo analysis following the new AI prompt structure\nexport async function generateDemoAnalysis(documentText) {\n  console.log(\"Generating analysis using new AI prompt structure...\");\n\n  const wordCount = documentText.split(/\\s+/).length;\n  const hasSignatureLines = documentText.includes('_______') || documentText.includes('DATE:');\n  const hasParties = documentText.toLowerCase().includes('party') || documentText.toLowerCase().includes('agreement');\n  const hasTermination = documentText.toLowerCase().includes('termination') || documentText.toLowerCase().includes('terminate');\n  const hasCompensation = documentText.toLowerCase().includes('fee') || documentText.toLowerCase().includes('payment') || documentText.toLowerCase().includes('compensation');\n\n  // Simulate AI prompt processing\n  console.log(\"AI Prompt System Message:\", AI_PROMPTS.contractReview.systemPrompt.substring(0, 100) + \"...\");\n\n  // Determine contract type based on content\n  let contractType = \"General Agreement\";\n  if (documentText.toLowerCase().includes('content management')) {\n    contractType = \"Content Management Agreement\";\n  } else if (documentText.toLowerCase().includes('licensing')) {\n    contractType = \"Licensing Agreement\";\n  } else if (documentText.toLowerCase().includes('distribution')) {\n    contractType = \"Distribution Agreement\";\n  } else if (documentText.toLowerCase().includes('talent')) {\n    contractType = \"Talent Agreement\";\n  }\n\n  // Calculate a demo compliance score\n  let complianceScore = 70; // Base score\n  if (hasSignatureLines) complianceScore += 10;\n  if (hasParties) complianceScore += 10;\n  if (hasTermination) complianceScore += 5;\n  if (hasCompensation) complianceScore += 5;\n\n  // Generate risk assessment\n  const risks = [];\n  if (!hasTermination) {\n    risks.push(\"Missing termination clause - consider adding clear termination conditions\");\n  }\n  if (!hasCompensation) {\n    risks.push(\"Compensation terms unclear - ensure payment terms are explicitly defined\");\n  }\n  if (wordCount < 100) {\n    risks.push(\"Contract appears incomplete - consider adding more detailed terms\");\n  }\n\n  // Generate structured analysis following the new AI prompt format\n  const structuredAnalysis = await generateStructuredAnalysis(documentText, contractType);\n\n  return {\n    contract_type: contractType,\n    word_count: wordCount,\n    compliance_score: Math.min(complianceScore, 100),\n    summary: `This ${contractType.toLowerCase()} contains ${wordCount} words and appears to be ${complianceScore >= 80 ? 'well-structured' : 'missing some standard clauses'}. ${risks.length > 0 ? 'Several areas need attention.' : 'The contract structure looks good.'}`,\n    risks: risks,\n    key_terms: extractKeyTerms(documentText),\n    recommendations: generateRecommendations(risks.length, hasSignatureLines, hasTermination),\n    structured_analysis: structuredAnalysis, // New structured analysis following AI prompt format\n    contract_structure: await parseContractStructureWithChanges(documentText) // Keep existing structure for compatibility\n  };\n}\n\n// Generate structured analysis following the new AI prompt requirements\nasync function generateStructuredAnalysis(documentText, contractType) {\n  console.log(\"Generating structured analysis per AI prompt requirements...\");\n\n  // Step 1: Extract and number articles and clauses\n  const articleStructure = extractArticlesAndClauses(documentText);\n\n  // Step 2: Compare against standard library (simulated)\n  const deviationAnalysis = compareAgainstStandardLibrary(articleStructure, contractType);\n\n  // Step 3: Generate improvement recommendations\n  const improvementRecommendations = generateImprovementRecommendations(deviationAnalysis);\n\n  return {\n    article_structure: articleStructure,\n    deviation_analysis: deviationAnalysis,\n    improvement_recommendations: improvementRecommendations,\n    ai_prompt_used: \"contractReview\",\n    analysis_timestamp: new Date().toISOString()\n  };\n}\n\nexport function extractKeyTerms(text) {\n  const terms = [];\n  const lowerText = text.toLowerCase();\n\n  if (lowerText.includes('term') || lowerText.includes('duration')) {\n    terms.push(\"Contract Duration\");\n  }\n  if (lowerText.includes('fee') || lowerText.includes('payment')) {\n    terms.push(\"Payment Terms\");\n  }\n  if (lowerText.includes('territory') || lowerText.includes('worldwide')) {\n    terms.push(\"Geographic Scope\");\n  }\n  if (lowerText.includes('intellectual property') || lowerText.includes('rights')) {\n    terms.push(\"Rights Management\");\n  }\n\n  return terms.length > 0 ? terms : [\"Standard Contract Terms\"];\n}\n\nexport function generateRecommendations(riskCount, hasSignatures, hasTermination) {\n  const recommendations = [];\n\n  if (riskCount > 2) {\n    recommendations.push(\"Consider legal review before execution\");\n  }\n  if (!hasSignatures) {\n    recommendations.push(\"Add proper signature blocks and date fields\");\n  }\n  if (!hasTermination) {\n    recommendations.push(\"Include clear termination and dispute resolution clauses\");\n  }\n\n  recommendations.push(\"Ensure all parties review terms carefully\");\n  recommendations.push(\"Consider adding governing law and jurisdiction clauses\");\n\n  return recommendations;\n}\n\n// Risk Analysis Functions\nexport function generateRiskAnalysis(documentText) {\n  const risks = [];\n  const lowerText = documentText.toLowerCase();\n\n  // Check for missing critical clauses\n  if (!lowerText.includes('termination') && !lowerText.includes('terminate')) {\n    risks.push({\n      severity: 'high',\n      category: 'Missing Clause',\n      title: 'No Termination Clause',\n      description: 'Contract lacks clear termination conditions and procedures.',\n      location: 'Document-wide',\n      suggestion: 'Add a comprehensive termination clause specifying conditions, notice periods, and post-termination obligations.'\n    });\n  }\n\n  if (!lowerText.includes('liability') && !lowerText.includes('damages')) {\n    risks.push({\n      severity: 'critical',\n      category: 'Legal Risk',\n      title: 'No Liability Limitation',\n      description: 'Contract does not address liability limitations or damage caps.',\n      location: 'Document-wide',\n      suggestion: 'Include liability limitation clauses to protect against excessive damages.'\n    });\n  }\n\n  if (!lowerText.includes('dispute') && !lowerText.includes('arbitration') && !lowerText.includes('jurisdiction')) {\n    risks.push({\n      severity: 'medium',\n      category: 'Dispute Resolution',\n      title: 'No Dispute Resolution Mechanism',\n      description: 'Contract lacks clear dispute resolution procedures.',\n      location: 'Document-wide',\n      suggestion: 'Add dispute resolution clause specifying arbitration, mediation, or court jurisdiction.'\n    });\n  }\n\n  if (!lowerText.includes('confidential') && !lowerText.includes('proprietary')) {\n    risks.push({\n      severity: 'medium',\n      category: 'IP Protection',\n      title: 'No Confidentiality Provisions',\n      description: 'Contract may not adequately protect confidential information.',\n      location: 'Document-wide',\n      suggestion: 'Include confidentiality and non-disclosure provisions.'\n    });\n  }\n\n  if (!lowerText.includes('force majeure') && !lowerText.includes('act of god')) {\n    risks.push({\n      severity: 'low',\n      category: 'Risk Management',\n      title: 'No Force Majeure Clause',\n      description: 'Contract lacks protection against unforeseeable circumstances.',\n      location: 'Document-wide',\n      suggestion: 'Consider adding force majeure clause for protection against extraordinary events.'\n    });\n  }\n\n  return {\n    total_risks: risks.length,\n    risk_score: calculateRiskScore(risks),\n    risks: risks,\n    summary: `Found ${risks.length} potential risk areas. ${risks.filter(r => r.severity === 'critical').length} critical, ${risks.filter(r => r.severity === 'high').length} high, ${risks.filter(r => r.severity === 'medium').length} medium, ${risks.filter(r => r.severity === 'low').length} low priority issues.`\n  };\n}\n\nfunction calculateRiskScore(risks) {\n  let score = 100;\n  risks.forEach(risk => {\n    switch(risk.severity) {\n      case 'critical': score -= 25; break;\n      case 'high': score -= 15; break;\n      case 'medium': score -= 10; break;\n      case 'low': score -= 5; break;\n    }\n  });\n  return Math.max(score, 0);\n}\n\n// Change Suggestions Functions\nexport function generateChangeSuggestions(documentText) {\n  const suggestions = [];\n  const lowerText = documentText.toLowerCase();\n\n  // Analyze contract structure and suggest improvements\n  if (lowerText.includes('shall') && !lowerText.includes('may')) {\n    suggestions.push({\n      type: 'Language Improvement',\n      priority: 'medium',\n      title: 'Balance Mandatory vs Optional Language',\n      current: 'Contract uses only mandatory \"shall\" language',\n      suggested: 'Consider using \"may\" for optional provisions to provide flexibility',\n      benefit: 'Provides better balance between obligations and flexibility'\n    });\n  }\n\n  if (!lowerText.includes('including but not limited to') && !lowerText.includes('such as')) {\n    suggestions.push({\n      type: 'Clarity Enhancement',\n      priority: 'low',\n      title: 'Add Inclusive Language',\n      current: 'Lists may appear exhaustive',\n      suggested: 'Add \"including but not limited to\" before lists to indicate they are not exhaustive',\n      benefit: 'Prevents interpretation that lists are complete and exclusive'\n    });\n  }\n\n  if (lowerText.includes('reasonable') && !lowerText.includes('commercially reasonable')) {\n    suggestions.push({\n      type: 'Legal Precision',\n      priority: 'medium',\n      title: 'Clarify \"Reasonable\" Standards',\n      current: 'Uses vague \"reasonable\" standard',\n      suggested: 'Replace with \"commercially reasonable\" or define specific criteria',\n      benefit: 'Reduces ambiguity and potential disputes over reasonableness'\n    });\n  }\n\n  if (!lowerText.includes('time is of the essence')) {\n    suggestions.push({\n      type: 'Performance Standards',\n      priority: 'low',\n      title: 'Add Time Performance Clause',\n      current: 'No explicit time performance requirements',\n      suggested: 'Add \"time is of the essence\" clause for critical deadlines',\n      benefit: 'Emphasizes importance of meeting deadlines and strengthens enforcement'\n    });\n  }\n\n  suggestions.push({\n    type: 'Modern Practice',\n    priority: 'low',\n    title: 'Electronic Signature Provision',\n    current: 'Traditional signature requirements',\n    suggested: 'Add electronic signature acceptance clause',\n    benefit: 'Enables faster execution and modern business practices'\n  });\n\n  return {\n    total_suggestions: suggestions.length,\n    suggestions: suggestions,\n    summary: `Generated ${suggestions.length} improvement suggestions to enhance contract clarity, enforceability, and modern business practices.`\n  };\n}\n\n// Extract articles and clauses with proper numbering (1, 1.1, 1.1.1, 2, 2.1, etc.)\nfunction extractArticlesAndClauses(documentText) {\n  console.log(\"Extracting articles and clauses with structured numbering...\");\n\n  const lines = documentText.split('\\n').filter(line => line.trim().length > 0);\n  const structure = [];\n  let currentArticle = 0;\n  let currentClause = 0;\n\n  // Simulate article/clause detection (in real implementation, this would use NLP)\n  const articleKeywords = ['article', 'section', 'clause', 'term', 'provision'];\n  const clauseKeywords = ['shall', 'will', 'must', 'agrees', 'obligations'];\n\n  lines.forEach((line, index) => {\n    const lowerLine = line.toLowerCase();\n    const isArticleHeader = articleKeywords.some(keyword =>\n      lowerLine.includes(keyword) && line.length < 100\n    );\n\n    if (isArticleHeader || (index % 8 === 0 && line.length > 50)) {\n      // New article detected\n      currentArticle++;\n      currentClause = 0;\n\n      structure.push({\n        type: 'article',\n        number: currentArticle.toString(),\n        title: line.trim(),\n        content: line,\n        line_number: index + 1,\n        clauses: []\n      });\n    } else if (clauseKeywords.some(keyword => lowerLine.includes(keyword)) && line.length > 30) {\n      // New clause detected\n      if (currentArticle === 0) {\n        currentArticle = 1;\n        structure.push({\n          type: 'article',\n          number: '1',\n          title: 'General Provisions',\n          content: '',\n          line_number: 1,\n          clauses: []\n        });\n      }\n\n      currentClause++;\n      const clauseNumber = `${currentArticle}.${currentClause}`;\n      const currentArticleIndex = structure.findIndex(item => item.number === currentArticle.toString());\n\n      if (currentArticleIndex >= 0) {\n        structure[currentArticleIndex].clauses.push({\n          type: 'clause',\n          number: clauseNumber,\n          content: line.trim(),\n          line_number: index + 1,\n          sub_clauses: []\n        });\n      }\n    }\n  });\n\n  return structure;\n}\n\n// Compare against standard library and identify deviations\nfunction compareAgainstStandardLibrary(articleStructure, contractType) {\n  console.log(\"Comparing against standard library for\", contractType);\n\n  // Simulated standard library comparison\n  const standardClauses = getStandardClausesForType(contractType);\n  const deviations = [];\n\n  articleStructure.forEach(article => {\n    article.clauses.forEach(clause => {\n      const standardClause = findMatchingStandardClause(clause, standardClauses);\n\n      if (standardClause) {\n        const deviation = analyzeDeviation(clause, standardClause);\n        if (deviation.has_deviation) {\n          deviations.push({\n            clause_reference: clause.number,\n            clause_title: extractClauseTitle(clause.content),\n            deviation_type: deviation.type,\n            negotiable_status: deviation.negotiable ? 'negotiable' : 'non-negotiable',\n            risk_level: deviation.risk_level,\n            current_language: clause.content.substring(0, 100) + '...',\n            standard_language: standardClause.content.substring(0, 100) + '...',\n            deviation_description: deviation.description,\n            business_impact: deviation.business_impact\n          });\n        }\n      } else {\n        // Missing standard clause\n        deviations.push({\n          clause_reference: 'Missing',\n          clause_title: 'Standard Clause Not Found',\n          deviation_type: 'missing_clause',\n          negotiable_status: 'non-negotiable',\n          risk_level: 'high',\n          current_language: 'Clause not present in contract',\n          standard_language: 'Required standard clause missing',\n          deviation_description: 'This contract is missing a standard clause required for this contract type',\n          business_impact: 'High risk due to missing legal protection'\n        });\n      }\n    });\n  });\n\n  return deviations;\n}\n\n// Generate improvement recommendations based on deviations\nfunction generateImprovementRecommendations(deviations) {\n  console.log(\"Generating improvement recommendations...\");\n\n  const recommendations = [];\n\n  deviations.forEach(deviation => {\n    const recommendation = {\n      clause_reference: deviation.clause_reference,\n      priority: mapRiskToPriority(deviation.risk_level),\n      recommendation_type: deviation.negotiable_status === 'negotiable' ? 'optimization' : 'compliance',\n      current_risk_score: calculateDeviationRiskScore(deviation),\n      improved_language: generateImprovedLanguage(deviation),\n      risk_mitigation: generateRiskMitigation(deviation),\n      business_benefit: generateBusinessBenefit(deviation),\n      implementation_notes: generateImplementationNotes(deviation)\n    };\n\n    recommendations.push(recommendation);\n  });\n\n  return recommendations;\n}\n\n// Helper functions for the new AI prompt structure\n\nfunction getStandardClausesForType(contractType) {\n  // Simulated standard library - in real implementation, this would come from a database\n  const standardLibrary = {\n    'content-management': [\n      {\n        id: 'termination',\n        title: 'Termination Clause',\n        content: 'Either party may terminate this agreement with thirty (30) days written notice.',\n        negotiable: true,\n        category: 'termination'\n      },\n      {\n        id: 'payment',\n        title: 'Payment Terms',\n        content: 'Payment shall be made within thirty (30) days of invoice receipt.',\n        negotiable: false,\n        category: 'financial'\n      },\n      {\n        id: 'liability',\n        title: 'Limitation of Liability',\n        content: 'Neither party shall be liable for indirect, incidental, or consequential damages.',\n        negotiable: true,\n        category: 'liability'\n      }\n    ],\n    'licensing': [\n      {\n        id: 'scope',\n        title: 'License Scope',\n        content: 'License is granted for the specific territory and duration outlined herein.',\n        negotiable: false,\n        category: 'scope'\n      }\n    ]\n  };\n\n  return standardLibrary[contractType] || standardLibrary['content-management'];\n}\n\nfunction findMatchingStandardClause(clause, standardClauses) {\n  // Simple keyword matching - in real implementation, this would use semantic analysis\n  const clauseText = clause.content.toLowerCase();\n\n  return standardClauses.find(standard => {\n    const keywords = standard.category;\n    return clauseText.includes(keywords) || clauseText.includes(standard.title.toLowerCase());\n  });\n}\n\nfunction analyzeDeviation(clause, standardClause) {\n  // Simulate deviation analysis\n  const clauseText = clause.content.toLowerCase();\n  const standardText = standardClause.content.toLowerCase();\n\n  // Simple similarity check\n  const similarity = calculateTextSimilarity(clauseText, standardText);\n\n  if (similarity < 0.7) {\n    return {\n      has_deviation: true,\n      type: 'language_deviation',\n      negotiable: standardClause.negotiable,\n      risk_level: standardClause.negotiable ? 'medium' : 'high',\n      description: `Current clause deviates from standard ${standardClause.title}`,\n      business_impact: standardClause.negotiable ?\n        'May impact negotiation position' :\n        'Critical compliance issue requiring immediate attention'\n    };\n  }\n\n  return { has_deviation: false };\n}\n\nfunction extractClauseTitle(content) {\n  // Extract title from clause content\n  const words = content.split(' ').slice(0, 5);\n  return words.join(' ') + '...';\n}\n\nfunction calculateTextSimilarity(text1, text2) {\n  // Simple similarity calculation - in real implementation, use proper NLP\n  const words1 = new Set(text1.split(' '));\n  const words2 = new Set(text2.split(' '));\n  const intersection = new Set([...words1].filter(x => words2.has(x)));\n  const union = new Set([...words1, ...words2]);\n\n  return intersection.size / union.size;\n}\n\nfunction mapRiskToPriority(riskLevel) {\n  const mapping = {\n    'high': 'critical',\n    'medium': 'high',\n    'low': 'medium'\n  };\n  return mapping[riskLevel] || 'medium';\n}\n\nfunction calculateDeviationRiskScore(deviation) {\n  const scores = {\n    'high': 85,\n    'medium': 60,\n    'low': 30\n  };\n  return scores[deviation.risk_level] || 50;\n}\n\nfunction generateImprovedLanguage(deviation) {\n  return `Recommended revision for ${deviation.clause_title}: [Specific improved language would be generated here based on standard library and AI analysis]`;\n}\n\nfunction generateRiskMitigation(deviation) {\n  return `Risk mitigation: Address ${deviation.deviation_type} to reduce ${deviation.risk_level} risk exposure`;\n}\n\nfunction generateBusinessBenefit(deviation) {\n  return `Business benefit: Implementing this change will improve legal compliance and reduce potential disputes`;\n}\n\nfunction generateImplementationNotes(deviation) {\n  return `Implementation: ${deviation.negotiable_status === 'negotiable' ? 'Can be negotiated with counterparty' : 'Must be implemented to maintain compliance'}`;\n}\n","// Contract Generation Service\nimport { updateStatus, showProgressSection, hideProgressSection, handleError } from '../../shared/utils.js';\n\n// Form field definitions for different agreement types\nexport const FORM_TEMPLATES = {\n  'content-management': {\n    'music': [\n      { name: 'entity_name', label: 'Entity Name', type: 'text', required: true, description: 'Name of the contracting entity' },\n      { name: 'content_creator', label: 'Content Creator', type: 'text', required: true, description: 'Name of the content creator/artist' },\n      { name: 'scope_description', label: 'Scope of Work', type: 'textarea', required: true, description: 'Detailed description of content management services' },\n      { name: 'revenue_split', label: 'Revenue Split (%)', type: 'number', required: true, description: 'Percentage split for revenue sharing' },\n      { name: 'term_length', label: 'Contract Term', type: 'select', required: true, options: ['1 year', '2 years', '3 years', '5 years'], description: 'Duration of the agreement' },\n      { name: 'territory', label: 'Territory', type: 'select', required: true, options: ['Worldwide', 'North America', 'United States', 'Canada', 'Other'], description: 'Geographic scope of the agreement' },\n      { name: 'music_rights', label: 'Music Rights', type: 'select', required: true, options: ['Master Rights', 'Publishing Rights', 'Both', 'Synchronization Only'], description: 'Type of music rights being managed' },\n      { name: 'advance_amount', label: 'Advance Amount ($)', type: 'number', required: false, description: 'Initial advance payment (if applicable)' },\n      { name: 'termination_notice', label: 'Termination Notice (days)', type: 'number', required: true, description: 'Notice period required for termination' }\n    ],\n    'non-music': [\n      { name: 'entity_name', label: 'Entity Name', type: 'text', required: true, description: 'Name of the contracting entity' },\n      { name: 'content_creator', label: 'Content Creator', type: 'text', required: true, description: 'Name of the content creator' },\n      { name: 'scope_description', label: 'Scope of Work', type: 'textarea', required: true, description: 'Detailed description of content management services' },\n      { name: 'revenue_split', label: 'Revenue Split (%)', type: 'number', required: true, description: 'Percentage split for revenue sharing' },\n      { name: 'term_length', label: 'Contract Term', type: 'select', required: true, options: ['1 year', '2 years', '3 years', '5 years'], description: 'Duration of the agreement' },\n      { name: 'territory', label: 'Territory', type: 'select', required: true, options: ['Worldwide', 'North America', 'United States', 'Canada', 'Other'], description: 'Geographic scope of the agreement' },\n      { name: 'content_type', label: 'Content Type', type: 'select', required: true, options: ['Video Content', 'Podcast', 'Written Content', 'Social Media', 'Mixed Media'], description: 'Type of content being managed' },\n      { name: 'platform_focus', label: 'Platform Focus', type: 'select', required: true, options: ['YouTube', 'TikTok', 'Instagram', 'Multi-Platform', 'Other'], description: 'Primary platform for content distribution' },\n      { name: 'termination_notice', label: 'Termination Notice (days)', type: 'number', required: true, description: 'Notice period required for termination' }\n    ],\n    'both': [\n      { name: 'entity_name', label: 'Entity Name', type: 'text', required: true, description: 'Name of the contracting entity' },\n      { name: 'content_creator', label: 'Content Creator', type: 'text', required: true, description: 'Name of the content creator/artist' },\n      { name: 'scope_description', label: 'Scope of Work', type: 'textarea', required: true, description: 'Detailed description of content management services' },\n      { name: 'revenue_split_music', label: 'Music Revenue Split (%)', type: 'number', required: true, description: 'Percentage split for music revenue' },\n      { name: 'revenue_split_content', label: 'Content Revenue Split (%)', type: 'number', required: true, description: 'Percentage split for non-music content revenue' },\n      { name: 'term_length', label: 'Contract Term', type: 'select', required: true, options: ['1 year', '2 years', '3 years', '5 years'], description: 'Duration of the agreement' },\n      { name: 'territory', label: 'Territory', type: 'select', required: true, options: ['Worldwide', 'North America', 'United States', 'Canada', 'Other'], description: 'Geographic scope of the agreement' },\n      { name: 'music_rights', label: 'Music Rights', type: 'select', required: true, options: ['Master Rights', 'Publishing Rights', 'Both', 'Synchronization Only'], description: 'Type of music rights being managed' },\n      { name: 'content_platforms', label: 'Content Platforms', type: 'select', required: true, options: ['YouTube', 'TikTok', 'Instagram', 'Multi-Platform', 'Other'], description: 'Primary platforms for content distribution' },\n      { name: 'termination_notice', label: 'Termination Notice (days)', type: 'number', required: true, description: 'Notice period required for termination' }\n    ]\n  }\n};\n\n// Handle agreement type selection\nexport function handleAgreementTypeChange() {\n  const agreementType = document.getElementById(\"agreement-type\").value;\n  const contentTypeGroup = document.getElementById(\"content-type-group\");\n  const dynamicForm = document.getElementById(\"dynamic-form\");\n  const generateButtonGroup = document.getElementById(\"generate-button-group\");\n  \n  if (agreementType) {\n    contentTypeGroup.style.display = \"block\";\n    // Reset content type selection\n    document.getElementById(\"content-type\").value = \"\";\n    dynamicForm.style.display = \"none\";\n    generateButtonGroup.style.display = \"none\";\n  } else {\n    contentTypeGroup.style.display = \"none\";\n    dynamicForm.style.display = \"none\";\n    generateButtonGroup.style.display = \"none\";\n  }\n}\n\n// Handle content type selection\nexport function handleContentTypeChange() {\n  const agreementType = document.getElementById(\"agreement-type\").value;\n  const contentType = document.getElementById(\"content-type\").value;\n  const dynamicForm = document.getElementById(\"dynamic-form\");\n  const generateButtonGroup = document.getElementById(\"generate-button-group\");\n  \n  if (agreementType && contentType) {\n    generateDynamicForm(agreementType, contentType);\n    dynamicForm.style.display = \"block\";\n    generateButtonGroup.style.display = \"block\";\n  } else {\n    dynamicForm.style.display = \"none\";\n    generateButtonGroup.style.display = \"none\";\n  }\n}\n\n// Generate dynamic form based on selections\nexport function generateDynamicForm(agreementType, contentType) {\n  const dynamicForm = document.getElementById(\"dynamic-form\");\n  const template = FORM_TEMPLATES[agreementType]?.[contentType];\n  \n  if (!template) {\n    dynamicForm.innerHTML = '<p class=\"ms-font-s\">Form template not available for this combination.</p>';\n    return;\n  }\n  \n  let formHTML = '<h3 class=\"ms-font-l\">Contract Details</h3>';\n  \n  template.forEach(field => {\n    const requiredClass = field.required ? 'required-field' : '';\n    const requiredAttr = field.required ? 'required' : '';\n    \n    formHTML += `<div class=\"form-field ${requiredClass}\">`;\n    formHTML += `<label for=\"${field.name}\">${field.label}:</label>`;\n    \n    if (field.type === 'textarea') {\n      formHTML += `<textarea id=\"${field.name}\" name=\"${field.name}\" ${requiredAttr} placeholder=\"Enter ${field.label.toLowerCase()}\"></textarea>`;\n    } else if (field.type === 'select') {\n      formHTML += `<select id=\"${field.name}\" name=\"${field.name}\" ${requiredAttr}>`;\n      formHTML += `<option value=\"\">Select ${field.label}</option>`;\n      field.options.forEach(option => {\n        formHTML += `<option value=\"${option}\">${option}</option>`;\n      });\n      formHTML += `</select>`;\n    } else {\n      const inputType = field.type === 'number' ? 'number' : 'text';\n      formHTML += `<input type=\"${inputType}\" id=\"${field.name}\" name=\"${field.name}\" ${requiredAttr} placeholder=\"Enter ${field.label.toLowerCase()}\">`;\n    }\n    \n    if (field.description) {\n      formHTML += `<div class=\"field-description\">${field.description}</div>`;\n    }\n    \n    formHTML += `</div>`;\n  });\n  \n  dynamicForm.innerHTML = formHTML;\n}\n\n// Update contract preview with next contract details\nexport function updateContractPreview() {\n  const previewData = getNextContractPreview();\n\n  document.getElementById(\"preview-type\").textContent = previewData.type;\n  document.getElementById(\"preview-parties\").textContent = previewData.parties;\n  document.getElementById(\"preview-scope\").textContent = previewData.scope;\n}\n\n// Get preview data for the next contract to be generated\nfunction getNextContractPreview() {\n  const previews = [\n    {\n      type: \"Music Content Management Agreement\",\n      parties: \"Starling Music Management & Alex Rivera\",\n      scope: \"Digital distribution, rights management, and marketing\"\n    },\n    {\n      type: \"Video Content Management Agreement\",\n      parties: \"Digital Content Partners & Jordan Smith\",\n      scope: \"YouTube optimization and brand partnerships\"\n    },\n    {\n      type: \"Music Licensing Agreement\",\n      parties: \"Harmony Licensing Group & Taylor Music Productions\",\n      scope: \"Synchronization rights for film and television\"\n    }\n  ];\n\n  // Return a random preview to match the random contract generation\n  return previews[Math.floor(Math.random() * previews.length)];\n}\n\n// Collect form data - simplified for demo\nexport function collectFormData() {\n  // Since form fields are hidden, use varied demo values for more realistic contracts\n  const demoVariations = [\n    {\n      agreement_type: 'content-management',\n      content_type: 'music',\n      fields: {\n        entity_name: 'Starling Music Management LLC',\n        content_creator: 'Alex Rivera',\n        scope_description: 'Comprehensive music content management including digital distribution across all major platforms, rights management, marketing campaigns, and revenue collection services.',\n        revenue_split: '20',\n        term_length: '3 years',\n        territory: 'Worldwide',\n        music_rights: 'Master Rights',\n        advance_amount: '15000',\n        termination_notice: '60'\n      }\n    },\n    {\n      agreement_type: 'content-management',\n      content_type: 'non-music',\n      fields: {\n        entity_name: 'Digital Content Partners',\n        content_creator: 'Jordan Smith',\n        scope_description: 'Full-service content management for video content including YouTube optimization, brand partnerships, content strategy, and monetization.',\n        revenue_split: '25',\n        term_length: '2 years',\n        territory: 'North America',\n        content_type: 'Video Content',\n        platform_focus: 'YouTube',\n        termination_notice: '30'\n      }\n    },\n    {\n      agreement_type: 'licensing',\n      content_type: 'music',\n      fields: {\n        entity_name: 'Harmony Licensing Group',\n        content_creator: 'Taylor Music Productions',\n        scope_description: 'Licensing agreement for synchronization rights in film, television, and digital media.',\n        license_fee: '5000',\n        term_length: '5 years',\n        territory: 'Worldwide',\n        music_rights: 'Synchronization Rights',\n        termination_notice: '90'\n      }\n    }\n  ];\n\n  // Randomly select a demo variation for variety\n  const selectedDemo = demoVariations[Math.floor(Math.random() * demoVariations.length)];\n  return selectedDemo;\n}\n\n// Validate form data - simplified for demo\nexport function validateFormData(formData) {\n  // Since we're using default demo values, validation always passes\n  return true;\n}\n","// UI Display Module - handles all result display functionality\nimport { setButtonLoading } from '../../shared/utils.js';\n\n// Display combined analysis results\nexport function displayCombinedAnalysisResults(analysisResult, riskAnalysis, changeSuggestions, summaryResult) {\n  const resultsContent = document.getElementById(\"results-content\");\n  const resultsSection = document.getElementById(\"results-section\");\n\n  // Get contract structure data\n  const structure = analysisResult.contract_structure;\n  const modifiedClauses = structure.articles.reduce((count, article) =>\n    count + article.clauses.filter(clause => clause.changeStatus?.isModified).length, 0);\n  const totalClauses = structure.articles.reduce((count, article) => count + article.clauses.length, 0);\n\n  let html = `\n    <div class=\"analysis-results\">\n      <!-- 1. CONTRACT STRUCTURE BREAKDOWN (FIRST) -->\n      <div class=\"analysis-section contract-structure\">\n        <h3>📋 Contract Structure</h3>\n        <div class=\"structure-overview\">\n          <p><strong>Total Articles:</strong> ${structure.articles.length}</p>\n          <p><strong>Total Clauses:</strong> ${totalClauses}</p>\n        </div>\n        \n        <div class=\"articles-breakdown\">`;\n\n  // Display each article with its clauses\n  structure.articles.forEach(article => {\n    html += `\n          <div class=\"article-item\">\n            <h4 class=\"article-title\">${article.number}. ${article.title}</h4>\n            <div class=\"clauses-list\">`;\n    \n    article.clauses.forEach(clause => {\n      const statusClass = clause.changeStatus?.isModified ? 'modified' : 'unmodified';\n      const statusColor = clause.changeStatus?.isModified ? 'red' : 'green';\n      \n      html += `\n              <div class=\"clause-item ${statusClass}\">\n                <span class=\"clause-number\" style=\"color: ${statusColor};\">${clause.number}</span>\n                <span class=\"clause-text\">${clause.text.substring(0, 100)}${clause.text.length > 100 ? '...' : ''}</span>\n              </div>`;\n    });\n    \n    html += `\n            </div>\n          </div>`;\n  });\n\n  html += `\n        </div>\n      </div>\n\n      <!-- 2. TRACK CHANGES SUMMARY (AFTER STRUCTURE) -->\n      <div class=\"analysis-section track-changes-summary\">\n        <h3>🔄 Track Changes Summary</h3>\n        ${structure.trackChanges ? `\n          <div class=\"change-tracking-info\">\n            <p><strong>Track Changes:</strong> ${structure.trackChanges.enabled ? 'Enabled' : 'Disabled'}</p>\n            ${structure.trackChanges.enabled ? `\n              <p><strong>Modified Clauses:</strong> <span class=\"modified-count\">${modifiedClauses}</span> / ${totalClauses}</p>\n              <p><strong>Unmodified Clauses:</strong> <span class=\"unmodified-count\">${totalClauses - modifiedClauses}</span> / ${totalClauses}</p>\n            ` : ''}\n            ${structure.trackChanges.note ? `<p class=\"track-changes-note\"><em>${structure.trackChanges.note}</em></p>` : ''}\n            ${structure.trackChanges.demoMode ? '<p class=\"demo-note\"><em>Demo mode - simulated changes for testing</em></p>' : ''}\n          </div>\n          ${structure.trackChanges.enabled ? `\n            <div class=\"change-legend\">\n              <div class=\"legend-item\">\n                <span class=\"legend-indicator modified\"></span>\n                <span>Modified Clause</span>\n              </div>\n              <div class=\"legend-item\">\n                <span class=\"legend-indicator unmodified\"></span>\n                <span>Unmodified Clause</span>\n              </div>\n            </div>\n          ` : ''}\n        ` : ''}\n      </div>\n\n      <!-- 3. EXECUTIVE SUMMARY SECTION -->\n      <div class=\"analysis-summary\">\n        <h3>${summaryResult.title}</h3>\n        <div class=\"summary-overview\">\n          <p>${summaryResult.overview}</p>\n        </div>\n        \n        <div class=\"summary-metrics\">\n          <div class=\"metric-item\">\n            <span class=\"metric-label\">Contract Type:</span>\n            <span class=\"metric-value\">${analysisResult.contract_type}</span>\n          </div>\n          <div class=\"metric-item\">\n            <span class=\"metric-label\">Word Count:</span>\n            <span class=\"metric-value\">${analysisResult.word_count}</span>\n          </div>\n          <div class=\"metric-item\">\n            <span class=\"metric-label\">Compliance Score:</span>\n            <span class=\"metric-value compliance-score\">${analysisResult.compliance_score}%</span>\n          </div>\n          <div class=\"metric-item\">\n            <span class=\"metric-label\">Risk Score:</span>\n            <span class=\"metric-value risk-score\">${riskAnalysis.risk_score}%</span>\n          </div>\n        </div>\n      </div>\n\n      <!-- 4. DETAILED ANALYSIS SECTIONS -->\n      <div class=\"detailed-analysis\">\n        \n        <!-- Risk Analysis -->\n        <div class=\"analysis-section risks\">\n          <h3>⚠️ Risk Analysis</h3>\n          <p class=\"section-summary\">${riskAnalysis.summary}</p>\n          \n          <div class=\"risks-list\">`;\n\n  riskAnalysis.risks.forEach(risk => {\n    const severityClass = `severity-${risk.severity}`;\n    html += `\n            <div class=\"risk-item ${severityClass}\">\n              <div class=\"risk-header\">\n                <span class=\"risk-severity\">${risk.severity.toUpperCase()}</span>\n                <span class=\"risk-title\">${risk.title}</span>\n              </div>\n              <p class=\"risk-description\">${risk.description}</p>\n              <p class=\"risk-suggestion\"><strong>Suggestion:</strong> ${risk.suggestion}</p>\n            </div>`;\n  });\n\n  html += `\n          </div>\n        </div>\n\n        <!-- Change Suggestions -->\n        <div class=\"analysis-section suggestions\">\n          <h3>💡 Improvement Suggestions</h3>\n          <p class=\"section-summary\">${changeSuggestions.summary}</p>\n          \n          <div class=\"suggestions-list\">`;\n\n  changeSuggestions.suggestions.forEach(suggestion => {\n    const priorityClass = `priority-${suggestion.priority}`;\n    html += `\n            <div class=\"suggestion-item ${priorityClass}\">\n              <div class=\"suggestion-header\">\n                <span class=\"suggestion-priority\">${suggestion.priority.toUpperCase()}</span>\n                <span class=\"suggestion-title\">${suggestion.title}</span>\n              </div>\n              <div class=\"suggestion-details\">\n                <p><strong>Current:</strong> ${suggestion.current}</p>\n                <p><strong>Suggested:</strong> ${suggestion.suggested}</p>\n                <p><strong>Benefit:</strong> ${suggestion.benefit}</p>\n              </div>\n            </div>`;\n  });\n\n  html += `\n          </div>\n        </div>\n\n        <!-- Key Terms -->\n        <div class=\"analysis-section key-terms\">\n          <h3>🔑 Key Terms Identified</h3>\n          <div class=\"terms-list\">`;\n\n  analysisResult.key_terms.forEach(term => {\n    html += `<span class=\"term-tag\">${term}</span>`;\n  });\n\n  html += `\n          </div>\n        </div>\n\n        <!-- Recommendations -->\n        <div class=\"analysis-section recommendations\">\n          <h3>📝 Recommendations</h3>\n          <ul class=\"recommendations-list\">`;\n\n  analysisResult.recommendations.forEach(rec => {\n    html += `<li>${rec}</li>`;\n  });\n\n  html += `\n          </ul>\n        </div>\n      </div>\n    </div>`;\n\n  resultsContent.innerHTML = html;\n  resultsSection.style.display = \"block\";\n\n  // Show suggestions section with Apply Changes button\n  showSuggestionsSection(changeSuggestions);\n}\n\n// Show suggestions section with apply changes functionality\nexport function showSuggestionsSection(changeSuggestions) {\n  const suggestionsSection = document.getElementById(\"suggestions-section\");\n  const suggestionsContent = document.getElementById(\"suggestions-content\");\n\n  let html = `\n    <div class=\"suggestions-header\">\n      <h3>💡 Contract Improvement Suggestions</h3>\n      <p>Review and apply the following suggestions to improve your contract:</p>\n    </div>\n    \n    <div class=\"suggestions-list\">`;\n\n  changeSuggestions.suggestions.forEach((suggestion, index) => {\n    const priorityClass = `priority-${suggestion.priority}`;\n    html += `\n      <div class=\"suggestion-card ${priorityClass}\">\n        <div class=\"suggestion-header\">\n          <span class=\"priority-badge ${suggestion.priority}\">${suggestion.priority.toUpperCase()}</span>\n          <h4>${suggestion.title}</h4>\n        </div>\n        <div class=\"suggestion-content\">\n          <div class=\"current-state\">\n            <strong>Current:</strong> ${suggestion.current}\n          </div>\n          <div class=\"suggested-change\">\n            <strong>Suggested:</strong> ${suggestion.suggested}\n          </div>\n          <div class=\"benefit\">\n            <strong>Benefit:</strong> ${suggestion.benefit}\n          </div>\n        </div>\n        <div class=\"suggestion-actions\">\n          <button class=\"apply-suggestion-btn\" onclick=\"applySuggestion(${index})\">\n            Apply This Change\n          </button>\n        </div>\n      </div>`;\n  });\n\n  html += `\n    </div>\n    \n    <div class=\"suggestions-actions\">\n      <button id=\"apply-all-changes-btn\" class=\"primary-button\" onclick=\"applyAllChanges()\">\n        Apply All Changes\n      </button>\n      <button id=\"dismiss-suggestions-btn\" class=\"secondary-button\" onclick=\"dismissSuggestions()\">\n        Dismiss Suggestions\n      </button>\n    </div>`;\n\n  suggestionsContent.innerHTML = html;\n  suggestionsSection.style.display = \"block\";\n}\n\n// Display contract generation results\nexport function displayContractResults(result) {\n  const resultsContent = document.getElementById(\"results-content\");\n  const resultsSection = document.getElementById(\"results-section\");\n\n  const html = `\n    <div class=\"contract-results\">\n      <h3>✅ Contract Generated Successfully</h3>\n      <div class=\"contract-info\">\n        <p><strong>Contract Type:</strong> ${result.metadata?.template_used || 'Content Management Agreement'}</p>\n        <p><strong>Generated:</strong> ${new Date(result.metadata?.generated_at || new Date()).toLocaleString()}</p>\n        <p><strong>Status:</strong> <span class=\"status-success\">Ready for Review</span></p>\n      </div>\n      \n      <div class=\"contract-actions\">\n        <button id=\"review-contract-btn\" class=\"primary-button\" onclick=\"reviewGeneratedContract()\">\n          📋 Review Contract\n        </button>\n        <button id=\"analyze-new-contract-btn\" class=\"secondary-button\" onclick=\"analyzeContract()\">\n          🔍 Analyze Generated Contract\n        </button>\n      </div>\n      \n      <div class=\"next-steps\">\n        <h4>Next Steps:</h4>\n        <ul>\n          <li>Review the generated contract content</li>\n          <li>Run contract analysis to check for risks</li>\n          <li>Make any necessary modifications</li>\n          <li>Save and share with relevant parties</li>\n        </ul>\n      </div>\n    </div>`;\n\n  resultsContent.innerHTML = html;\n  resultsSection.style.display = \"block\";\n}\n\n// Display structured analysis results following the new AI prompt format\nexport function displayStructuredAnalysisResults(analysisResult) {\n  const resultsContent = document.getElementById(\"results-content\");\n  const resultsSection = document.getElementById(\"results-section\");\n\n  // Check if we have the new structured analysis format\n  if (!analysisResult.structured_analysis) {\n    // Fall back to the existing display function\n    console.log(\"No structured analysis found, using legacy display\");\n    return;\n  }\n\n  const structured = analysisResult.structured_analysis;\n\n  let html = `\n    <div class=\"structured-analysis-results\">\n      <div class=\"analysis-header\">\n        <h2>📋 AI Contract Analysis Report</h2>\n        <div class=\"analysis-meta\">\n          <p><strong>Contract Type:</strong> ${analysisResult.contract_type}</p>\n          <p><strong>Analysis Date:</strong> ${new Date(structured.analysis_timestamp).toLocaleString()}</p>\n          <p><strong>AI Prompt:</strong> ${structured.ai_prompt_used}</p>\n        </div>\n      </div>\n\n      <!-- 1. ARTICLE STRUCTURE (Following numbering: 1, 1.1, 1.1.1, 2, 2.1, etc.) -->\n      <div class=\"analysis-section article-structure\">\n        <h3>📑 Contract Structure Analysis</h3>\n        <div class=\"structure-summary\">\n          <p>Articles identified and numbered according to legal standards:</p>\n        </div>\n\n        <div class=\"articles-breakdown\">`;\n\n  // Display articles with proper numbering\n  structured.article_structure.forEach(article => {\n    html += `\n          <div class=\"article-container\">\n            <div class=\"article-header\">\n              <h4 class=\"article-number\">Article ${article.number}</h4>\n              <h5 class=\"article-title\">${article.title}</h5>\n            </div>\n\n            <div class=\"clauses-container\">`;\n\n    article.clauses.forEach(clause => {\n      html += `\n              <div class=\"clause-item\">\n                <span class=\"clause-number\">${clause.number}</span>\n                <div class=\"clause-content\">\n                  <p>${clause.content}</p>\n                  <small class=\"line-reference\">Line ${clause.line_number}</small>\n                </div>\n              </div>`;\n    });\n\n    html += `\n            </div>\n          </div>`;\n  });\n\n  html += `\n        </div>\n      </div>\n\n      <!-- 2. DEVIATION ANALYSIS -->\n      <div class=\"analysis-section deviation-analysis\">\n        <h3>⚖️ Standard Library Comparison</h3>\n        <div class=\"deviations-summary\">\n          <p>Deviations from company standard clauses:</p>\n        </div>\n\n        <div class=\"deviations-list\">`;\n\n  structured.deviation_analysis.forEach(deviation => {\n    const statusClass = deviation.negotiable_status === 'negotiable' ? 'negotiable' : 'non-negotiable';\n    const riskClass = `risk-${deviation.risk_level}`;\n\n    html += `\n          <div class=\"deviation-item ${statusClass} ${riskClass}\">\n            <div class=\"deviation-header\">\n              <span class=\"clause-ref\">Clause ${deviation.clause_reference}</span>\n              <span class=\"negotiable-badge ${deviation.negotiable_status}\">\n                ${deviation.negotiable_status.toUpperCase()}\n              </span>\n              <span class=\"risk-badge ${deviation.risk_level}\">\n                ${deviation.risk_level.toUpperCase()} RISK\n              </span>\n            </div>\n\n            <div class=\"deviation-content\">\n              <h5>${deviation.clause_title}</h5>\n              <p class=\"deviation-description\">${deviation.deviation_description}</p>\n\n              <div class=\"language-comparison\">\n                <div class=\"current-language\">\n                  <strong>Current Language:</strong>\n                  <p>${deviation.current_language}</p>\n                </div>\n                <div class=\"standard-language\">\n                  <strong>Standard Library:</strong>\n                  <p>${deviation.standard_language}</p>\n                </div>\n              </div>\n\n              <div class=\"business-impact\">\n                <strong>Business Impact:</strong> ${deviation.business_impact}\n              </div>\n            </div>\n          </div>`;\n  });\n\n  html += `\n        </div>\n      </div>\n\n      <!-- 3. IMPROVEMENT RECOMMENDATIONS -->\n      <div class=\"analysis-section improvement-recommendations\">\n        <h3>💡 Improvement Recommendations</h3>\n        <div class=\"recommendations-summary\">\n          <p>Specific language revisions and compliance recommendations:</p>\n        </div>\n\n        <div class=\"recommendations-list\">`;\n\n  structured.improvement_recommendations.forEach(recommendation => {\n    const priorityClass = `priority-${recommendation.priority}`;\n    const typeClass = `type-${recommendation.recommendation_type}`;\n\n    html += `\n          <div class=\"recommendation-item ${priorityClass} ${typeClass}\">\n            <div class=\"recommendation-header\">\n              <span class=\"clause-ref\">Clause ${recommendation.clause_reference}</span>\n              <span class=\"priority-badge ${recommendation.priority}\">\n                ${recommendation.priority.toUpperCase()}\n              </span>\n              <span class=\"type-badge ${recommendation.recommendation_type}\">\n                ${recommendation.recommendation_type.toUpperCase()}\n              </span>\n            </div>\n\n            <div class=\"recommendation-content\">\n              <div class=\"risk-score\">\n                <strong>Current Risk Score:</strong>\n                <span class=\"score\">${recommendation.current_risk_score}/100</span>\n              </div>\n\n              <div class=\"improved-language\">\n                <strong>Recommended Language:</strong>\n                <p>${recommendation.improved_language}</p>\n              </div>\n\n              <div class=\"benefits\">\n                <div class=\"risk-mitigation\">\n                  <strong>Risk Mitigation:</strong> ${recommendation.risk_mitigation}\n                </div>\n                <div class=\"business-benefit\">\n                  <strong>Business Benefit:</strong> ${recommendation.business_benefit}\n                </div>\n              </div>\n\n              <div class=\"implementation\">\n                <strong>Implementation Notes:</strong> ${recommendation.implementation_notes}\n              </div>\n            </div>\n          </div>`;\n  });\n\n  html += `\n        </div>\n      </div>\n\n      <!-- 4. SUMMARY METRICS -->\n      <div class=\"analysis-section summary-metrics\">\n        <h3>📊 Analysis Summary</h3>\n        <div class=\"metrics-grid\">\n          <div class=\"metric-card\">\n            <span class=\"metric-label\">Total Articles</span>\n            <span class=\"metric-value\">${structured.article_structure.length}</span>\n          </div>\n          <div class=\"metric-card\">\n            <span class=\"metric-label\">Deviations Found</span>\n            <span class=\"metric-value\">${structured.deviation_analysis.length}</span>\n          </div>\n          <div class=\"metric-card\">\n            <span class=\"metric-label\">Recommendations</span>\n            <span class=\"metric-value\">${structured.improvement_recommendations.length}</span>\n          </div>\n          <div class=\"metric-card\">\n            <span class=\"metric-label\">Compliance Score</span>\n            <span class=\"metric-value\">${analysisResult.compliance_score}%</span>\n          </div>\n        </div>\n      </div>\n    </div>`;\n\n  resultsContent.innerHTML = html;\n  resultsSection.style.display = \"block\";\n\n  // Show suggestions section if we have recommendations\n  if (structured.improvement_recommendations.length > 0) {\n    showStructuredSuggestionsSection(structured.improvement_recommendations);\n  }\n}\n\n// Show suggestions section for structured recommendations\nfunction showStructuredSuggestionsSection(recommendations) {\n  const suggestionsSection = document.getElementById(\"suggestions-section\");\n  const suggestionsContent = document.getElementById(\"suggestions-content\");\n\n  let html = `\n    <div class=\"structured-suggestions-header\">\n      <h3>🔧 Apply Recommended Changes</h3>\n      <p>Review and apply AI-recommended improvements to optimize your contract:</p>\n    </div>\n\n    <div class=\"structured-suggestions-list\">`;\n\n  recommendations.forEach((recommendation, index) => {\n    const priorityClass = `priority-${recommendation.priority}`;\n    const typeClass = `type-${recommendation.recommendation_type}`;\n\n    html += `\n      <div class=\"structured-suggestion-card ${priorityClass} ${typeClass}\">\n        <div class=\"suggestion-header\">\n          <span class=\"clause-ref\">Clause ${recommendation.clause_reference}</span>\n          <span class=\"priority-badge ${recommendation.priority}\">${recommendation.priority.toUpperCase()}</span>\n          <span class=\"type-badge ${recommendation.recommendation_type}\">${recommendation.recommendation_type.toUpperCase()}</span>\n        </div>\n        <div class=\"suggestion-content\">\n          <div class=\"risk-info\">\n            <strong>Current Risk Score:</strong> <span class=\"risk-score\">${recommendation.current_risk_score}/100</span>\n          </div>\n          <div class=\"improved-language\">\n            <strong>Recommended Language:</strong>\n            <p>${recommendation.improved_language}</p>\n          </div>\n          <div class=\"benefits\">\n            <p><strong>Business Benefit:</strong> ${recommendation.business_benefit}</p>\n          </div>\n        </div>\n        <div class=\"suggestion-actions\">\n          <button class=\"apply-structured-suggestion-btn\" onclick=\"applyStructuredSuggestion(${index})\">\n            Apply This Change\n          </button>\n        </div>\n      </div>`;\n  });\n\n  html += `\n    </div>\n\n    <div class=\"structured-suggestions-actions\">\n      <button id=\"apply-all-structured-changes-btn\" class=\"primary-button\" onclick=\"applyAllStructuredChanges()\">\n        Apply All Recommendations\n      </button>\n      <button id=\"dismiss-structured-suggestions-btn\" class=\"secondary-button\" onclick=\"dismissSuggestions()\">\n        Dismiss Suggestions\n      </button>\n    </div>`;\n\n  suggestionsContent.innerHTML = html;\n  suggestionsSection.style.display = \"block\";\n}\n","// Event Handlers Module\nimport { APIService } from '../../shared/api-service.js';\nimport { API_CONFIG } from '../../shared/config.js';\nimport { updateStatus, showProgressSection, hideProgressSection, handleError, setButtonLoading, clearResults, clearSuggestions } from '../../shared/utils.js';\nimport { generateDemoAnalysis, generateRiskAnalysis, generateChangeSuggestions } from '../services/contract-analyzer.js';\nimport { handleAgreementTypeChange, handleContentTypeChange, collectFormData, validateFormData, updateContractPreview } from '../services/contract-generator.js';\nimport { displayCombinedAnalysisResults, displayContractResults, displayStructuredAnalysisResults } from './ui-display.js';\n\n// Initialize API service\nconst apiService = new APIService(API_CONFIG);\n\n// Contract Generation Event Handlers\nexport async function generateContract() {\n  setButtonLoading(\"generate-contract-btn\", true);\n  showProgressSection(\"Generating contract...\");\n  updateStatus(\"Preparing contract generation...\", \"info\");\n\n  try {\n    // Collect and validate form data\n    const formData = collectFormData();\n    \n    if (!validateFormData(formData)) {\n      throw new Error(\"Please fill in all required fields\");\n    }\n\n    updateStatus(\"Generating contract content...\", \"info\");\n\n    // Generate contract using API service\n    const result = await apiService.generateContract(formData);\n\n    // Insert contract into Word document\n    await insertContractIntoDocument(result, formData);\n\n    // Display results\n    displayContractResults(result);\n    \n    updateStatus(\"Contract generated successfully!\", \"success\");\n    hideProgressSection();\n\n  } catch (error) {\n    handleError(error);\n  } finally {\n    setButtonLoading(\"generate-contract-btn\", false);\n  }\n}\n\n// Contract Analysis Event Handlers\nexport async function analyzeContract() {\n  setButtonLoading(\"analyze-contract-btn\", true);\n  showProgressSection(\"Analyzing contract...\");\n  updateStatus(\"Reading document content...\", \"info\");\n\n  try {\n    // Get document text\n    const documentText = await getDocumentText();\n    \n    if (!documentText || documentText.trim().length < 50) {\n      throw new Error(\"Document appears to be empty or too short to analyze. Please ensure you have contract content in the document.\");\n    }\n\n    updateStatus(\"Performing contract analysis...\", \"info\");\n\n    // Perform comprehensive analysis\n    const [analysisResult, riskAnalysis, changeSuggestions] = await Promise.all([\n      generateDemoAnalysis(documentText),\n      generateRiskAnalysis(documentText),\n      generateChangeSuggestions(documentText)\n    ]);\n\n    // Generate executive summary\n    const summaryResult = generateExecutiveSummary(analysisResult, riskAnalysis, changeSuggestions);\n\n    updateStatus(\"Analysis complete!\", \"success\");\n\n    // Check if we have structured analysis and display accordingly\n    if (analysisResult.structured_analysis) {\n      console.log(\"Displaying structured analysis results using new AI prompt format\");\n      displayStructuredAnalysisResults(analysisResult);\n    } else {\n      console.log(\"Displaying legacy analysis results\");\n      displayCombinedAnalysisResults(analysisResult, riskAnalysis, changeSuggestions, summaryResult);\n    }\n\n    hideProgressSection();\n\n  } catch (error) {\n    handleError(error);\n  } finally {\n    setButtonLoading(\"analyze-contract-btn\", false);\n  }\n}\n\n// Suggestion Application Event Handlers\nexport async function applySuggestion(suggestionIndex) {\n  updateStatus(`Applying suggestion ${suggestionIndex + 1}...`, \"info\");\n  \n  try {\n    // In a real implementation, this would apply the specific suggestion to the document\n    // For demo purposes, we'll just show a success message\n    await new Promise(resolve => setTimeout(resolve, 1000)); // Simulate processing\n    \n    updateStatus(`Suggestion ${suggestionIndex + 1} applied successfully!`, \"success\");\n    \n    // Update the UI to show the suggestion as applied\n    const suggestionCard = document.querySelectorAll('.suggestion-card')[suggestionIndex];\n    if (suggestionCard) {\n      suggestionCard.classList.add('applied');\n      const applyBtn = suggestionCard.querySelector('.apply-suggestion-btn');\n      if (applyBtn) {\n        applyBtn.textContent = '✓ Applied';\n        applyBtn.disabled = true;\n      }\n    }\n    \n  } catch (error) {\n    handleError(error);\n  }\n}\n\nexport async function applyAllChanges() {\n  setButtonLoading(\"apply-all-changes-btn\", true);\n  updateStatus(\"Applying all suggestions...\", \"info\");\n  \n  try {\n    // In a real implementation, this would apply all suggestions to the document\n    await new Promise(resolve => setTimeout(resolve, 2000)); // Simulate processing\n    \n    updateStatus(\"All suggestions applied successfully!\", \"success\");\n    \n    // Update UI to show all suggestions as applied\n    const suggestionCards = document.querySelectorAll('.suggestion-card');\n    suggestionCards.forEach(card => {\n      card.classList.add('applied');\n      const applyBtn = card.querySelector('.apply-suggestion-btn');\n      if (applyBtn) {\n        applyBtn.textContent = '✓ Applied';\n        applyBtn.disabled = true;\n      }\n    });\n    \n    // Hide the apply all button\n    document.getElementById(\"apply-all-changes-btn\").style.display = 'none';\n    \n  } catch (error) {\n    handleError(error);\n  } finally {\n    setButtonLoading(\"apply-all-changes-btn\", false);\n  }\n}\n\nexport function dismissSuggestions() {\n  clearSuggestions();\n  updateStatus(\"Suggestions dismissed\", \"info\");\n}\n\n// Utility Functions\nasync function getDocumentText() {\n  // Ensure Word API is available\n  if (typeof Word === 'undefined') {\n    throw new Error('Word API not available. Please ensure you are running this add-in in Microsoft Word.');\n  }\n\n  // Additional check for Office.js initialization\n  if (!Office.context || !Office.context.document) {\n    throw new Error('Office.js not properly initialized. Please refresh the add-in.');\n  }\n\n  return await Word.run(async (context) => {\n    const body = context.document.body;\n    body.load(\"text\");\n    await context.sync();\n    return body.text;\n  });\n}\n\nasync function insertContractIntoDocument(result, formData) {\n  // Ensure Word API is available\n  if (typeof Word === 'undefined') {\n    throw new Error('Word API not available. Please ensure you are running this add-in in Microsoft Word.');\n  }\n\n  // Additional check for Office.js initialization\n  if (!Office.context || !Office.context.document) {\n    throw new Error('Office.js not properly initialized. Please refresh the add-in.');\n  }\n\n  return await Word.run(async (context) => {\n    const body = context.document.body;\n    \n    // Clear existing content\n    body.clear();\n    \n    // Generate contract content based on form data\n    const contractContent = generateContractContent(formData);\n    \n    // Insert the contract\n    body.insertText(contractContent, Word.InsertLocation.start);\n    \n    // Apply formatting\n    const range = body.getRange();\n    range.font.name = \"Calibri\";\n    range.font.size = 11;\n    \n    await context.sync();\n  });\n}\n\nfunction generateContractContent(formData) {\n  // Generate realistic contract content based on form data\n  const templates = {\n    'content-management': {\n      'music': `MUSIC CONTENT MANAGEMENT AGREEMENT\n\nThis Music Content Management Agreement (\"Agreement\") is entered into on ${new Date().toLocaleDateString()} between ${formData.fields.entity_name || 'Starling Music Management LLC'}, a limited liability company (\"Manager\"), and ${formData.fields.content_creator || 'Artist Name'} (\"Artist\").\n\n1. SCOPE OF SERVICES\nManager agrees to provide comprehensive music content management services including:\n- Digital distribution across all major streaming platforms (Spotify, Apple Music, Amazon Music, etc.)\n- Rights management and royalty collection\n- Marketing and promotional campaigns\n- Performance tracking and analytics\n- Playlist pitching and promotion\n\n2. REVENUE SHARING\nArtist and Manager agree to the following revenue split:\n- Artist: ${100 - (formData.fields.revenue_split || 20)}%\n- Manager: ${formData.fields.revenue_split || 20}%\n\n3. TERM AND TERRITORY\nThis Agreement shall remain in effect for ${formData.fields.term_length || '3 years'} and covers ${formData.fields.territory || 'Worldwide'}.\n\n4. RIGHTS GRANTED\nArtist grants Manager the right to manage ${formData.fields.music_rights || 'Master Rights'} for the specified territory and term.\n\n5. ADVANCE\n${formData.fields.advance_amount ? `Manager will provide an advance of $${formData.fields.advance_amount} upon execution of this Agreement.` : 'No advance payment is included in this Agreement.'}\n\n6. TERMINATION\nEither party may terminate this Agreement with ${formData.fields.termination_notice || '60'} days written notice.\n\n7. GOVERNING LAW\nThis Agreement shall be governed by the laws of the State of California.\n\nIN WITNESS WHEREOF, the parties have executed this Agreement as of the date first written above.\n\nMANAGER:                           ARTIST:\n\n_________________________         _________________________\n${formData.fields.entity_name || 'Starling Music Management LLC'}    ${formData.fields.content_creator || 'Artist Name'}\n\nDate: _______________             Date: _______________`,\n\n      'non-music': `CONTENT MANAGEMENT AGREEMENT\n\nThis Content Management Agreement (\"Agreement\") is entered into on ${new Date().toLocaleDateString()} between ${formData.fields.entity_name || 'Digital Content Partners'} (\"Manager\") and ${formData.fields.content_creator || 'Content Creator'} (\"Creator\").\n\n1. CONTENT MANAGEMENT SERVICES\nManager will provide comprehensive content management including:\n- ${formData.fields.content_type || 'Video Content'} optimization and strategy\n- Platform management for ${formData.fields.platform_focus || 'YouTube'}\n- Brand partnership facilitation\n- Revenue optimization and analytics\n- Content scheduling and distribution\n\n2. COMPENSATION\nRevenue sharing arrangement:\n- Creator: ${100 - (formData.fields.revenue_split || 25)}%\n- Manager: ${formData.fields.revenue_split || 25}%\n\n3. TERM AND SCOPE\nDuration: ${formData.fields.term_length || '2 years'}\nTerritory: ${formData.fields.territory || 'North America'}\n\n4. CONTENT RIGHTS\nCreator grants Manager limited rights to manage and distribute content on agreed platforms.\n\n5. TERMINATION\nEither party may terminate with ${formData.fields.termination_notice || '30'} days written notice.\n\n6. GOVERNING LAW\nThis Agreement is governed by applicable state and federal laws.\n\nSIGNATURES:\n\nMANAGER:                           CREATOR:\n\n_________________________         _________________________\n${formData.fields.entity_name || 'Digital Content Partners'}      ${formData.fields.content_creator || 'Content Creator'}\n\nDate: _______________             Date: _______________`\n    }\n  };\n\n  const template = templates[formData.agreement_type]?.[formData.content_type];\n  return template || 'Contract content would be generated here based on your selections.';\n}\n\nfunction generateExecutiveSummary(analysisResult, riskAnalysis, changeSuggestions) {\n  const riskLevel = riskAnalysis.risk_score >= 80 ? 'Low' : \n                   riskAnalysis.risk_score >= 60 ? 'Medium' : 'High';\n  \n  return {\n    title: \"📊 Executive Summary\",\n    overview: `This ${analysisResult.contract_type.toLowerCase()} has been analyzed for compliance, risks, and improvement opportunities. The contract shows a ${riskLevel.toLowerCase()} risk profile with ${riskAnalysis.risks.length} identified areas for attention and ${changeSuggestions.suggestions.length} improvement suggestions.`\n  };\n}\n\n// Export form change handlers\nexport { handleAgreementTypeChange, handleContentTypeChange };\n\n// Export utility functions for global access\nwindow.generateContract = generateContract;\nwindow.analyzeContract = analyzeContract;\nwindow.applySuggestion = applySuggestion;\nwindow.applyAllChanges = applyAllChanges;\nwindow.dismissSuggestions = dismissSuggestions;\nwindow.clearResults = clearResults;\nwindow.clearSuggestions = clearSuggestions;\nwindow.handleAgreementTypeChange = handleAgreementTypeChange;\nwindow.handleContentTypeChange = handleContentTypeChange;\n","// RHEI AI Legal Assistant - Main Taskpane Module\n// Modular architecture for better maintainability\n\n// Import all modules and services\nimport { initializeTheme, updateStatus, clearResults, clearSuggestions, handleError } from '../shared/utils.js';\nimport { \n  generateContract, \n  analyzeContract, \n  handleAgreementTypeChange, \n  handleContentTypeChange \n} from './modules/event-handlers.js';\n\n// Initialize the add-in\nOffice.onReady((info) => {\n  if (info.host === Office.HostApplication.Word) {\n    console.log(\"RHEI AI Legal Assistant loaded successfully\");\n\n    // Check if Word API is available\n    if (typeof Word === 'undefined') {\n      console.error(\"Word API not available\");\n      updateStatus(\"Error: Word API not available. Please refresh the add-in.\", \"error\");\n      return;\n    }\n\n    console.log(\"Word API is available\");\n\n    // Initialize theme\n    initializeTheme();\n\n    // Set up event listeners\n    setupEventListeners();\n\n    // Initialize UI state\n    initializeUI();\n\n    console.log(\"Add-in initialization complete\");\n  } else {\n    console.error(\"This add-in is designed for Microsoft Word only\");\n    updateStatus(\"Error: This add-in requires Microsoft Word\", \"error\");\n  }\n});\n\n// Set up all event listeners\nfunction setupEventListeners() {\n  // Contract generation events\n  const generateBtn = document.getElementById(\"generate-contract\");\n  if (generateBtn) {\n    generateBtn.addEventListener(\"click\", generateContract);\n  }\n\n  // Contract analysis events\n  const analyzeBtn = document.getElementById(\"analyze-contract\");\n  if (analyzeBtn) {\n    analyzeBtn.addEventListener(\"click\", analyzeContract);\n  }\n\n  // Form change events\n  const agreementTypeSelect = document.getElementById(\"agreement-type\");\n  if (agreementTypeSelect) {\n    agreementTypeSelect.addEventListener(\"change\", handleAgreementTypeChange);\n  }\n\n  const contentTypeSelect = document.getElementById(\"content-type\");\n  if (contentTypeSelect) {\n    contentTypeSelect.addEventListener(\"change\", handleContentTypeChange);\n  }\n\n  // Clear buttons\n  const clearResultsBtn = document.getElementById(\"clear-results\");\n  if (clearResultsBtn) {\n    clearResultsBtn.addEventListener(\"click\", clearResults);\n  }\n\n  const clearSuggestionsBtn = document.getElementById(\"clear-suggestions\");\n  if (clearSuggestionsBtn) {\n    clearSuggestionsBtn.addEventListener(\"click\", clearSuggestions);\n  }\n\n  // Additional feature buttons\n  const toggleTrackChangesBtn = document.getElementById(\"toggle-track-changes\");\n  if (toggleTrackChangesBtn) {\n    toggleTrackChangesBtn.addEventListener(\"click\", toggleTrackChanges);\n  }\n\n  const highlightRisksBtn = document.getElementById(\"highlight-risks\");\n  if (highlightRisksBtn) {\n    highlightRisksBtn.addEventListener(\"click\", highlightRisks);\n  }\n\n  const checkComplianceBtn = document.getElementById(\"check-compliance\");\n  if (checkComplianceBtn) {\n    checkComplianceBtn.addEventListener(\"click\", checkCompliance);\n  }\n\n  const suggestChangesBtn = document.getElementById(\"suggest-changes\");\n  if (suggestChangesBtn) {\n    suggestChangesBtn.addEventListener(\"click\", suggestChanges);\n  }\n\n  console.log(\"Event listeners set up successfully\");\n}\n\n// Initialize UI state\nfunction initializeUI() {\n  // Hide dynamic sections initially\n  const dynamicForm = document.getElementById(\"dynamic-form\");\n  const generateButtonGroup = document.getElementById(\"generate-button-group\");\n  const contentTypeGroup = document.getElementById(\"content-type-group\");\n  const resultsSection = document.getElementById(\"results-section\");\n  const suggestionsSection = document.getElementById(\"suggestions-section\");\n  const progressSection = document.getElementById(\"progress-section\");\n\n  if (dynamicForm) dynamicForm.style.display = \"none\";\n  if (generateButtonGroup) generateButtonGroup.style.display = \"none\";\n  if (contentTypeGroup) contentTypeGroup.style.display = \"none\";\n  if (resultsSection) resultsSection.style.display = \"none\";\n  if (suggestionsSection) suggestionsSection.style.display = \"none\";\n  if (progressSection) progressSection.style.display = \"none\";\n\n  // Set initial status\n  updateStatus(\"Ready to generate or analyze contracts\", \"info\");\n\n  console.log(\"UI initialized successfully\");\n}\n\n// Global error handler\nwindow.addEventListener('error', (event) => {\n  console.error('Global error:', event.error);\n  handleError(event.error);\n});\n\n// Global unhandled promise rejection handler\nwindow.addEventListener('unhandledrejection', (event) => {\n  console.error('Unhandled promise rejection:', event.reason);\n  handleError(event.reason);\n});\n\n// Placeholder functions for additional features\nfunction toggleTrackChanges() {\n  updateStatus(\"Toggling track changes...\", \"info\");\n  // Implementation will be added later\n}\n\nfunction highlightRisks() {\n  updateStatus(\"Highlighting risks...\", \"info\");\n  // Implementation will be added later\n}\n\nfunction checkCompliance() {\n  updateStatus(\"Checking compliance...\", \"info\");\n  // Implementation will be added later\n}\n\nfunction suggestChanges() {\n  updateStatus(\"Applying suggested changes...\", \"info\");\n  // Implementation will be added later\n}\n\nconsole.log(\"RHEI AI Legal Assistant module loaded\");\n"],"names":["setButtonLoading","buttonId","isLoading","button","document","getElementById","classList","add","disabled","remove","updateStatus","message","type","arguments","length","undefined","statusElement","textContent","className","concat","setTimeout","showProgressSection","progressBar","progress","interval","style","display","setInterval","Math","random","width","clearInterval","hideProgressSection","handleError","error","console","errorMessage","clearResults","resultsSection","resultsContent","innerHTML","clearSuggestions","suggestionsSection","suggestionsContent","AI_PROMPTS","contractReview","systemPrompt","userPromptTemplate","riskAssessment","clauseImprovement","_regeneratorRuntime","r","t","e","Object","prototype","n","hasOwnProperty","o","Symbol","i","iterator","a","asyncIterator","u","toStringTag","c","defineProperty","value","enumerable","configurable","writable","h","Generator","create","Error","done","method","arg","delegate","d","f","sent","_sent","dispatchException","abrupt","s","Context","call","wrap","GeneratorFunction","GeneratorFunctionPrototype","l","p","getPrototypeOf","y","x","v","g","forEach","_invoke","AsyncIterator","_typeof","resolve","__await","then","return","TypeError","next","w","tryEntries","push","m","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","unshift","pop","values","prev","charAt","slice","stop","rval","complete","finish","catch","delegateYield","ownKeys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","apply","_objectSpread","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","asyncGeneratorStep","_asyncToGenerator","_next","_throw","_defineProperties","key","toPrimitive","String","_toPrimitive","APIService","config","_classCallCheck","this","_makeRequest","_callee","endpoint","options","url","requestOptions","response","_args","_context","USE_REAL_API","log","getMockResponse","baseUrl","headers","body","JSON","stringify","fetch","ok","status","statusText","json","t0","_x","includes","getMockAnalysisResponse","getMockGenerationResponse","timestamp","Date","toISOString","requestData","contract_type","compliance_score","summary","risks","severity","description","key_terms","recommendations","contract_text","metadata","template_used","agreement_type","generated_at","_analyzeContract","_callee2","documentText","contractType","userPrompt","_args2","_context2","replace","makeRequest","document_text","analysis_type","ai_prompt","system_prompt","user_prompt","requirements","article_numbering","deviation_classification","risk_quantification","track_changes","_x2","_generateContract","_callee3","formData","_context3","_x3","_checkHealth","_callee4","_context4","_toConsumableArray","Array","isArray","_arrayLikeToArray","_arrayWithoutHoles","from","_iterableToArray","toString","test","_unsupportedIterableToArray","_nonIterableSpread","generateDemoAnalysis","_generateDemoAnalysis","_callee5","wordCount","hasSignatureLines","hasParties","hasTermination","hasCompensation","complianceScore","structuredAnalysis","_context5","split","toLowerCase","substring","generateStructuredAnalysis","t1","t2","min","t3","t4","t5","terms","lowerText","t6","generateRecommendations","t7","parseContractStructureWithChanges","t8","word_count","structured_analysis","contract_structure","_x4","_x5","_generateStructuredAnalysis","_callee6","articleStructure","deviationAnalysis","improvementRecommendations","_context6","extractArticlesAndClauses","compareAgainstStandardLibrary","generateImprovementRecommendations","article_structure","deviation_analysis","improvement_recommendations","ai_prompt_used","analysis_timestamp","riskCount","hasSignatures","generateRiskAnalysis","category","title","location","suggestion","total_risks","risk_score","calculateRiskScore","score","risk","max","generateChangeSuggestions","suggestions","priority","current","suggested","benefit","total_suggestions","lines","line","trim","structure","currentArticle","currentClause","articleKeywords","clauseKeywords","index","lowerLine","some","keyword","number","content","line_number","clauses","clauseNumber","currentArticleIndex","findIndex","item","sub_clauses","standardClauses","standardLibrary","id","negotiable","getStandardClausesForType","deviations","article","clause","words","standardClause","clauseText","find","standard","keywords","findMatchingStandardClause","deviation","text2","words1","words2","intersection","union","Set","has","size","has_deviation","risk_level","business_impact","analyzeDeviation","clause_reference","clause_title","join","deviation_type","negotiable_status","current_language","standard_language","deviation_description","riskLevel","recommendation","recommendation_type","current_risk_score","calculateDeviationRiskScore","improved_language","generateImprovedLanguage","risk_mitigation","generateRiskMitigation","business_benefit","implementation_notes","generateImplementationNotes","FORM_TEMPLATES","label","required","handleAgreementTypeChange","agreementType","contentTypeGroup","dynamicForm","generateButtonGroup","handleContentTypeChange","contentType","_FORM_TEMPLATES$agree","template","formHTML","field","requiredClass","requiredAttr","option","inputType","generateDynamicForm","displayCombinedAnalysisResults","analysisResult","riskAnalysis","changeSuggestions","summaryResult","modifiedClauses","articles","reduce","count","_clause$changeStatus","changeStatus","isModified","totalClauses","html","_clause$changeStatus2","_clause$changeStatus3","statusClass","statusColor","text","trackChanges","enabled","note","demoMode","overview","severityClass","toUpperCase","priorityClass","term","rec","showSuggestionsSection","displayContractResults","result","_result$metadata","_result$metadata2","toLocaleString","displayStructuredAnalysisResults","structured","riskClass","typeClass","showStructuredSuggestionsSection","apiService","endpoints","analyze","generate","generateContract","demoVariations","content_type","fields","entity_name","content_creator","scope_description","revenue_split","term_length","territory","music_rights","advance_amount","termination_notice","platform_focus","license_fee","floor","insertContractIntoDocument","analyzeContract","_yield$Promise$all","_yield$Promise$all2","getDocumentText","all","generateExecutiveSummary","_applySuggestion","suggestionIndex","suggestionCard","applyBtn","querySelectorAll","querySelector","_applyAllChanges","card","_getDocumentText","Word","Office","context","run","_ref","load","sync","_insertContractIntoDocument","_callee8","_context8","_ref2","_callee7","contractContent","range","_context7","clear","generateContractContent","insertText","InsertLocation","start","getRange","font","_templates$formData$a","toLocaleDateString","toggleTrackChanges","highlightRisks","checkCompliance","suggestChanges","window","applySuggestion","applyAllChanges","dismissSuggestions","onReady","info","host","HostApplication","officeTheme","theme","bodyBackgroundColor","initializeTheme","generateBtn","addEventListener","analyzeBtn","agreementTypeSelect","contentTypeSelect","clearResultsBtn","clearSuggestionsBtn","toggleTrackChangesBtn","highlightRisksBtn","checkComplianceBtn","suggestChangesBtn","setupEventListeners","progressSection","event","reason"],"sourceRoot":""}