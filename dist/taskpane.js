/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";function e(e,t){var n=document.getElementById(e);t?(n.classList.add("loading"),n.disabled=!0):(n.classList.remove("loading"),n.disabled=!1)}function t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.getElementById("status-message");n.textContent=e,n.className="status-message ms-font-s ".concat(t," slide-in"),"success"===t&&(n.classList.add("success-animation"),setTimeout((function(){n.classList.remove("success-animation")}),600))}function n(e){var t,n,r;document.getElementById("progress-section").style.display="block",document.getElementById("progress-text").textContent=e,t=document.getElementById("progress-bar"),n=0,r=setInterval((function(){(n+=15*Math.random())>90&&(n=90),t.style.width=n+"%",n>=90&&clearInterval(r)}),200)}function r(){document.getElementById("progress-section").style.display="none"}function o(e){console.error("Error:",e);var n="An error occurred";e.message?n=e.message:"string"==typeof e&&(n=e),t(n,"error"),r()}function i(){var e=document.getElementById("results-section"),n=document.getElementById("results-content");e.style.display="none",n.innerHTML="",t("Results cleared","info")}function a(){var e=document.getElementById("suggestions-section"),n=document.getElementById("suggestions-content");e.style.display="none",n.innerHTML="",t("Suggestions cleared","info")}function s(){s=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,n,r){Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(t,n,r,o){var i=n&&n.prototype instanceof m?n:m,a=Object.create(i.prototype);return l(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=p(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new T(o||[])),!0),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var f={};function m(){}function h(){}function g(){}var y={};l(y,i,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(S([])));b&&b!==n&&r.call(b,i)&&(y=b);var _=g.prototype=m.prototype=Object.create(y);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(o,i,a,s){var u=p(e[o],e,i);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==c(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;l(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=p(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function k(e){this.tryEntries.push(e)}function C(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function T(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function S(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(c(t)+" is not iterable")}return h.prototype=g,l(_,"constructor",g),l(g,"constructor",h),l(g,u,h.displayName="GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},w(E.prototype),l(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(d(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(_),l(_,u,"Generator"),l(_,i,(function(){return this})),l(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=S,T.prototype={constructor:T,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),C(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;C(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:S(t),r:n,n:r},"next"===this.method&&(this.arg=e),f}},t}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)}))}}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}var g=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t},t=[{key:"makeRequest",value:(r=f(s().mark((function e(t){var n,r,o,i,a=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:{},this.config.USE_REAL_API){e.next=4;break}return console.log("[DEMO MODE] Would call API: ".concat(t),n),e.abrupt("return",this.getMockResponse(t,n));case 4:return r="".concat(this.config.baseUrl).concat(t),o=l({method:n.method||"GET",headers:l(l({},this.config.headers),n.headers)},n),n.body&&"object"===c(n.body)&&(o.body=JSON.stringify(n.body)),e.prev=7,e.next=10,fetch(r,o);case 10:if((i=e.sent).ok){e.next=13;break}throw new Error("API Error: ".concat(i.status," ").concat(i.statusText));case 13:return e.next=15,i.json();case 15:return e.abrupt("return",e.sent);case 18:throw e.prev=18,e.t0=e.catch(7),console.error("API Request failed:",e.t0),e.t0;case 22:case"end":return e.stop()}}),e,this,[[7,18]])}))),function(e){return r.apply(this,arguments)})},{key:"getMockResponse",value:function(e,t){return e.includes("/analyze")?this.getMockAnalysisResponse(t.body):e.includes("/generate")?this.getMockGenerationResponse(t.body):e.includes("/health")?{status:"healthy",timestamp:(new Date).toISOString()}:{message:"Mock response",endpoint:e,options:t}}},{key:"getMockAnalysisResponse",value:function(e){return{contract_type:"Content Management Agreement",compliance_score:85,summary:"This contract appears well-structured with standard clauses.",risks:[{severity:"medium",description:"Consider adding force majeure clause"},{severity:"low",description:"Termination notice period could be more specific"}],key_terms:["Payment Terms","Geographic Scope","Rights Management"],recommendations:["Consider legal review before execution","Ensure all parties review terms carefully"]}}},{key:"getMockGenerationResponse",value:function(e){return{contract_text:"Generated contract content would be here...",metadata:{template_used:(null==e?void 0:e.agreement_type)||"content-management",generated_at:(new Date).toISOString()}}}},{key:"analyzeContract",value:function(){var e=f(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.makeRequest("/contracts/analyze",{method:"POST",body:{document_text:t,analysis_type:"comprehensive"}}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"generateContract",value:function(){var e=f(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.makeRequest("/contracts/generate",{method:"POST",body:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkHealth",value:(n=f(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.makeRequest("/health"));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}],t&&m(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function v(){v=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof p?n:p,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new T(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function p(){}function f(){}function m(){}var h={};c(h,i,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(S([])));b&&b!==n&&r.call(b,i)&&(h=b);var _=m.prototype=p.prototype=Object.create(h);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==y(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function C(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function T(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function S(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(y(t)+" is not iterable")}return f.prototype=m,c(_,"constructor",m),c(m,"constructor",f),c(m,s,f.displayName="GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},w(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(_),c(_,s,"Generator"),c(_,i,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=S,T.prototype={constructor:T,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),C(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;C(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:S(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function b(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function _(e){return w.apply(this,arguments)}function w(){return(e=v().mark((function e(t){var n,r,o,i,a,s,c,u,l;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split(/\s+/).length,r=t.includes("_______")||t.includes("DATE:"),o=t.toLowerCase().includes("party")||t.toLowerCase().includes("agreement"),i=t.toLowerCase().includes("termination")||t.toLowerCase().includes("terminate"),a=t.toLowerCase().includes("fee")||t.toLowerCase().includes("payment")||t.toLowerCase().includes("compensation"),s="General Agreement",t.toLowerCase().includes("content management")?s="Content Management Agreement":t.toLowerCase().includes("licensing")?s="Licensing Agreement":t.toLowerCase().includes("distribution")?s="Distribution Agreement":t.toLowerCase().includes("talent")&&(s="Talent Agreement"),c=70,r&&(c+=10),o&&(c+=10),i&&(c+=5),a&&(c+=5),u=[],i||u.push("Missing termination clause - consider adding clear termination conditions"),a||u.push("Compensation terms unclear - ensure payment terms are explicitly defined"),n<100&&u.push("Contract appears incomplete - consider adding more detailed terms"),e.next=18,parseContractStructureWithChanges(t);case 18:return l=e.sent,e.abrupt("return",{contract_type:s,word_count:n,compliance_score:Math.min(c,100),summary:"This ".concat(s.toLowerCase()," contains ").concat(n," words and appears to be ").concat(c>=80?"well-structured":"missing some standard clauses",". ").concat(u.length>0?"Several areas need attention.":"The contract structure looks good."),risks:u,key_terms:(d=t,p=void 0,f=void 0,p=[],f=d.toLowerCase(),(f.includes("term")||f.includes("duration"))&&p.push("Contract Duration"),(f.includes("fee")||f.includes("payment"))&&p.push("Payment Terms"),(f.includes("territory")||f.includes("worldwide"))&&p.push("Geographic Scope"),(f.includes("intellectual property")||f.includes("rights"))&&p.push("Rights Management"),p.length>0?p:["Standard Contract Terms"]),recommendations:E(u.length,r,i),contract_structure:l});case 20:case"end":return e.stop()}var d,p,f}),e)})),w=function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){b(i,r,o,a,s,"next",e)}function s(e){b(i,r,o,a,s,"throw",e)}a(void 0)}))}).apply(this,arguments);var e}function E(e,t,n){var r=[];return e>2&&r.push("Consider legal review before execution"),t||r.push("Add proper signature blocks and date fields"),n||r.push("Include clear termination and dispute resolution clauses"),r.push("Ensure all parties review terms carefully"),r.push("Consider adding governing law and jurisdiction clauses"),r}function x(e){var t=[],n=e.toLowerCase();return n.includes("termination")||n.includes("terminate")||t.push({severity:"high",category:"Missing Clause",title:"No Termination Clause",description:"Contract lacks clear termination conditions and procedures.",location:"Document-wide",suggestion:"Add a comprehensive termination clause specifying conditions, notice periods, and post-termination obligations."}),n.includes("liability")||n.includes("damages")||t.push({severity:"critical",category:"Legal Risk",title:"No Liability Limitation",description:"Contract does not address liability limitations or damage caps.",location:"Document-wide",suggestion:"Include liability limitation clauses to protect against excessive damages."}),n.includes("dispute")||n.includes("arbitration")||n.includes("jurisdiction")||t.push({severity:"medium",category:"Dispute Resolution",title:"No Dispute Resolution Mechanism",description:"Contract lacks clear dispute resolution procedures.",location:"Document-wide",suggestion:"Add dispute resolution clause specifying arbitration, mediation, or court jurisdiction."}),n.includes("confidential")||n.includes("proprietary")||t.push({severity:"medium",category:"IP Protection",title:"No Confidentiality Provisions",description:"Contract may not adequately protect confidential information.",location:"Document-wide",suggestion:"Include confidentiality and non-disclosure provisions."}),n.includes("force majeure")||n.includes("act of god")||t.push({severity:"low",category:"Risk Management",title:"No Force Majeure Clause",description:"Contract lacks protection against unforeseeable circumstances.",location:"Document-wide",suggestion:"Consider adding force majeure clause for protection against extraordinary events."}),{total_risks:t.length,risk_score:k(t),risks:t,summary:"Found ".concat(t.length," potential risk areas. ").concat(t.filter((function(e){return"critical"===e.severity})).length," critical, ").concat(t.filter((function(e){return"high"===e.severity})).length," high, ").concat(t.filter((function(e){return"medium"===e.severity})).length," medium, ").concat(t.filter((function(e){return"low"===e.severity})).length," low priority issues.")}}function k(e){var t=100;return e.forEach((function(e){switch(e.severity){case"critical":t-=25;break;case"high":t-=15;break;case"medium":t-=10;break;case"low":t-=5}})),Math.max(t,0)}function C(e){var t=[],n=e.toLowerCase();return n.includes("shall")&&!n.includes("may")&&t.push({type:"Language Improvement",priority:"medium",title:"Balance Mandatory vs Optional Language",current:'Contract uses only mandatory "shall" language',suggested:'Consider using "may" for optional provisions to provide flexibility',benefit:"Provides better balance between obligations and flexibility"}),n.includes("including but not limited to")||n.includes("such as")||t.push({type:"Clarity Enhancement",priority:"low",title:"Add Inclusive Language",current:"Lists may appear exhaustive",suggested:'Add "including but not limited to" before lists to indicate they are not exhaustive',benefit:"Prevents interpretation that lists are complete and exclusive"}),n.includes("reasonable")&&!n.includes("commercially reasonable")&&t.push({type:"Legal Precision",priority:"medium",title:'Clarify "Reasonable" Standards',current:'Uses vague "reasonable" standard',suggested:'Replace with "commercially reasonable" or define specific criteria',benefit:"Reduces ambiguity and potential disputes over reasonableness"}),n.includes("time is of the essence")||t.push({type:"Performance Standards",priority:"low",title:"Add Time Performance Clause",current:"No explicit time performance requirements",suggested:'Add "time is of the essence" clause for critical deadlines',benefit:"Emphasizes importance of meeting deadlines and strengthens enforcement"}),t.push({type:"Modern Practice",priority:"low",title:"Electronic Signature Provision",current:"Traditional signature requirements",suggested:"Add electronic signature acceptance clause",benefit:"Enables faster execution and modern business practices"}),{total_suggestions:t.length,suggestions:t,summary:"Generated ".concat(t.length," improvement suggestions to enhance contract clarity, enforceability, and modern business practices.")}}var T={"content-management":{music:[{name:"entity_name",label:"Entity Name",type:"text",required:!0,description:"Name of the contracting entity"},{name:"content_creator",label:"Content Creator",type:"text",required:!0,description:"Name of the content creator/artist"},{name:"scope_description",label:"Scope of Work",type:"textarea",required:!0,description:"Detailed description of content management services"},{name:"revenue_split",label:"Revenue Split (%)",type:"number",required:!0,description:"Percentage split for revenue sharing"},{name:"term_length",label:"Contract Term",type:"select",required:!0,options:["1 year","2 years","3 years","5 years"],description:"Duration of the agreement"},{name:"territory",label:"Territory",type:"select",required:!0,options:["Worldwide","North America","United States","Canada","Other"],description:"Geographic scope of the agreement"},{name:"music_rights",label:"Music Rights",type:"select",required:!0,options:["Master Rights","Publishing Rights","Both","Synchronization Only"],description:"Type of music rights being managed"},{name:"advance_amount",label:"Advance Amount ($)",type:"number",required:!1,description:"Initial advance payment (if applicable)"},{name:"termination_notice",label:"Termination Notice (days)",type:"number",required:!0,description:"Notice period required for termination"}],"non-music":[{name:"entity_name",label:"Entity Name",type:"text",required:!0,description:"Name of the contracting entity"},{name:"content_creator",label:"Content Creator",type:"text",required:!0,description:"Name of the content creator"},{name:"scope_description",label:"Scope of Work",type:"textarea",required:!0,description:"Detailed description of content management services"},{name:"revenue_split",label:"Revenue Split (%)",type:"number",required:!0,description:"Percentage split for revenue sharing"},{name:"term_length",label:"Contract Term",type:"select",required:!0,options:["1 year","2 years","3 years","5 years"],description:"Duration of the agreement"},{name:"territory",label:"Territory",type:"select",required:!0,options:["Worldwide","North America","United States","Canada","Other"],description:"Geographic scope of the agreement"},{name:"content_type",label:"Content Type",type:"select",required:!0,options:["Video Content","Podcast","Written Content","Social Media","Mixed Media"],description:"Type of content being managed"},{name:"platform_focus",label:"Platform Focus",type:"select",required:!0,options:["YouTube","TikTok","Instagram","Multi-Platform","Other"],description:"Primary platform for content distribution"},{name:"termination_notice",label:"Termination Notice (days)",type:"number",required:!0,description:"Notice period required for termination"}],both:[{name:"entity_name",label:"Entity Name",type:"text",required:!0,description:"Name of the contracting entity"},{name:"content_creator",label:"Content Creator",type:"text",required:!0,description:"Name of the content creator/artist"},{name:"scope_description",label:"Scope of Work",type:"textarea",required:!0,description:"Detailed description of content management services"},{name:"revenue_split_music",label:"Music Revenue Split (%)",type:"number",required:!0,description:"Percentage split for music revenue"},{name:"revenue_split_content",label:"Content Revenue Split (%)",type:"number",required:!0,description:"Percentage split for non-music content revenue"},{name:"term_length",label:"Contract Term",type:"select",required:!0,options:["1 year","2 years","3 years","5 years"],description:"Duration of the agreement"},{name:"territory",label:"Territory",type:"select",required:!0,options:["Worldwide","North America","United States","Canada","Other"],description:"Geographic scope of the agreement"},{name:"music_rights",label:"Music Rights",type:"select",required:!0,options:["Master Rights","Publishing Rights","Both","Synchronization Only"],description:"Type of music rights being managed"},{name:"content_platforms",label:"Content Platforms",type:"select",required:!0,options:["YouTube","TikTok","Instagram","Multi-Platform","Other"],description:"Primary platforms for content distribution"},{name:"termination_notice",label:"Termination Notice (days)",type:"number",required:!0,description:"Notice period required for termination"}]}};function S(){var e=document.getElementById("agreement-type").value,t=document.getElementById("content-type-group"),n=document.getElementById("dynamic-form"),r=document.getElementById("generate-button-group");e?(t.style.display="block",document.getElementById("content-type").value="",n.style.display="none",r.style.display="none"):(t.style.display="none",n.style.display="none",r.style.display="none")}function A(){var e=document.getElementById("agreement-type").value,t=document.getElementById("content-type").value,n=document.getElementById("dynamic-form"),r=document.getElementById("generate-button-group");e&&t?(function(e,t){var n,r=document.getElementById("dynamic-form"),o=null===(n=T[e])||void 0===n?void 0:n[t];if(o){var i='<h3 class="ms-font-l">Contract Details</h3>';o.forEach((function(e){var t=e.required?"required-field":"",n=e.required?"required":"";if(i+='<div class="form-field '.concat(t,'">'),i+='<label for="'.concat(e.name,'">').concat(e.label,":</label>"),"textarea"===e.type)i+='<textarea id="'.concat(e.name,'" name="').concat(e.name,'" ').concat(n,' placeholder="Enter ').concat(e.label.toLowerCase(),'"></textarea>');else if("select"===e.type)i+='<select id="'.concat(e.name,'" name="').concat(e.name,'" ').concat(n,">"),i+='<option value="">Select '.concat(e.label,"</option>"),e.options.forEach((function(e){i+='<option value="'.concat(e,'">').concat(e,"</option>")})),i+="</select>";else{var r="number"===e.type?"number":"text";i+='<input type="'.concat(r,'" id="').concat(e.name,'" name="').concat(e.name,'" ').concat(n,' placeholder="Enter ').concat(e.label.toLowerCase(),'">')}e.description&&(i+='<div class="field-description">'.concat(e.description,"</div>")),i+="</div>"})),r.innerHTML=i}else r.innerHTML='<p class="ms-font-s">Form template not available for this combination.</p>'}(e,t),n.style.display="block",r.style.display="block"):(n.style.display="none",r.style.display="none")}function I(e,t,n,r){var o=document.getElementById("results-content"),i=document.getElementById("results-section"),a=e.contract_structure,s=a.articles.reduce((function(e,t){return e+t.clauses.filter((function(e){var t;return null===(t=e.changeStatus)||void 0===t?void 0:t.isModified})).length}),0),c=a.articles.reduce((function(e,t){return e+t.clauses.length}),0),u='\n    <div class="analysis-results">\n      \x3c!-- 1. CONTRACT STRUCTURE BREAKDOWN (FIRST) --\x3e\n      <div class="analysis-section contract-structure">\n        <h3>📋 Contract Structure</h3>\n        <div class="structure-overview">\n          <p><strong>Total Articles:</strong> '.concat(a.articles.length,"</p>\n          <p><strong>Total Clauses:</strong> ").concat(c,'</p>\n        </div>\n        \n        <div class="articles-breakdown">');a.articles.forEach((function(e){u+='\n          <div class="article-item">\n            <h4 class="article-title">'.concat(e.number,". ").concat(e.title,'</h4>\n            <div class="clauses-list">'),e.clauses.forEach((function(e){var t,n,r=null!==(t=e.changeStatus)&&void 0!==t&&t.isModified?"modified":"unmodified",o=null!==(n=e.changeStatus)&&void 0!==n&&n.isModified?"red":"green";u+='\n              <div class="clause-item '.concat(r,'">\n                <span class="clause-number" style="color: ').concat(o,';">').concat(e.number,'</span>\n                <span class="clause-text">').concat(e.text.substring(0,100)).concat(e.text.length>100?"...":"","</span>\n              </div>")})),u+="\n            </div>\n          </div>"})),u+='\n        </div>\n      </div>\n\n      \x3c!-- 2. TRACK CHANGES SUMMARY (AFTER STRUCTURE) --\x3e\n      <div class="analysis-section track-changes-summary">\n        <h3>🔄 Track Changes Summary</h3>\n        '.concat(a.trackChanges?'\n          <div class="change-tracking-info">\n            <p><strong>Track Changes:</strong> '.concat(a.trackChanges.enabled?"Enabled":"Disabled","</p>\n            ").concat(a.trackChanges.enabled?'\n              <p><strong>Modified Clauses:</strong> <span class="modified-count">'.concat(s,"</span> / ").concat(c,'</p>\n              <p><strong>Unmodified Clauses:</strong> <span class="unmodified-count">').concat(c-s,"</span> / ").concat(c,"</p>\n            "):"","\n            ").concat(a.trackChanges.note?'<p class="track-changes-note"><em>'.concat(a.trackChanges.note,"</em></p>"):"","\n            ").concat(a.trackChanges.demoMode?'<p class="demo-note"><em>Demo mode - simulated changes for testing</em></p>':"","\n          </div>\n          ").concat(a.trackChanges.enabled?'\n            <div class="change-legend">\n              <div class="legend-item">\n                <span class="legend-indicator modified"></span>\n                <span>Modified Clause</span>\n              </div>\n              <div class="legend-item">\n                <span class="legend-indicator unmodified"></span>\n                <span>Unmodified Clause</span>\n              </div>\n            </div>\n          ':"","\n        "):"",'\n      </div>\n\n      \x3c!-- 3. EXECUTIVE SUMMARY SECTION --\x3e\n      <div class="analysis-summary">\n        <h3>').concat(r.title,'</h3>\n        <div class="summary-overview">\n          <p>').concat(r.overview,'</p>\n        </div>\n        \n        <div class="summary-metrics">\n          <div class="metric-item">\n            <span class="metric-label">Contract Type:</span>\n            <span class="metric-value">').concat(e.contract_type,'</span>\n          </div>\n          <div class="metric-item">\n            <span class="metric-label">Word Count:</span>\n            <span class="metric-value">').concat(e.word_count,'</span>\n          </div>\n          <div class="metric-item">\n            <span class="metric-label">Compliance Score:</span>\n            <span class="metric-value compliance-score">').concat(e.compliance_score,'%</span>\n          </div>\n          <div class="metric-item">\n            <span class="metric-label">Risk Score:</span>\n            <span class="metric-value risk-score">').concat(t.risk_score,'%</span>\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- 4. DETAILED ANALYSIS SECTIONS --\x3e\n      <div class="detailed-analysis">\n        \n        \x3c!-- Risk Analysis --\x3e\n        <div class="analysis-section risks">\n          <h3>⚠️ Risk Analysis</h3>\n          <p class="section-summary">').concat(t.summary,'</p>\n          \n          <div class="risks-list">'),t.risks.forEach((function(e){var t="severity-".concat(e.severity);u+='\n            <div class="risk-item '.concat(t,'">\n              <div class="risk-header">\n                <span class="risk-severity">').concat(e.severity.toUpperCase(),'</span>\n                <span class="risk-title">').concat(e.title,'</span>\n              </div>\n              <p class="risk-description">').concat(e.description,'</p>\n              <p class="risk-suggestion"><strong>Suggestion:</strong> ').concat(e.suggestion,"</p>\n            </div>")})),u+='\n          </div>\n        </div>\n\n        \x3c!-- Change Suggestions --\x3e\n        <div class="analysis-section suggestions">\n          <h3>💡 Improvement Suggestions</h3>\n          <p class="section-summary">'.concat(n.summary,'</p>\n          \n          <div class="suggestions-list">'),n.suggestions.forEach((function(e){var t="priority-".concat(e.priority);u+='\n            <div class="suggestion-item '.concat(t,'">\n              <div class="suggestion-header">\n                <span class="suggestion-priority">').concat(e.priority.toUpperCase(),'</span>\n                <span class="suggestion-title">').concat(e.title,'</span>\n              </div>\n              <div class="suggestion-details">\n                <p><strong>Current:</strong> ').concat(e.current,"</p>\n                <p><strong>Suggested:</strong> ").concat(e.suggested,"</p>\n                <p><strong>Benefit:</strong> ").concat(e.benefit,"</p>\n              </div>\n            </div>")})),u+='\n          </div>\n        </div>\n\n        \x3c!-- Key Terms --\x3e\n        <div class="analysis-section key-terms">\n          <h3>🔑 Key Terms Identified</h3>\n          <div class="terms-list">',e.key_terms.forEach((function(e){u+='<span class="term-tag">'.concat(e,"</span>")})),u+='\n          </div>\n        </div>\n\n        \x3c!-- Recommendations --\x3e\n        <div class="analysis-section recommendations">\n          <h3>📝 Recommendations</h3>\n          <ul class="recommendations-list">',e.recommendations.forEach((function(e){u+="<li>".concat(e,"</li>")})),u+="\n          </ul>\n        </div>\n      </div>\n    </div>",o.innerHTML=u,i.style.display="block",function(e){var t=document.getElementById("suggestions-section"),n=document.getElementById("suggestions-content"),r='\n    <div class="suggestions-header">\n      <h3>💡 Contract Improvement Suggestions</h3>\n      <p>Review and apply the following suggestions to improve your contract:</p>\n    </div>\n    \n    <div class="suggestions-list">';e.suggestions.forEach((function(e,t){var n="priority-".concat(e.priority);r+='\n      <div class="suggestion-card '.concat(n,'">\n        <div class="suggestion-header">\n          <span class="priority-badge ').concat(e.priority,'">').concat(e.priority.toUpperCase(),"</span>\n          <h4>").concat(e.title,'</h4>\n        </div>\n        <div class="suggestion-content">\n          <div class="current-state">\n            <strong>Current:</strong> ').concat(e.current,'\n          </div>\n          <div class="suggested-change">\n            <strong>Suggested:</strong> ').concat(e.suggested,'\n          </div>\n          <div class="benefit">\n            <strong>Benefit:</strong> ').concat(e.benefit,'\n          </div>\n        </div>\n        <div class="suggestion-actions">\n          <button class="apply-suggestion-btn" onclick="applySuggestion(').concat(t,')">\n            Apply This Change\n          </button>\n        </div>\n      </div>')})),r+='\n    </div>\n    \n    <div class="suggestions-actions">\n      <button id="apply-all-changes-btn" class="primary-button" onclick="applyAllChanges()">\n        Apply All Changes\n      </button>\n      <button id="dismiss-suggestions-btn" class="secondary-button" onclick="dismissSuggestions()">\n        Dismiss Suggestions\n      </button>\n    </div>',n.innerHTML=r,t.style.display="block"}(n)}function O(e){var t,n,r=document.getElementById("results-content"),o=document.getElementById("results-section"),i='\n    <div class="contract-results">\n      <h3>✅ Contract Generated Successfully</h3>\n      <div class="contract-info">\n        <p><strong>Contract Type:</strong> '.concat((null===(t=e.metadata)||void 0===t?void 0:t.template_used)||"Content Management Agreement","</p>\n        <p><strong>Generated:</strong> ").concat(new Date((null===(n=e.metadata)||void 0===n?void 0:n.generated_at)||new Date).toLocaleString(),'</p>\n        <p><strong>Status:</strong> <span class="status-success">Ready for Review</span></p>\n      </div>\n      \n      <div class="contract-actions">\n        <button id="review-contract-btn" class="primary-button" onclick="reviewGeneratedContract()">\n          📋 Review Contract\n        </button>\n        <button id="analyze-new-contract-btn" class="secondary-button" onclick="analyzeContract()">\n          🔍 Analyze Generated Contract\n        </button>\n      </div>\n      \n      <div class="next-steps">\n        <h4>Next Steps:</h4>\n        <ul>\n          <li>Review the generated contract content</li>\n          <li>Run contract analysis to check for risks</li>\n          <li>Make any necessary modifications</li>\n          <li>Save and share with relevant parties</li>\n        </ul>\n      </div>\n    </div>');r.innerHTML=i,o.style.display="block"}function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function N(){N=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof p?n:p,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=w(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new k(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function p(){}function f(){}function m(){}var h={};c(h,i,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(C([])));y&&y!==n&&r.call(y,i)&&(h=y);var v=m.prototype=p.prototype=Object.create(h);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==M(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function w(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,w(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function E(e){this.tryEntries.push(e)}function x(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function k(e){this.tryEntries=[[-1]],e.forEach(E,this),this.reset(!0)}function C(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(M(t)+" is not iterable")}return f.prototype=m,c(v,"constructor",m),c(m,"constructor",f),c(m,s,f.displayName="GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},b(_.prototype),c(_.prototype,a,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new _(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),c(v,s,"Generator"),c(v,i,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(x),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),x(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;x(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:C(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function R(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function L(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){R(i,r,o,a,s,"next",e)}function s(e){R(i,r,o,a,s,"throw",e)}a(void 0)}))}}var j=new g({USE_REAL_API:!1,baseUrl:"https://api.starling-ai.com/v1",demoMode:!0,endpoints:{analyze:"/analyze-contract",generate:"/generate-contract",suggestions:"/suggest-changes"},headers:{"Content-Type":"application/json",Accept:"application/json"}});function G(){return B.apply(this,arguments)}function B(){return(B=L(N().mark((function i(){var a,s;return N().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:e("generate-contract-btn",!0),n("Generating contract..."),t("Preparing contract generation...","info"),i.prev=3,void 0,a=(c=[{agreement_type:"content-management",content_type:"music",fields:{entity_name:"Starling Music Management LLC",content_creator:"Alex Rivera",scope_description:"Comprehensive music content management including digital distribution across all major platforms, rights management, marketing campaigns, and revenue collection services.",revenue_split:"20",term_length:"3 years",territory:"Worldwide",music_rights:"Master Rights",advance_amount:"15000",termination_notice:"60"}},{agreement_type:"content-management",content_type:"non-music",fields:{entity_name:"Digital Content Partners",content_creator:"Jordan Smith",scope_description:"Full-service content management for video content including YouTube optimization, brand partnerships, content strategy, and monetization.",revenue_split:"25",term_length:"2 years",territory:"North America",content_type:"Video Content",platform_focus:"YouTube",termination_notice:"30"}},{agreement_type:"licensing",content_type:"music",fields:{entity_name:"Harmony Licensing Group",content_creator:"Taylor Music Productions",scope_description:"Licensing agreement for synchronization rights in film, television, and digital media.",license_fee:"5000",term_length:"5 years",territory:"Worldwide",music_rights:"Synchronization Rights",termination_notice:"90"}}])[Math.floor(Math.random()*c.length)],i.next=7;break;case 7:return t("Generating contract content...","info"),i.next=10,j.generateContract(a);case 10:return s=i.sent,i.next=13,H(s,a);case 13:O(s),t("Contract generated successfully!","success"),r(),i.next=21;break;case 18:i.prev=18,i.t0=i.catch(3),o(i.t0);case 21:return i.prev=21,e("generate-contract-btn",!1),i.finish(21);case 24:case"end":return i.stop()}var c}),i,null,[[3,18,21,24]])})))).apply(this,arguments)}function D(){return q.apply(this,arguments)}function q(){return(q=L(N().mark((function i(){var a,s,c,u,l,d,p;return N().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return e("analyze-contract-btn",!0),n("Analyzing contract..."),t("Reading document content...","info"),i.prev=3,i.next=6,U();case 6:if((a=i.sent)&&!(a.trim().length<50)){i.next=9;break}throw new Error("Document appears to be empty or too short to analyze. Please ensure you have contract content in the document.");case 9:return t("Performing contract analysis...","info"),i.next=12,Promise.all([_(a),x(a),C(a)]);case 12:s=i.sent,m=3,c=function(e){if(Array.isArray(e))return e}(f=s)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(f,m)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(f,m)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),u=c[0],l=c[1],d=c[2],p=K(u,l,d),t("Analysis complete!","success"),I(u,l,d,p),r(),i.next=26;break;case 23:i.prev=23,i.t0=i.catch(3),o(i.t0);case 26:return i.prev=26,e("analyze-contract-btn",!1),i.finish(26);case 29:case"end":return i.stop()}var f,m}),i,null,[[3,23,26,29]])})))).apply(this,arguments)}function W(){return(W=L(N().mark((function e(n){var r,i;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t("Applying suggestion ".concat(n+1,"..."),"info"),e.prev=1,e.next=4,new Promise((function(e){return setTimeout(e,1e3)}));case 4:t("Suggestion ".concat(n+1," applied successfully!"),"success"),(r=document.querySelectorAll(".suggestion-card")[n])&&(r.classList.add("applied"),(i=r.querySelector(".apply-suggestion-btn"))&&(i.textContent="✓ Applied",i.disabled=!0)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),o(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function z(){return(z=L(N().mark((function n(){return N().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e("apply-all-changes-btn",!0),t("Applying all suggestions...","info"),n.prev=2,n.next=5,new Promise((function(e){return setTimeout(e,2e3)}));case 5:t("All suggestions applied successfully!","success"),document.querySelectorAll(".suggestion-card").forEach((function(e){e.classList.add("applied");var t=e.querySelector(".apply-suggestion-btn");t&&(t.textContent="✓ Applied",t.disabled=!0)})),document.getElementById("apply-all-changes-btn").style.display="none",n.next=14;break;case 11:n.prev=11,n.t0=n.catch(2),o(n.t0);case 14:return n.prev=14,e("apply-all-changes-btn",!1),n.finish(14);case 17:case"end":return n.stop()}}),n,null,[[2,11,14,17]])})))).apply(this,arguments)}function U(){return F.apply(this,arguments)}function F(){return F=L(N().mark((function e(){return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!=typeof Word){e.next=2;break}throw new Error("Word API not available. Please ensure you are running this add-in in Microsoft Word.");case 2:if(Office.context&&Office.context.document){e.next=4;break}throw new Error("Office.js not properly initialized. Please refresh the add-in.");case 4:return e.next=6,Word.run(function(){var e=L(N().mark((function e(t){var n;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.body).load("text"),e.next=4,t.sync();case 4:return e.abrupt("return",n.text);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)}))),F.apply(this,arguments)}function H(e,t){return Y.apply(this,arguments)}function Y(){return Y=L(N().mark((function e(t,n){return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!=typeof Word){e.next=2;break}throw new Error("Word API not available. Please ensure you are running this add-in in Microsoft Word.");case 2:if(Office.context&&Office.context.document){e.next=4;break}throw new Error("Office.js not properly initialized. Please refresh the add-in.");case 4:return e.next=6,Word.run(function(){var e=L(N().mark((function e(t){var r,o,i;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.document.body).clear(),o=V(n),r.insertText(o,Word.InsertLocation.start),(i=r.getRange()).font.name="Calibri",i.font.size=11,e.next=9,t.sync();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)}))),Y.apply(this,arguments)}function V(e){var t;return(null===(t={"content-management":{music:'MUSIC CONTENT MANAGEMENT AGREEMENT\n\nThis Music Content Management Agreement ("Agreement") is entered into on '.concat((new Date).toLocaleDateString()," between ").concat(e.fields.entity_name||"Starling Music Management LLC",', a limited liability company ("Manager"), and ').concat(e.fields.content_creator||"Artist Name",' ("Artist").\n\n1. SCOPE OF SERVICES\nManager agrees to provide comprehensive music content management services including:\n- Digital distribution across all major streaming platforms (Spotify, Apple Music, Amazon Music, etc.)\n- Rights management and royalty collection\n- Marketing and promotional campaigns\n- Performance tracking and analytics\n- Playlist pitching and promotion\n\n2. REVENUE SHARING\nArtist and Manager agree to the following revenue split:\n- Artist: ').concat(100-(e.fields.revenue_split||20),"%\n- Manager: ").concat(e.fields.revenue_split||20,"%\n\n3. TERM AND TERRITORY\nThis Agreement shall remain in effect for ").concat(e.fields.term_length||"3 years"," and covers ").concat(e.fields.territory||"Worldwide",".\n\n4. RIGHTS GRANTED\nArtist grants Manager the right to manage ").concat(e.fields.music_rights||"Master Rights"," for the specified territory and term.\n\n5. ADVANCE\n").concat(e.fields.advance_amount?"Manager will provide an advance of $".concat(e.fields.advance_amount," upon execution of this Agreement."):"No advance payment is included in this Agreement.","\n\n6. TERMINATION\nEither party may terminate this Agreement with ").concat(e.fields.termination_notice||"60"," days written notice.\n\n7. GOVERNING LAW\nThis Agreement shall be governed by the laws of the State of California.\n\nIN WITNESS WHEREOF, the parties have executed this Agreement as of the date first written above.\n\nMANAGER:                           ARTIST:\n\n_________________________         _________________________\n").concat(e.fields.entity_name||"Starling Music Management LLC","    ").concat(e.fields.content_creator||"Artist Name","\n\nDate: _______________             Date: _______________"),"non-music":'CONTENT MANAGEMENT AGREEMENT\n\nThis Content Management Agreement ("Agreement") is entered into on '.concat((new Date).toLocaleDateString()," between ").concat(e.fields.entity_name||"Digital Content Partners",' ("Manager") and ').concat(e.fields.content_creator||"Content Creator",' ("Creator").\n\n1. CONTENT MANAGEMENT SERVICES\nManager will provide comprehensive content management including:\n- ').concat(e.fields.content_type||"Video Content"," optimization and strategy\n- Platform management for ").concat(e.fields.platform_focus||"YouTube","\n- Brand partnership facilitation\n- Revenue optimization and analytics\n- Content scheduling and distribution\n\n2. COMPENSATION\nRevenue sharing arrangement:\n- Creator: ").concat(100-(e.fields.revenue_split||25),"%\n- Manager: ").concat(e.fields.revenue_split||25,"%\n\n3. TERM AND SCOPE\nDuration: ").concat(e.fields.term_length||"2 years","\nTerritory: ").concat(e.fields.territory||"North America","\n\n4. CONTENT RIGHTS\nCreator grants Manager limited rights to manage and distribute content on agreed platforms.\n\n5. TERMINATION\nEither party may terminate with ").concat(e.fields.termination_notice||"30"," days written notice.\n\n6. GOVERNING LAW\nThis Agreement is governed by applicable state and federal laws.\n\nSIGNATURES:\n\nMANAGER:                           CREATOR:\n\n_________________________         _________________________\n").concat(e.fields.entity_name||"Digital Content Partners","      ").concat(e.fields.content_creator||"Content Creator","\n\nDate: _______________             Date: _______________")}}[e.agreement_type])||void 0===t?void 0:t[e.content_type])||"Contract content would be generated here based on your selections."}function K(e,t,n){var r=t.risk_score>=80?"Low":t.risk_score>=60?"Medium":"High";return{title:"📊 Executive Summary",overview:"This ".concat(e.contract_type.toLowerCase()," has been analyzed for compliance, risks, and improvement opportunities. The contract shows a ").concat(r.toLowerCase()," risk profile with ").concat(t.risks.length," identified areas for attention and ").concat(n.suggestions.length," improvement suggestions.")}}function $(){t("Toggling track changes...","info")}function J(){t("Highlighting risks...","info")}function X(){t("Checking compliance...","info")}function Q(){t("Applying suggested changes...","info")}window.generateContract=G,window.analyzeContract=D,window.applySuggestion=function(e){return W.apply(this,arguments)},window.applyAllChanges=function(){return z.apply(this,arguments)},window.dismissSuggestions=function(){a(),t("Suggestions dismissed","info")},window.clearResults=i,window.clearSuggestions=a,window.handleAgreementTypeChange=S,window.handleContentTypeChange=A,Office.onReady((function(e){if(e.host===Office.HostApplication.Word){if(console.log("RHEI AI Legal Assistant loaded successfully"),"undefined"==typeof Word)return console.error("Word API not available"),void t("Error: Word API not available. Please refresh the add-in.","error");console.log("Word API is available"),function(){if(Office.context&&Office.context.officeTheme){var e=Office.context.officeTheme;document.body.className="office-theme-".concat(e.bodyBackgroundColor)}}(),function(){var e=document.getElementById("generate-contract");e&&e.addEventListener("click",G);var t=document.getElementById("analyze-contract");t&&t.addEventListener("click",D);var n=document.getElementById("agreement-type");n&&n.addEventListener("change",S);var r=document.getElementById("content-type");r&&r.addEventListener("change",A);var o=document.getElementById("clear-results");o&&o.addEventListener("click",i);var s=document.getElementById("clear-suggestions");s&&s.addEventListener("click",a);var c=document.getElementById("toggle-track-changes");c&&c.addEventListener("click",$);var u=document.getElementById("highlight-risks");u&&u.addEventListener("click",J);var l=document.getElementById("check-compliance");l&&l.addEventListener("click",X);var d=document.getElementById("suggest-changes");d&&d.addEventListener("click",Q),console.log("Event listeners set up successfully")}(),n=document.getElementById("dynamic-form"),r=document.getElementById("generate-button-group"),o=document.getElementById("content-type-group"),s=document.getElementById("results-section"),c=document.getElementById("suggestions-section"),u=document.getElementById("progress-section"),n&&(n.style.display="none"),r&&(r.style.display="none"),o&&(o.style.display="none"),s&&(s.style.display="none"),c&&(c.style.display="none"),u&&(u.style.display="none"),t("Ready to generate or analyze contracts","info"),console.log("UI initialized successfully"),console.log("Add-in initialization complete")}else console.error("This add-in is designed for Microsoft Word only"),t("Error: This add-in requires Microsoft Word","error");var n,r,o,s,c,u})),window.addEventListener("error",(function(e){console.error("Global error:",e.error),o(e.error)})),window.addEventListener("unhandledrejection",(function(e){console.error("Unhandled promise rejection:",e.reason),o(e.reason)})),console.log("RHEI AI Legal Assistant module loaded")}();
//# sourceMappingURL=taskpane.js.map