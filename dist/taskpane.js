/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e,t,n={},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var a=r[e]={exports:{}};return n[e](a,a.exports,o),a.exports}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(){"use strict";c=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n,r){Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function d(t,n,r,o){var a=n&&n.prototype instanceof g?n:g,i=Object.create(a.prototype);return u(i,"_invoke",function(t,n,r){var o=1;return function(a,i){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=A(c,r);if(s){if(s===p)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?4:2,l.arg===p)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=4,r.method="throw",r.arg=l.arg)}}}(t,r,new P(o||[])),!0),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p={};function g(){}function m(){}function h(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(S([])));b&&b!==n&&r.call(b,i)&&(v=b);var w=h.prototype=g.prototype=Object.create(v);function E(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function n(o,i,c,s){var l=f(e[o],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==a(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,c,s)}),(function(e){n("throw",e,c,s)})):t.resolve(d).then((function(e){u.value=e,c(u)}),(function(e){return n("throw",e,c,s)}))}s(l.arg)}var o;u(this,"_invoke",(function(e,r){function a(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(a,a):a()}),!0)}function A(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var a=f(o,t.i,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,p;var i=a.arg;return i?i.done?(n[t.r]=i.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function x(e){this.tryEntries.push(e)}function k(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function P(e){this.tryEntries=[[-1]],e.forEach(x,this),this.reset(!0)}function S(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,c=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return c.next=c}}throw new TypeError(a(t)+" is not iterable")}return m.prototype=h,u(w,"constructor",h),u(h,"constructor",m),u(h,l,m.displayName="GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,u(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},E(I.prototype),u(I.prototype,s,(function(){return this})),t.AsyncIterator=I,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new I(d(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(w),u(w,l,"Generator"),u(w,i,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=S,P.prototype={constructor:P,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){i.type="throw",i.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a[4],c=this.prev,s=a[1],l=a[2];if(-1===a[0])return r("end"),!1;if(!s&&!l)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=c){if(c<s)return this.method="next",this.arg=e,r(s),!0;if(c<l)return r(l),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var a=o?o[4]:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o[2],p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),k(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:S(t),r:n,n:r},"next"===this.method&&(this.arg=e),p}},t}function s(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){s(a,r,o,i,c,"next",e)}function c(e){s(a,r,o,i,c,"throw",e)}i(void 0)}))}}function u(){return d.apply(this,arguments)}function d(){return(d=l(c().mark((function e(){var t,n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Starting safe initialization..."),e.prev=1,e.next=4,o.e(199).then(o.bind(o,79199));case 4:t=e.sent,n=t.initializeTheme,r=t.updateStatus,n(),O(),T(),"undefined"!=typeof Office?(console.log("Office.js is available, waiting for Office.onReady..."),Office.onReady((function(e){console.log("Office.onReady called with info:",e),window.OFFICE_READY=!0,e.host===Office.HostApplication.Word?(console.log("RHEI AI Legal Assistant loaded successfully in Word"),f()):(console.error("This add-in is designed for Microsoft Word only. Current host:",e.host),r("Error: This add-in requires Microsoft Word","error"))}))):(console.error("Office.js is not available"),r("Error: Office.js not loaded. Please refresh the page.","error"),k()),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.error("Error during initialization:",e.t0),I();case 17:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function f(){console.log("Starting enhanced Word API availability check...");var e=0,t=setTimeout((function(){console.log("Auto-fallback triggered - Word API test taking too long"),clearInterval(n),w()}),8e3),n=setInterval((function(){e++,console.log("Word API check attempt ".concat(e,"/").concat(6));try{if("undefined"!=typeof Word&&"function"==typeof Word.run)return console.log("Word API is available!"),clearInterval(n),clearTimeout(t),window.WORD_API_AVAILABLE=!0,window.WORD_API_READY=!0,void function(){p.apply(this,arguments)}();if(e>=6)return console.log("Word API not available after maximum attempts"),clearInterval(n),clearTimeout(t),void w()}catch(r){console.error("Error checking Word API (attempt ".concat(e,"):"),r),e>=6&&(clearInterval(n),clearTimeout(t),w())}}),500)}function p(){return(p=l(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Testing Word API with automatic fallback..."),t=setTimeout((function(){g()}),4e3),n=setTimeout((function(){console.log("Word API test hanging - auto-falling back to demo mode"),m(),w()}),1e4),e.prev=3,e.next=6,y();case 6:clearTimeout(n),clearTimeout(t),m(),e.next=18;break;case 11:e.prev=11,e.t0=e.catch(3),clearTimeout(n),clearTimeout(t),m(),console.error("Word API test failed, falling back:",e.t0),w();case 18:case"end":return e.stop()}}),e,null,[[3,11]])})))).apply(this,arguments)}function g(){console.log("Showing skip test button...");var e=document.getElementById("skip-test-section");e&&(e.style.display="block")}function m(){var e=document.getElementById("skip-test-section");e&&(e.style.display="none")}function h(){return v.apply(this,arguments)}function v(){return(v=l(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("User chose to skip Word API test"),e.prev=1,e.next=4,o.e(199).then(o.bind(o,79199));case 4:(0,e.sent.updateStatus)("Skipping Word API test - continuing in demo mode","warning"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Error importing updateStatus:",e.t0);case 12:m(),w();case 14:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function y(){return b.apply(this,arguments)}function b(){return b=l(c().mark((function e(){var t,n,r,a,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Testing Word API functionality with ultra-minimal test..."),e.prev=1,e.next=4,o.e(199).then(o.bind(o,79199));case 4:return t=e.sent,(n=t.updateStatus)("Testing Word API connection...","info"),r=new Promise((function(e,t){try{Word.run(function(){var t=l(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Word.run context created successfully"),e(!0);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch(t)}catch(e){t(e)}})),a=new Promise((function(e,t){setTimeout((function(){return t(new Error("Word API test timeout"))}),3e3)})),e.next=11,Promise.race([r,a]);case 11:console.log("Word API test completed successfully!"),n("Word API available - all features enabled","success"),window.INITIALIZATION_COMPLETE=!0,A(),e.next=35;break;case 17:return e.prev=17,e.t0=e.catch(1),console.error("Word API test failed:",e.t0),i="Word API test failed",e.t0.message.includes("timeout")?i="Word API connection timeout":e.t0.message.includes("InvalidApiCallInContext")?i="Word API context not ready":e.t0.message.includes("permission")?i="Insufficient permissions for Word API":e.t0.message.includes("GeneralException")?i="Word API general error":e.t0.message.includes("ItemNotFound")&&(i="Word API item not found"),console.log("Word API test failed: ".concat(i,", switching to demo mode")),e.prev=23,e.next=26,o.e(199).then(o.bind(o,79199));case 26:(0,e.sent.updateStatus)(i+" - switching to demo mode","warning"),e.next=34;break;case 31:e.prev=31,e.t1=e.catch(23),console.error("Error importing updateStatus:",e.t1);case 34:w();case 35:case"end":return e.stop()}}),e,null,[[1,17],[23,31]])}))),b.apply(this,arguments)}function w(){return E.apply(this,arguments)}function E(){return(E=l(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Word API is unavailable - enabling demo mode"),window.WORD_API_AVAILABLE=!1,e.prev=2,e.next=5,o.e(199).then(o.bind(o,79199));case 5:(0,e.sent.updateStatus)("Demo mode - Word API not available. Some features limited.","warning"),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),console.error("Error importing updateStatus:",e.t0),(t=document.getElementById("status-message"))&&(t.textContent="Demo mode - Word API not available. Some features limited.");case 15:x();case 16:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}function I(){console.log("Running basic initialization fallback..."),document.body.classList.add("ms-font-m","ms-welcome","ms-Fabric");var e=document.getElementById("status-message");e&&(e.textContent="Add-in loaded in basic mode. Limited functionality available."),document.querySelectorAll("button").forEach((function(e){e.disabled=!0,e.title="Feature not available in basic mode"})),console.log("Basic initialization complete")}function A(){console.log("Enabling Word-dependent features..."),["generate-contract","analyze-contract","toggle-track-changes","highlight-risks","suggest-changes"].forEach((function(e){var t=document.getElementById(e);t&&(t.disabled=!1,t.title="")}));var e=document.getElementById("generate-button-group");e&&(e.style.display="block")}function x(){console.log("Enabling demo mode..."),["analyze-contract"].forEach((function(e){var t=document.getElementById(e);t&&(t.disabled=!1,t.title="Demo mode - uses sample data")})),["generate-contract","toggle-track-changes","highlight-risks","suggest-changes"].forEach((function(e){var t=document.getElementById(e);t&&(t.disabled=!0,t.title="Requires Word API - not available in current environment")}));var e=document.getElementById("generate-button-group");e&&(e.style.display="none")}function k(){return P.apply(this,arguments)}function P(){return(P=l(c().mark((function e(){var t,n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Initializing in limited mode without Word API"),e.prev=1,e.next=4,o.e(199).then(o.bind(o,79199));case 4:t=e.sent,n=t.initializeTheme,r=t.updateStatus,n(),O(),B(),r("Add-in loaded in limited mode. Some features may not be available.","warning"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.error("Error in limited mode initialization:",e.t0),I();case 17:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function S(){var e,t,n,r,o,a={officeVersion:(null===(e=Office)||void 0===e||null===(e=e.context)||void 0===e||null===(e=e.diagnostics)||void 0===e?void 0:e.version)||"Unknown",platform:(null===(t=Office)||void 0===t||null===(t=t.context)||void 0===t||null===(t=t.diagnostics)||void 0===t?void 0:t.platform)||"Unknown",host:(null===(n=Office)||void 0===n||null===(n=n.context)||void 0===n||null===(n=n.diagnostics)||void 0===n?void 0:n.host)||"Unknown",officeJsLoaded:"undefined"!=typeof Office,wordApiAvailable:"undefined"!=typeof Word,wordRunAvailable:"function"==typeof(null===(r=Word)||void 0===r?void 0:r.run),wordApiReady:window.WORD_API_READY||!1,wordApiAvailableGlobal:window.WORD_API_AVAILABLE||!1,requirements:(null===(o=Office)||void 0===o||null===(o=o.context)||void 0===o?void 0:o.requirements)||"Not available",userAgent:navigator.userAgent||"Unknown",location:window.location.href,officeReady:window.OFFICE_READY||!1,initializationComplete:window.INITIALIZATION_COMPLETE||!1,isOnline:navigator.onLine,cookiesEnabled:navigator.cookieEnabled,language:navigator.language,timestamp:(new Date).toISOString()};console.log("Enhanced Diagnostic Information:",a);var i="Diagnostic - Office: ".concat(a.officeVersion,", Platform: ").concat(a.platform,", Word API: ").concat(a.wordApiAvailable?"Available":"Not Available",", Ready: ").concat(a.wordApiReady);try{updateStatus(i,"info")}catch(e){console.error("Error updating status:",e)}return function(e){var t=document.getElementById("status-message");t&&(t.innerHTML='\n      <div class="diagnostic-info" style="text-align: left; font-size: 11px; line-height: 1.4;">\n        <h4 style="margin: 0 0 10px 0; color: #0078d4;">Word API Diagnostic Information</h4>\n\n        <div style="margin-bottom: 8px;">\n          <strong>Office Environment:</strong><br>\n          • Version: '.concat(e.officeVersion,"<br>\n          • Platform: ").concat(e.platform,"<br>\n          • Host: ").concat(e.host,"<br>\n          • Online: ").concat(e.isOnline?"Yes":"No",'\n        </div>\n\n        <div style="margin-bottom: 8px;">\n          <strong>Word API Status:</strong><br>\n          • Word Object: ').concat(e.wordApiAvailable?"✅ Available":"❌ Not Available","<br>\n          • Word.run Function: ").concat(e.wordRunAvailable?"✅ Available":"❌ Not Available","<br>\n          • API Ready: ").concat(e.wordApiReady?"✅ Yes":"❌ No","<br>\n          • Global Available: ").concat(e.wordApiAvailableGlobal?"✅ Yes":"❌ No",'\n        </div>\n\n        <div style="margin-bottom: 8px;">\n          <strong>Initialization:</strong><br>\n          • Office.js: ').concat(e.officeJsLoaded?"✅ Loaded":"❌ Not Loaded","<br>\n          • Office Ready: ").concat(e.officeReady?"✅ Yes":"❌ No","<br>\n          • Init Complete: ").concat(e.initializationComplete?"✅ Yes":"❌ No",'\n        </div>\n\n        <div style="margin-bottom: 8px;">\n          <strong>Environment:</strong><br>\n          • Browser: ').concat(e.userAgent.split(" ").slice(-2).join(" "),"<br>\n          • Language: ").concat(e.language,"<br>\n          • Cookies: ").concat(e.cookiesEnabled?"Enabled":"Disabled",'\n        </div>\n\n        <div style="margin-top: 10px; padding: 8px; background: #f0f0f0; border-radius: 4px;">\n          <strong>Troubleshooting:</strong><br>\n          ').concat(e.wordApiAvailable?"✅ Word API is available. If features aren't working, try refreshing.":"❌ Word API not available. Try: 1) Refresh page, 2) Restart Word, 3) Check network connection",'\n        </div>\n\n        <div style="margin-top: 8px; font-size: 10px; color: #666;">\n          Generated: ').concat(e.timestamp,"\n        </div>\n      </div>\n    "))}(a),a}function O(){var e=document.getElementById("generate-contract");e&&e.addEventListener("click",D);var t=document.getElementById("analyze-contract");t&&t.addEventListener("click",F);var n=document.getElementById("agreement-type");n&&n.addEventListener("change",G);var r=document.getElementById("content-type");r&&r.addEventListener("change",V);var o=document.getElementById("clear-results");o&&o.addEventListener("click",_);var a=document.getElementById("clear-suggestions");a&&a.addEventListener("click",N);var i=document.getElementById("toggle-track-changes");i&&i.addEventListener("click",$);var c=document.getElementById("highlight-risks");c&&c.addEventListener("click",Z);var s=document.getElementById("check-compliance");s&&s.addEventListener("click",J);var l=document.getElementById("suggest-changes");l&&l.addEventListener("click",K);var u=document.getElementById("show-diagnostics");u&&u.addEventListener("click",S);var d=document.getElementById("skip-word-api-test");d&&d.addEventListener("click",h),console.log("Event listeners set up successfully")}function T(){return W.apply(this,arguments)}function W(){return(W=l(c().mark((function e(){var t,n,r,a,i,s,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("dynamic-form"),n=document.getElementById("generate-button-group"),r=document.getElementById("content-type-group"),a=document.getElementById("results-section"),i=document.getElementById("suggestions-section"),s=document.getElementById("progress-section"),t&&(t.style.display="none"),n&&(n.style.display="none"),r&&(r.style.display="none"),a&&(a.style.display="none"),i&&(i.style.display="none"),s&&(s.style.display="none"),["generate-contract","analyze-contract","toggle-track-changes","highlight-risks","suggest-changes","check-compliance"].forEach((function(e){var t=document.getElementById(e);t&&(t.disabled=!0,t.title="Initializing...")})),e.prev=14,e.next=17,o.e(199).then(o.bind(o,79199));case 17:(0,e.sent.updateStatus)("Initializing add-in...","info"),e.next=27;break;case 22:e.prev=22,e.t0=e.catch(14),console.error("Error importing updateStatus:",e.t0),(l=document.getElementById("status-message"))&&(l.textContent="Initializing add-in...");case 27:console.log("Basic UI initialized successfully");case 28:case"end":return e.stop()}}),e,null,[[14,22]])})))).apply(this,arguments)}function B(){var e=document.getElementById("dynamic-form"),t=document.getElementById("generate-button-group"),n=document.getElementById("content-type-group"),r=document.getElementById("results-section"),o=document.getElementById("suggestions-section"),a=document.getElementById("progress-section");e&&(e.style.display="none"),t&&(t.style.display="none"),n&&(n.style.display="none"),r&&(r.style.display="none"),o&&(o.style.display="none"),a&&(a.style.display="none"),["generate-contract","analyze-contract","toggle-track-changes","highlight-risks","suggest-changes"].forEach((function(e){var t=document.getElementById(e);t&&(t.disabled=!0,t.title="Word API not available - feature disabled")})),console.log("Limited UI initialized successfully")}function L(e){return C.apply(this,arguments)}function C(){return(C=l(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.e(199).then(o.bind(o,79199));case 3:(0,e.sent.handleError)(t),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error importing handleError:",e.t0),(n=document.getElementById("status-message"))&&(n.textContent="Error: ".concat(t.message||t),n.className="status-message ms-font-s error");case 13:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function _(){return R.apply(this,arguments)}function R(){return(R=l(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.e(199).then(o.bind(o,79199));case 3:(0,e.sent.clearResults)(),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error importing clearResults:",e.t0),(t=document.getElementById("results-section"))&&(t.style.display="none");case 13:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function N(){return j.apply(this,arguments)}function j(){return(j=l(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.e(199).then(o.bind(o,79199));case 3:(0,e.sent.clearSuggestions)(),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error importing clearSuggestions:",e.t0),(t=document.getElementById("suggestions-section"))&&(t.style.display="none");case 13:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function D(){return z.apply(this,arguments)}function z(){return(z=l(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.WORD_API_AVAILABLE){e.next=13;break}return e.prev=1,e.next=4,o.e(199).then(o.bind(o,79199));case 4:(0,e.sent.updateStatus)("Error: Word API not available. Cannot generate contract.","error"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Error importing updateStatus:",e.t0);case 12:return e.abrupt("return");case 13:return e.prev=13,e.next=16,o.e(650).then(o.bind(o,14650));case 16:return t=e.sent,n=t.generateContract,e.next=20,n();case 20:e.next=36;break;case 22:return e.prev=22,e.t1=e.catch(13),console.error("Error importing or calling generateContract:",e.t1),e.prev=25,e.next=28,o.e(199).then(o.bind(o,79199));case 28:(0,e.sent.updateStatus)("Error: Failed to generate contract. "+e.t1.message,"error"),e.next=36;break;case 33:e.prev=33,e.t2=e.catch(25),console.error("Error importing updateStatus:",e.t2);case 36:case"end":return e.stop()}}),e,null,[[1,9],[13,22],[25,33]])})))).apply(this,arguments)}function F(){return M.apply(this,arguments)}function M(){return(M=l(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!window.WORD_API_AVAILABLE){e.next=10;break}return e.next=4,o.e(650).then(o.bind(o,14650));case 4:return t=e.sent,n=t.analyzeContract,e.next=8,n();case 8:e.next=12;break;case 10:return e.next=12,q();case 12:e.next=28;break;case 14:return e.prev=14,e.t0=e.catch(0),console.error("Error in contract analysis:",e.t0),e.prev=17,e.next=20,o.e(199).then(o.bind(o,79199));case 20:(0,e.sent.updateStatus)("Error: Failed to analyze contract. "+e.t0.message,"error"),e.next=28;break;case 25:e.prev=25,e.t1=e.catch(17),console.error("Error importing updateStatus:",e.t1);case 28:case"end":return e.stop()}}),e,null,[[0,14],[17,25]])})))).apply(this,arguments)}function G(e){return Y.apply(this,arguments)}function Y(){return(Y=l(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.e(650).then(o.bind(o,14650));case 3:(0,e.sent.handleAgreementTypeChange)(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error handling agreement type change:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function V(e){return U.apply(this,arguments)}function U(){return(U=l(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.e(650).then(o.bind(o,14650));case 3:(0,e.sent.handleContentTypeChange)(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error handling content type change:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function q(){return H.apply(this,arguments)}function H(){return(H=l(c().mark((function e(){var t,n,r,a,s,l,u,d,f,p,g,m,h,v,y;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.e(199).then(o.bind(o,79199));case 3:return t=e.sent,(n=t.updateStatus)("Running demo analysis with sample contract...","info"),e.prev=6,e.next=9,o.e(82).then(o.bind(o,27082));case 9:return r=e.sent,a=r.generateDemoAnalysis,s=r.generateRiskAnalysis,l=r.generateChangeSuggestions,e.next=15,o.e(709).then(o.bind(o,85709));case 15:return u=e.sent,d=u.displayCombinedAnalysisResults,f="SAMPLE CONTENT MANAGEMENT AGREEMENT\n\nThis Content Management Agreement is entered into between Company A and Company B.\n\n1. SCOPE OF SERVICES\nThe Manager will provide content management services including distribution and marketing.\n\n2. COMPENSATION\nRevenue will be split 80% to Artist and 20% to Manager.\n\n3. TERM\nThis agreement is effective for 2 years from the date of signing.",e.next=20,Promise.all([a(f),s(f),l(f)]);case 20:p=e.sent,b=3,g=function(e){if(Array.isArray(e))return e}(c=p)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],s=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){l=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(c,b)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(c,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),m=g[0],h=g[1],v=g[2],d(m,h,v,{title:"📊 Executive Summary (Demo)",overview:"This is a demo analysis using sample contract data. In real mode, this would analyze your actual Word document."}),n("Demo analysis complete! This used sample data.","success"),e.next=34;break;case 30:e.prev=30,e.t0=e.catch(6),console.error("Error in demo analysis:",e.t0),n("Error: Failed to run demo analysis. "+e.t0.message,"error");case 34:e.next=41;break;case 36:e.prev=36,e.t1=e.catch(0),console.error("Error importing updateStatus:",e.t1),(y=document.getElementById("status-message"))&&(y.textContent="Error: Failed to run demo analysis.");case 41:case"end":return e.stop()}var c,b}),e,null,[[0,36],[6,30]])})))).apply(this,arguments)}function $(){updateStatus("Toggling track changes...","info")}function Z(){updateStatus("Highlighting risks...","info")}function J(){updateStatus("Checking compliance...","info")}function K(){updateStatus("Applying suggested changes...","info")}o.m=n,o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,n){return o.f[n](e,t),t}),[]))},o.u=function(e){return e+".js"},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e={},t="starling-word-addin:",o.l=function(n,r,a,i){if(e[n])e[n].push(r);else{var c,s;if(void 0!==a)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+a){c=d;break}}c||(s=!0,(c=document.createElement("script")).charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.setAttribute("data-webpack",t+a),c.src=n),e[n]=[r];var f=function(t,r){c.onerror=c.onload=null,clearTimeout(p);var o=e[n];if(delete e[n],c.parentNode&&c.parentNode.removeChild(c),o&&o.forEach((function(e){return e(r)})),t)return t(r)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=f.bind(null,c.onerror),c.onload=f.bind(null,c.onload),s&&document.head.appendChild(c)}},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e}(),function(){var e={926:0};o.f.j=function(t,n){var r=o.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var a=new Promise((function(n,o){r=e[t]=[n,o]}));n.push(r[2]=a);var i=o.p+o.u(t),c=new Error;o.l(i,(function(n){if(o.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;c.message="Loading chunk "+t+" failed.\n("+a+": "+i+")",c.name="ChunkLoadError",c.type=a,c.request=i,r[1](c)}}),"chunk-"+t,t)}};var t=function(t,n){var r,a,i=n[0],c=n[1],s=n[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(r in c)o.o(c,r)&&(o.m[r]=c[r]);s&&s(o)}for(t&&t(n);l<i.length;l++)a=i[l],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunkstarling_word_addin=self.webpackChunkstarling_word_addin||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}(),window.WORD_API_AVAILABLE=!1,window.OFFICE_READY=!1,window.WORD_API_READY=!1,window.INITIALIZATION_COMPLETE=!1,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",u):u(),window.addEventListener("error",(function(e){console.error("Global error:",e.error),L(e.error)})),window.addEventListener("unhandledrejection",(function(e){console.error("Unhandled promise rejection:",e.reason),L(e.reason)})),console.log("RHEI AI Legal Assistant module loaded")}();
//# sourceMappingURL=taskpane.js.map