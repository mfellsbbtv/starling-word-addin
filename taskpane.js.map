{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://starling-word-addin/./src/shared/utils.js","webpack://starling-word-addin/./src/shared/api-service.js","webpack://starling-word-addin/./src/taskpane/services/contract-analyzer.js","webpack://starling-word-addin/./src/taskpane/services/contract-generator.js","webpack://starling-word-addin/./src/taskpane/modules/ui-display.js","webpack://starling-word-addin/./src/taskpane/modules/event-handlers.js","webpack://starling-word-addin/./src/shared/config.js","webpack://starling-word-addin/./src/taskpane/taskpane.js"],"sourcesContent":["// Shared utility functions\n\n// Enhanced button state management\nexport function setButtonLoading(buttonId, isLoading) {\n  const button = document.getElementById(buttonId);\n  if (isLoading) {\n    button.classList.add(\"loading\");\n    button.disabled = true;\n  } else {\n    button.classList.remove(\"loading\");\n    button.disabled = false;\n  }\n}\n\n// Helper functions\nexport function updateStatus(message, type = \"info\") {\n  const statusElement = document.getElementById(\"status-message\");\n  statusElement.textContent = message;\n  statusElement.className = `status-message ms-font-s ${type} slide-in`;\n\n  // Add success animation for success messages\n  if (type === \"success\") {\n    statusElement.classList.add(\"success-animation\");\n    setTimeout(() => {\n      statusElement.classList.remove(\"success-animation\");\n    }, 600);\n  }\n}\n\nexport function showProgressSection(message) {\n  document.getElementById(\"progress-section\").style.display = \"block\";\n  document.getElementById(\"progress-text\").textContent = message;\n  simulateProgress();\n}\n\nexport function hideProgressSection() {\n  document.getElementById(\"progress-section\").style.display = \"none\";\n}\n\n// Progress simulation\nfunction simulateProgress() {\n  const progressBar = document.getElementById(\"progress-bar\");\n  let progress = 0;\n  \n  const interval = setInterval(() => {\n    progress += Math.random() * 15;\n    if (progress > 90) progress = 90;\n    \n    progressBar.style.width = progress + \"%\";\n    \n    if (progress >= 90) {\n      clearInterval(interval);\n    }\n  }, 200);\n}\n\n// Error handling\nexport function handleError(error) {\n  console.error(\"Error:\", error);\n  let errorMessage = \"An error occurred\";\n  \n  if (error.message) {\n    errorMessage = error.message;\n  } else if (typeof error === 'string') {\n    errorMessage = error;\n  }\n  \n  updateStatus(errorMessage, \"error\");\n  hideProgressSection();\n}\n\n// Clear results functions\nexport function clearResults() {\n  const resultsSection = document.getElementById(\"results-section\");\n  const resultsContent = document.getElementById(\"results-content\");\n  \n  resultsSection.style.display = \"none\";\n  resultsContent.innerHTML = \"\";\n  \n  updateStatus(\"Results cleared\", \"info\");\n}\n\nexport function clearSuggestions() {\n  const suggestionsSection = document.getElementById(\"suggestions-section\");\n  const suggestionsContent = document.getElementById(\"suggestions-content\");\n  \n  suggestionsSection.style.display = \"none\";\n  suggestionsContent.innerHTML = \"\";\n  \n  updateStatus(\"Suggestions cleared\", \"info\");\n}\n\n// Theme detection and initialization\nexport function initializeTheme() {\n  // Detect Office theme\n  if (Office.context && Office.context.officeTheme) {\n    const theme = Office.context.officeTheme;\n    document.body.className = `office-theme-${theme.bodyBackgroundColor}`;\n  }\n}\n","// API Service Layer - following augment-guidelines: centralized API calls\nexport class APIService {\n  constructor(config) {\n    this.config = config;\n  }\n\n  async makeRequest(endpoint, options = {}) {\n    if (!this.config.USE_REAL_API) {\n      console.log(`[DEMO MODE] Would call API: ${endpoint}`, options);\n      return this.getMockResponse(endpoint, options);\n    }\n\n    const url = `${this.config.baseUrl}${endpoint}`;\n    const requestOptions = {\n      method: options.method || 'GET',\n      headers: {\n        ...this.config.headers,\n        ...options.headers\n      },\n      ...options\n    };\n\n    if (options.body && typeof options.body === 'object') {\n      requestOptions.body = JSON.stringify(options.body);\n    }\n\n    try {\n      const response = await fetch(url, requestOptions);\n\n      if (!response.ok) {\n        throw new Error(`API Error: ${response.status} ${response.statusText}`);\n      }\n\n      return await response.json();\n    } catch (error) {\n      console.error('API Request failed:', error);\n      throw error;\n    }\n  }\n\n  // Mock responses for demo mode\n  getMockResponse(endpoint, options) {\n    if (endpoint.includes('/analyze')) {\n      return this.getMockAnalysisResponse(options.body);\n    } else if (endpoint.includes('/generate')) {\n      return this.getMockGenerationResponse(options.body);\n    } else if (endpoint.includes('/health')) {\n      return { status: 'healthy', timestamp: new Date().toISOString() };\n    }\n\n    return { message: 'Mock response', endpoint, options };\n  }\n\n  getMockAnalysisResponse(requestData) {\n    // Return mock analysis data (existing demo logic)\n    return {\n      contract_type: \"Content Management Agreement\",\n      compliance_score: 85,\n      summary: \"This contract appears well-structured with standard clauses.\",\n      risks: [\n        { severity: \"medium\", description: \"Consider adding force majeure clause\" },\n        { severity: \"low\", description: \"Termination notice period could be more specific\" }\n      ],\n      key_terms: [\"Payment Terms\", \"Geographic Scope\", \"Rights Management\"],\n      recommendations: [\n        \"Consider legal review before execution\",\n        \"Ensure all parties review terms carefully\"\n      ]\n    };\n  }\n\n  getMockGenerationResponse(requestData) {\n    // Return mock generation data\n    return {\n      contract_text: \"Generated contract content would be here...\",\n      metadata: {\n        template_used: requestData?.agreement_type || \"content-management\",\n        generated_at: new Date().toISOString()\n      }\n    };\n  }\n\n  // API Methods\n  async analyzeContract(documentText) {\n    return this.makeRequest('/contracts/analyze', {\n      method: 'POST',\n      body: {\n        document_text: documentText,\n        analysis_type: 'comprehensive'\n      }\n    });\n  }\n\n  async generateContract(formData) {\n    return this.makeRequest('/contracts/generate', {\n      method: 'POST',\n      body: formData\n    });\n  }\n\n  async checkHealth() {\n    return this.makeRequest('/health');\n  }\n}\n","// Contract Analysis Service\nimport { updateStatus, showProgressSection, hideProgressSection, handleError, setButtonLoading } from '../../shared/utils.js';\n\n// Analyze track changes in the document\nexport async function analyzeTrackChanges() {\n  try {\n    // Ensure Word API is available\n    if (typeof Word === 'undefined') {\n      throw new Error('Word API not available. Please ensure you are running this add-in in Microsoft Word.');\n    }\n\n    // Additional check for Office.js initialization\n    if (!Office.context || !Office.context.document) {\n      throw new Error('Office.js not properly initialized. Please refresh the add-in.');\n    }\n\n    return await Word.run(async (context) => {\n      const body = context.document.body;\n      const revisions = context.document.revisions;\n\n      // Load revisions and their properties\n      revisions.load(\"items\");\n      body.load(\"text\");\n\n      await context.sync();\n\n      const changeData = {\n        hasChanges: revisions.items.length > 0,\n        totalRevisions: revisions.items.length,\n        revisions: []\n      };\n\n      // Analyze each revision\n      for (let i = 0; i < revisions.items.length; i++) {\n        const revision = revisions.items[i];\n        revision.load([\"range\", \"type\", \"author\", \"date\"]);\n        await context.sync();\n\n        revision.range.load([\"text\", \"start\", \"end\"]);\n        await context.sync();\n\n        changeData.revisions.push({\n          type: revision.type,\n          text: revision.range.text,\n          author: revision.author,\n          date: revision.date,\n          start: revision.range.start,\n          end: revision.range.end\n        });\n      }\n\n      return changeData;\n    });\n  } catch (error) {\n    console.error(\"Error analyzing track changes:\", error);\n    return { hasChanges: false, totalRevisions: 0, revisions: [] };\n  }\n}\n\n// Check if a specific text range has been modified\nexport async function checkClauseModifications(clauseText, startPosition) {\n  try {\n    // Ensure Word API is available\n    if (typeof Word === 'undefined') {\n      throw new Error('Word API not available. Please ensure you are running this add-in in Microsoft Word.');\n    }\n\n    // Additional check for Office.js initialization\n    if (!Office.context || !Office.context.document) {\n      throw new Error('Office.js not properly initialized. Please refresh the add-in.');\n    }\n\n    return await Word.run(async (context) => {\n      const body = context.document.body;\n      const searchResults = body.search(clauseText, { matchCase: false, matchWholeWord: false });\n      searchResults.load([\"items\"]);\n\n      await context.sync();\n\n      if (searchResults.items.length === 0) {\n        return { isModified: false, hasChanges: false };\n      }\n\n      const range = searchResults.items[0];\n      range.load([\"start\", \"end\", \"text\"]);\n      await context.sync();\n\n      // Check for revisions in this range\n      const revisions = context.document.revisions;\n      revisions.load(\"items\");\n      await context.sync();\n\n      let hasModifications = false;\n      const modifications = [];\n\n      for (let i = 0; i < revisions.items.length; i++) {\n        const revision = revisions.items[i];\n        revision.load([\"range\", \"type\", \"author\", \"date\"]);\n        await context.sync();\n\n        revision.range.load([\"start\", \"end\", \"text\"]);\n        await context.sync();\n\n        // Check if revision overlaps with our clause range\n        if (revision.range.start >= range.start && revision.range.end <= range.end) {\n          hasModifications = true;\n          modifications.push({\n            type: revision.type,\n            text: revision.range.text,\n            author: revision.author,\n            date: revision.date\n          });\n        }\n      }\n\n      return {\n        isModified: hasModifications,\n        hasChanges: hasModifications,\n        modifications: modifications,\n        originalText: clauseText,\n        currentText: range.text\n      };\n    });\n  } catch (error) {\n    console.error(\"Error checking clause modifications:\", error);\n    return { isModified: false, hasChanges: false };\n  }\n}\n\n// Generate demo analysis locally (for demo purposes)\nexport async function generateDemoAnalysis(documentText) {\n  const wordCount = documentText.split(/\\s+/).length;\n  const hasSignatureLines = documentText.includes('_______') || documentText.includes('DATE:');\n  const hasParties = documentText.toLowerCase().includes('party') || documentText.toLowerCase().includes('agreement');\n  const hasTermination = documentText.toLowerCase().includes('termination') || documentText.toLowerCase().includes('terminate');\n  const hasCompensation = documentText.toLowerCase().includes('fee') || documentText.toLowerCase().includes('payment') || documentText.toLowerCase().includes('compensation');\n\n  // Determine contract type based on content\n  let contractType = \"General Agreement\";\n  if (documentText.toLowerCase().includes('content management')) {\n    contractType = \"Content Management Agreement\";\n  } else if (documentText.toLowerCase().includes('licensing')) {\n    contractType = \"Licensing Agreement\";\n  } else if (documentText.toLowerCase().includes('distribution')) {\n    contractType = \"Distribution Agreement\";\n  } else if (documentText.toLowerCase().includes('talent')) {\n    contractType = \"Talent Agreement\";\n  }\n\n  // Calculate a demo compliance score\n  let complianceScore = 70; // Base score\n  if (hasSignatureLines) complianceScore += 10;\n  if (hasParties) complianceScore += 10;\n  if (hasTermination) complianceScore += 5;\n  if (hasCompensation) complianceScore += 5;\n\n  // Generate risk assessment\n  const risks = [];\n  if (!hasTermination) {\n    risks.push(\"Missing termination clause - consider adding clear termination conditions\");\n  }\n  if (!hasCompensation) {\n    risks.push(\"Compensation terms unclear - ensure payment terms are explicitly defined\");\n  }\n  if (wordCount < 100) {\n    risks.push(\"Contract appears incomplete - consider adding more detailed terms\");\n  }\n\n  // Parse contract structure for articles and clauses\n  const contractStructure = await parseContractStructureWithChanges(documentText);\n\n  return {\n    contract_type: contractType,\n    word_count: wordCount,\n    compliance_score: Math.min(complianceScore, 100),\n    summary: `This ${contractType.toLowerCase()} contains ${wordCount} words and appears to be ${complianceScore >= 80 ? 'well-structured' : 'missing some standard clauses'}. ${risks.length > 0 ? 'Several areas need attention.' : 'The contract structure looks good.'}`,\n    risks: risks,\n    key_terms: extractKeyTerms(documentText),\n    recommendations: generateRecommendations(risks.length, hasSignatureLines, hasTermination),\n    contract_structure: contractStructure // Add the new structure breakdown with change tracking\n  };\n}\n\nexport function extractKeyTerms(text) {\n  const terms = [];\n  const lowerText = text.toLowerCase();\n\n  if (lowerText.includes('term') || lowerText.includes('duration')) {\n    terms.push(\"Contract Duration\");\n  }\n  if (lowerText.includes('fee') || lowerText.includes('payment')) {\n    terms.push(\"Payment Terms\");\n  }\n  if (lowerText.includes('territory') || lowerText.includes('worldwide')) {\n    terms.push(\"Geographic Scope\");\n  }\n  if (lowerText.includes('intellectual property') || lowerText.includes('rights')) {\n    terms.push(\"Rights Management\");\n  }\n\n  return terms.length > 0 ? terms : [\"Standard Contract Terms\"];\n}\n\nexport function generateRecommendations(riskCount, hasSignatures, hasTermination) {\n  const recommendations = [];\n\n  if (riskCount > 2) {\n    recommendations.push(\"Consider legal review before execution\");\n  }\n  if (!hasSignatures) {\n    recommendations.push(\"Add proper signature blocks and date fields\");\n  }\n  if (!hasTermination) {\n    recommendations.push(\"Include clear termination and dispute resolution clauses\");\n  }\n\n  recommendations.push(\"Ensure all parties review terms carefully\");\n  recommendations.push(\"Consider adding governing law and jurisdiction clauses\");\n\n  return recommendations;\n}\n\n// Risk Analysis Functions\nexport function generateRiskAnalysis(documentText) {\n  const risks = [];\n  const lowerText = documentText.toLowerCase();\n\n  // Check for missing critical clauses\n  if (!lowerText.includes('termination') && !lowerText.includes('terminate')) {\n    risks.push({\n      severity: 'high',\n      category: 'Missing Clause',\n      title: 'No Termination Clause',\n      description: 'Contract lacks clear termination conditions and procedures.',\n      location: 'Document-wide',\n      suggestion: 'Add a comprehensive termination clause specifying conditions, notice periods, and post-termination obligations.'\n    });\n  }\n\n  if (!lowerText.includes('liability') && !lowerText.includes('damages')) {\n    risks.push({\n      severity: 'critical',\n      category: 'Legal Risk',\n      title: 'No Liability Limitation',\n      description: 'Contract does not address liability limitations or damage caps.',\n      location: 'Document-wide',\n      suggestion: 'Include liability limitation clauses to protect against excessive damages.'\n    });\n  }\n\n  if (!lowerText.includes('dispute') && !lowerText.includes('arbitration') && !lowerText.includes('jurisdiction')) {\n    risks.push({\n      severity: 'medium',\n      category: 'Dispute Resolution',\n      title: 'No Dispute Resolution Mechanism',\n      description: 'Contract lacks clear dispute resolution procedures.',\n      location: 'Document-wide',\n      suggestion: 'Add dispute resolution clause specifying arbitration, mediation, or court jurisdiction.'\n    });\n  }\n\n  if (!lowerText.includes('confidential') && !lowerText.includes('proprietary')) {\n    risks.push({\n      severity: 'medium',\n      category: 'IP Protection',\n      title: 'No Confidentiality Provisions',\n      description: 'Contract may not adequately protect confidential information.',\n      location: 'Document-wide',\n      suggestion: 'Include confidentiality and non-disclosure provisions.'\n    });\n  }\n\n  if (!lowerText.includes('force majeure') && !lowerText.includes('act of god')) {\n    risks.push({\n      severity: 'low',\n      category: 'Risk Management',\n      title: 'No Force Majeure Clause',\n      description: 'Contract lacks protection against unforeseeable circumstances.',\n      location: 'Document-wide',\n      suggestion: 'Consider adding force majeure clause for protection against extraordinary events.'\n    });\n  }\n\n  return {\n    total_risks: risks.length,\n    risk_score: calculateRiskScore(risks),\n    risks: risks,\n    summary: `Found ${risks.length} potential risk areas. ${risks.filter(r => r.severity === 'critical').length} critical, ${risks.filter(r => r.severity === 'high').length} high, ${risks.filter(r => r.severity === 'medium').length} medium, ${risks.filter(r => r.severity === 'low').length} low priority issues.`\n  };\n}\n\nfunction calculateRiskScore(risks) {\n  let score = 100;\n  risks.forEach(risk => {\n    switch(risk.severity) {\n      case 'critical': score -= 25; break;\n      case 'high': score -= 15; break;\n      case 'medium': score -= 10; break;\n      case 'low': score -= 5; break;\n    }\n  });\n  return Math.max(score, 0);\n}\n\n// Change Suggestions Functions\nexport function generateChangeSuggestions(documentText) {\n  const suggestions = [];\n  const lowerText = documentText.toLowerCase();\n\n  // Analyze contract structure and suggest improvements\n  if (lowerText.includes('shall') && !lowerText.includes('may')) {\n    suggestions.push({\n      type: 'Language Improvement',\n      priority: 'medium',\n      title: 'Balance Mandatory vs Optional Language',\n      current: 'Contract uses only mandatory \"shall\" language',\n      suggested: 'Consider using \"may\" for optional provisions to provide flexibility',\n      benefit: 'Provides better balance between obligations and flexibility'\n    });\n  }\n\n  if (!lowerText.includes('including but not limited to') && !lowerText.includes('such as')) {\n    suggestions.push({\n      type: 'Clarity Enhancement',\n      priority: 'low',\n      title: 'Add Inclusive Language',\n      current: 'Lists may appear exhaustive',\n      suggested: 'Add \"including but not limited to\" before lists to indicate they are not exhaustive',\n      benefit: 'Prevents interpretation that lists are complete and exclusive'\n    });\n  }\n\n  if (lowerText.includes('reasonable') && !lowerText.includes('commercially reasonable')) {\n    suggestions.push({\n      type: 'Legal Precision',\n      priority: 'medium',\n      title: 'Clarify \"Reasonable\" Standards',\n      current: 'Uses vague \"reasonable\" standard',\n      suggested: 'Replace with \"commercially reasonable\" or define specific criteria',\n      benefit: 'Reduces ambiguity and potential disputes over reasonableness'\n    });\n  }\n\n  if (!lowerText.includes('time is of the essence')) {\n    suggestions.push({\n      type: 'Performance Standards',\n      priority: 'low',\n      title: 'Add Time Performance Clause',\n      current: 'No explicit time performance requirements',\n      suggested: 'Add \"time is of the essence\" clause for critical deadlines',\n      benefit: 'Emphasizes importance of meeting deadlines and strengthens enforcement'\n    });\n  }\n\n  suggestions.push({\n    type: 'Modern Practice',\n    priority: 'low',\n    title: 'Electronic Signature Provision',\n    current: 'Traditional signature requirements',\n    suggested: 'Add electronic signature acceptance clause',\n    benefit: 'Enables faster execution and modern business practices'\n  });\n\n  return {\n    total_suggestions: suggestions.length,\n    suggestions: suggestions,\n    summary: `Generated ${suggestions.length} improvement suggestions to enhance contract clarity, enforceability, and modern business practices.`\n  };\n}\n","// Contract Generation Service\nimport { updateStatus, showProgressSection, hideProgressSection, handleError } from '../../shared/utils.js';\n\n// Form field definitions for different agreement types\nexport const FORM_TEMPLATES = {\n  'content-management': {\n    'music': [\n      { name: 'entity_name', label: 'Entity Name', type: 'text', required: true, description: 'Name of the contracting entity' },\n      { name: 'content_creator', label: 'Content Creator', type: 'text', required: true, description: 'Name of the content creator/artist' },\n      { name: 'scope_description', label: 'Scope of Work', type: 'textarea', required: true, description: 'Detailed description of content management services' },\n      { name: 'revenue_split', label: 'Revenue Split (%)', type: 'number', required: true, description: 'Percentage split for revenue sharing' },\n      { name: 'term_length', label: 'Contract Term', type: 'select', required: true, options: ['1 year', '2 years', '3 years', '5 years'], description: 'Duration of the agreement' },\n      { name: 'territory', label: 'Territory', type: 'select', required: true, options: ['Worldwide', 'North America', 'United States', 'Canada', 'Other'], description: 'Geographic scope of the agreement' },\n      { name: 'music_rights', label: 'Music Rights', type: 'select', required: true, options: ['Master Rights', 'Publishing Rights', 'Both', 'Synchronization Only'], description: 'Type of music rights being managed' },\n      { name: 'advance_amount', label: 'Advance Amount ($)', type: 'number', required: false, description: 'Initial advance payment (if applicable)' },\n      { name: 'termination_notice', label: 'Termination Notice (days)', type: 'number', required: true, description: 'Notice period required for termination' }\n    ],\n    'non-music': [\n      { name: 'entity_name', label: 'Entity Name', type: 'text', required: true, description: 'Name of the contracting entity' },\n      { name: 'content_creator', label: 'Content Creator', type: 'text', required: true, description: 'Name of the content creator' },\n      { name: 'scope_description', label: 'Scope of Work', type: 'textarea', required: true, description: 'Detailed description of content management services' },\n      { name: 'revenue_split', label: 'Revenue Split (%)', type: 'number', required: true, description: 'Percentage split for revenue sharing' },\n      { name: 'term_length', label: 'Contract Term', type: 'select', required: true, options: ['1 year', '2 years', '3 years', '5 years'], description: 'Duration of the agreement' },\n      { name: 'territory', label: 'Territory', type: 'select', required: true, options: ['Worldwide', 'North America', 'United States', 'Canada', 'Other'], description: 'Geographic scope of the agreement' },\n      { name: 'content_type', label: 'Content Type', type: 'select', required: true, options: ['Video Content', 'Podcast', 'Written Content', 'Social Media', 'Mixed Media'], description: 'Type of content being managed' },\n      { name: 'platform_focus', label: 'Platform Focus', type: 'select', required: true, options: ['YouTube', 'TikTok', 'Instagram', 'Multi-Platform', 'Other'], description: 'Primary platform for content distribution' },\n      { name: 'termination_notice', label: 'Termination Notice (days)', type: 'number', required: true, description: 'Notice period required for termination' }\n    ],\n    'both': [\n      { name: 'entity_name', label: 'Entity Name', type: 'text', required: true, description: 'Name of the contracting entity' },\n      { name: 'content_creator', label: 'Content Creator', type: 'text', required: true, description: 'Name of the content creator/artist' },\n      { name: 'scope_description', label: 'Scope of Work', type: 'textarea', required: true, description: 'Detailed description of content management services' },\n      { name: 'revenue_split_music', label: 'Music Revenue Split (%)', type: 'number', required: true, description: 'Percentage split for music revenue' },\n      { name: 'revenue_split_content', label: 'Content Revenue Split (%)', type: 'number', required: true, description: 'Percentage split for non-music content revenue' },\n      { name: 'term_length', label: 'Contract Term', type: 'select', required: true, options: ['1 year', '2 years', '3 years', '5 years'], description: 'Duration of the agreement' },\n      { name: 'territory', label: 'Territory', type: 'select', required: true, options: ['Worldwide', 'North America', 'United States', 'Canada', 'Other'], description: 'Geographic scope of the agreement' },\n      { name: 'music_rights', label: 'Music Rights', type: 'select', required: true, options: ['Master Rights', 'Publishing Rights', 'Both', 'Synchronization Only'], description: 'Type of music rights being managed' },\n      { name: 'content_platforms', label: 'Content Platforms', type: 'select', required: true, options: ['YouTube', 'TikTok', 'Instagram', 'Multi-Platform', 'Other'], description: 'Primary platforms for content distribution' },\n      { name: 'termination_notice', label: 'Termination Notice (days)', type: 'number', required: true, description: 'Notice period required for termination' }\n    ]\n  }\n};\n\n// Handle agreement type selection\nexport function handleAgreementTypeChange() {\n  const agreementType = document.getElementById(\"agreement-type\").value;\n  const contentTypeGroup = document.getElementById(\"content-type-group\");\n  const dynamicForm = document.getElementById(\"dynamic-form\");\n  const generateButtonGroup = document.getElementById(\"generate-button-group\");\n  \n  if (agreementType) {\n    contentTypeGroup.style.display = \"block\";\n    // Reset content type selection\n    document.getElementById(\"content-type\").value = \"\";\n    dynamicForm.style.display = \"none\";\n    generateButtonGroup.style.display = \"none\";\n  } else {\n    contentTypeGroup.style.display = \"none\";\n    dynamicForm.style.display = \"none\";\n    generateButtonGroup.style.display = \"none\";\n  }\n}\n\n// Handle content type selection\nexport function handleContentTypeChange() {\n  const agreementType = document.getElementById(\"agreement-type\").value;\n  const contentType = document.getElementById(\"content-type\").value;\n  const dynamicForm = document.getElementById(\"dynamic-form\");\n  const generateButtonGroup = document.getElementById(\"generate-button-group\");\n  \n  if (agreementType && contentType) {\n    generateDynamicForm(agreementType, contentType);\n    dynamicForm.style.display = \"block\";\n    generateButtonGroup.style.display = \"block\";\n  } else {\n    dynamicForm.style.display = \"none\";\n    generateButtonGroup.style.display = \"none\";\n  }\n}\n\n// Generate dynamic form based on selections\nexport function generateDynamicForm(agreementType, contentType) {\n  const dynamicForm = document.getElementById(\"dynamic-form\");\n  const template = FORM_TEMPLATES[agreementType]?.[contentType];\n  \n  if (!template) {\n    dynamicForm.innerHTML = '<p class=\"ms-font-s\">Form template not available for this combination.</p>';\n    return;\n  }\n  \n  let formHTML = '<h3 class=\"ms-font-l\">Contract Details</h3>';\n  \n  template.forEach(field => {\n    const requiredClass = field.required ? 'required-field' : '';\n    const requiredAttr = field.required ? 'required' : '';\n    \n    formHTML += `<div class=\"form-field ${requiredClass}\">`;\n    formHTML += `<label for=\"${field.name}\">${field.label}:</label>`;\n    \n    if (field.type === 'textarea') {\n      formHTML += `<textarea id=\"${field.name}\" name=\"${field.name}\" ${requiredAttr} placeholder=\"Enter ${field.label.toLowerCase()}\"></textarea>`;\n    } else if (field.type === 'select') {\n      formHTML += `<select id=\"${field.name}\" name=\"${field.name}\" ${requiredAttr}>`;\n      formHTML += `<option value=\"\">Select ${field.label}</option>`;\n      field.options.forEach(option => {\n        formHTML += `<option value=\"${option}\">${option}</option>`;\n      });\n      formHTML += `</select>`;\n    } else {\n      const inputType = field.type === 'number' ? 'number' : 'text';\n      formHTML += `<input type=\"${inputType}\" id=\"${field.name}\" name=\"${field.name}\" ${requiredAttr} placeholder=\"Enter ${field.label.toLowerCase()}\">`;\n    }\n    \n    if (field.description) {\n      formHTML += `<div class=\"field-description\">${field.description}</div>`;\n    }\n    \n    formHTML += `</div>`;\n  });\n  \n  dynamicForm.innerHTML = formHTML;\n}\n\n// Update contract preview with next contract details\nexport function updateContractPreview() {\n  const previewData = getNextContractPreview();\n\n  document.getElementById(\"preview-type\").textContent = previewData.type;\n  document.getElementById(\"preview-parties\").textContent = previewData.parties;\n  document.getElementById(\"preview-scope\").textContent = previewData.scope;\n}\n\n// Get preview data for the next contract to be generated\nfunction getNextContractPreview() {\n  const previews = [\n    {\n      type: \"Music Content Management Agreement\",\n      parties: \"Starling Music Management & Alex Rivera\",\n      scope: \"Digital distribution, rights management, and marketing\"\n    },\n    {\n      type: \"Video Content Management Agreement\",\n      parties: \"Digital Content Partners & Jordan Smith\",\n      scope: \"YouTube optimization and brand partnerships\"\n    },\n    {\n      type: \"Music Licensing Agreement\",\n      parties: \"Harmony Licensing Group & Taylor Music Productions\",\n      scope: \"Synchronization rights for film and television\"\n    }\n  ];\n\n  // Return a random preview to match the random contract generation\n  return previews[Math.floor(Math.random() * previews.length)];\n}\n\n// Collect form data - simplified for demo\nexport function collectFormData() {\n  // Since form fields are hidden, use varied demo values for more realistic contracts\n  const demoVariations = [\n    {\n      agreement_type: 'content-management',\n      content_type: 'music',\n      fields: {\n        entity_name: 'Starling Music Management LLC',\n        content_creator: 'Alex Rivera',\n        scope_description: 'Comprehensive music content management including digital distribution across all major platforms, rights management, marketing campaigns, and revenue collection services.',\n        revenue_split: '20',\n        term_length: '3 years',\n        territory: 'Worldwide',\n        music_rights: 'Master Rights',\n        advance_amount: '15000',\n        termination_notice: '60'\n      }\n    },\n    {\n      agreement_type: 'content-management',\n      content_type: 'non-music',\n      fields: {\n        entity_name: 'Digital Content Partners',\n        content_creator: 'Jordan Smith',\n        scope_description: 'Full-service content management for video content including YouTube optimization, brand partnerships, content strategy, and monetization.',\n        revenue_split: '25',\n        term_length: '2 years',\n        territory: 'North America',\n        content_type: 'Video Content',\n        platform_focus: 'YouTube',\n        termination_notice: '30'\n      }\n    },\n    {\n      agreement_type: 'licensing',\n      content_type: 'music',\n      fields: {\n        entity_name: 'Harmony Licensing Group',\n        content_creator: 'Taylor Music Productions',\n        scope_description: 'Licensing agreement for synchronization rights in film, television, and digital media.',\n        license_fee: '5000',\n        term_length: '5 years',\n        territory: 'Worldwide',\n        music_rights: 'Synchronization Rights',\n        termination_notice: '90'\n      }\n    }\n  ];\n\n  // Randomly select a demo variation for variety\n  const selectedDemo = demoVariations[Math.floor(Math.random() * demoVariations.length)];\n  return selectedDemo;\n}\n\n// Validate form data - simplified for demo\nexport function validateFormData(formData) {\n  // Since we're using default demo values, validation always passes\n  return true;\n}\n","// UI Display Module - handles all result display functionality\nimport { setButtonLoading } from '../../shared/utils.js';\n\n// Display combined analysis results\nexport function displayCombinedAnalysisResults(analysisResult, riskAnalysis, changeSuggestions, summaryResult) {\n  const resultsContent = document.getElementById(\"results-content\");\n  const resultsSection = document.getElementById(\"results-section\");\n\n  // Get contract structure data\n  const structure = analysisResult.contract_structure;\n  const modifiedClauses = structure.articles.reduce((count, article) =>\n    count + article.clauses.filter(clause => clause.changeStatus?.isModified).length, 0);\n  const totalClauses = structure.articles.reduce((count, article) => count + article.clauses.length, 0);\n\n  let html = `\n    <div class=\"analysis-results\">\n      <!-- 1. CONTRACT STRUCTURE BREAKDOWN (FIRST) -->\n      <div class=\"analysis-section contract-structure\">\n        <h3> Contract Structure</h3>\n        <div class=\"structure-overview\">\n          <p><strong>Total Articles:</strong> ${structure.articles.length}</p>\n          <p><strong>Total Clauses:</strong> ${totalClauses}</p>\n        </div>\n        \n        <div class=\"articles-breakdown\">`;\n\n  // Display each article with its clauses\n  structure.articles.forEach(article => {\n    html += `\n          <div class=\"article-item\">\n            <h4 class=\"article-title\">${article.number}. ${article.title}</h4>\n            <div class=\"clauses-list\">`;\n    \n    article.clauses.forEach(clause => {\n      const statusClass = clause.changeStatus?.isModified ? 'modified' : 'unmodified';\n      const statusColor = clause.changeStatus?.isModified ? 'red' : 'green';\n      \n      html += `\n              <div class=\"clause-item ${statusClass}\">\n                <span class=\"clause-number\" style=\"color: ${statusColor};\">${clause.number}</span>\n                <span class=\"clause-text\">${clause.text.substring(0, 100)}${clause.text.length > 100 ? '...' : ''}</span>\n              </div>`;\n    });\n    \n    html += `\n            </div>\n          </div>`;\n  });\n\n  html += `\n        </div>\n      </div>\n\n      <!-- 2. TRACK CHANGES SUMMARY (AFTER STRUCTURE) -->\n      <div class=\"analysis-section track-changes-summary\">\n        <h3> Track Changes Summary</h3>\n        ${structure.trackChanges ? `\n          <div class=\"change-tracking-info\">\n            <p><strong>Track Changes:</strong> ${structure.trackChanges.enabled ? 'Enabled' : 'Disabled'}</p>\n            ${structure.trackChanges.enabled ? `\n              <p><strong>Modified Clauses:</strong> <span class=\"modified-count\">${modifiedClauses}</span> / ${totalClauses}</p>\n              <p><strong>Unmodified Clauses:</strong> <span class=\"unmodified-count\">${totalClauses - modifiedClauses}</span> / ${totalClauses}</p>\n            ` : ''}\n            ${structure.trackChanges.note ? `<p class=\"track-changes-note\"><em>${structure.trackChanges.note}</em></p>` : ''}\n            ${structure.trackChanges.demoMode ? '<p class=\"demo-note\"><em>Demo mode - simulated changes for testing</em></p>' : ''}\n          </div>\n          ${structure.trackChanges.enabled ? `\n            <div class=\"change-legend\">\n              <div class=\"legend-item\">\n                <span class=\"legend-indicator modified\"></span>\n                <span>Modified Clause</span>\n              </div>\n              <div class=\"legend-item\">\n                <span class=\"legend-indicator unmodified\"></span>\n                <span>Unmodified Clause</span>\n              </div>\n            </div>\n          ` : ''}\n        ` : ''}\n      </div>\n\n      <!-- 3. EXECUTIVE SUMMARY SECTION -->\n      <div class=\"analysis-summary\">\n        <h3>${summaryResult.title}</h3>\n        <div class=\"summary-overview\">\n          <p>${summaryResult.overview}</p>\n        </div>\n        \n        <div class=\"summary-metrics\">\n          <div class=\"metric-item\">\n            <span class=\"metric-label\">Contract Type:</span>\n            <span class=\"metric-value\">${analysisResult.contract_type}</span>\n          </div>\n          <div class=\"metric-item\">\n            <span class=\"metric-label\">Word Count:</span>\n            <span class=\"metric-value\">${analysisResult.word_count}</span>\n          </div>\n          <div class=\"metric-item\">\n            <span class=\"metric-label\">Compliance Score:</span>\n            <span class=\"metric-value compliance-score\">${analysisResult.compliance_score}%</span>\n          </div>\n          <div class=\"metric-item\">\n            <span class=\"metric-label\">Risk Score:</span>\n            <span class=\"metric-value risk-score\">${riskAnalysis.risk_score}%</span>\n          </div>\n        </div>\n      </div>\n\n      <!-- 4. DETAILED ANALYSIS SECTIONS -->\n      <div class=\"detailed-analysis\">\n        \n        <!-- Risk Analysis -->\n        <div class=\"analysis-section risks\">\n          <h3> Risk Analysis</h3>\n          <p class=\"section-summary\">${riskAnalysis.summary}</p>\n          \n          <div class=\"risks-list\">`;\n\n  riskAnalysis.risks.forEach(risk => {\n    const severityClass = `severity-${risk.severity}`;\n    html += `\n            <div class=\"risk-item ${severityClass}\">\n              <div class=\"risk-header\">\n                <span class=\"risk-severity\">${risk.severity.toUpperCase()}</span>\n                <span class=\"risk-title\">${risk.title}</span>\n              </div>\n              <p class=\"risk-description\">${risk.description}</p>\n              <p class=\"risk-suggestion\"><strong>Suggestion:</strong> ${risk.suggestion}</p>\n            </div>`;\n  });\n\n  html += `\n          </div>\n        </div>\n\n        <!-- Change Suggestions -->\n        <div class=\"analysis-section suggestions\">\n          <h3> Improvement Suggestions</h3>\n          <p class=\"section-summary\">${changeSuggestions.summary}</p>\n          \n          <div class=\"suggestions-list\">`;\n\n  changeSuggestions.suggestions.forEach(suggestion => {\n    const priorityClass = `priority-${suggestion.priority}`;\n    html += `\n            <div class=\"suggestion-item ${priorityClass}\">\n              <div class=\"suggestion-header\">\n                <span class=\"suggestion-priority\">${suggestion.priority.toUpperCase()}</span>\n                <span class=\"suggestion-title\">${suggestion.title}</span>\n              </div>\n              <div class=\"suggestion-details\">\n                <p><strong>Current:</strong> ${suggestion.current}</p>\n                <p><strong>Suggested:</strong> ${suggestion.suggested}</p>\n                <p><strong>Benefit:</strong> ${suggestion.benefit}</p>\n              </div>\n            </div>`;\n  });\n\n  html += `\n          </div>\n        </div>\n\n        <!-- Key Terms -->\n        <div class=\"analysis-section key-terms\">\n          <h3> Key Terms Identified</h3>\n          <div class=\"terms-list\">`;\n\n  analysisResult.key_terms.forEach(term => {\n    html += `<span class=\"term-tag\">${term}</span>`;\n  });\n\n  html += `\n          </div>\n        </div>\n\n        <!-- Recommendations -->\n        <div class=\"analysis-section recommendations\">\n          <h3> Recommendations</h3>\n          <ul class=\"recommendations-list\">`;\n\n  analysisResult.recommendations.forEach(rec => {\n    html += `<li>${rec}</li>`;\n  });\n\n  html += `\n          </ul>\n        </div>\n      </div>\n    </div>`;\n\n  resultsContent.innerHTML = html;\n  resultsSection.style.display = \"block\";\n\n  // Show suggestions section with Apply Changes button\n  showSuggestionsSection(changeSuggestions);\n}\n\n// Show suggestions section with apply changes functionality\nexport function showSuggestionsSection(changeSuggestions) {\n  const suggestionsSection = document.getElementById(\"suggestions-section\");\n  const suggestionsContent = document.getElementById(\"suggestions-content\");\n\n  let html = `\n    <div class=\"suggestions-header\">\n      <h3> Contract Improvement Suggestions</h3>\n      <p>Review and apply the following suggestions to improve your contract:</p>\n    </div>\n    \n    <div class=\"suggestions-list\">`;\n\n  changeSuggestions.suggestions.forEach((suggestion, index) => {\n    const priorityClass = `priority-${suggestion.priority}`;\n    html += `\n      <div class=\"suggestion-card ${priorityClass}\">\n        <div class=\"suggestion-header\">\n          <span class=\"priority-badge ${suggestion.priority}\">${suggestion.priority.toUpperCase()}</span>\n          <h4>${suggestion.title}</h4>\n        </div>\n        <div class=\"suggestion-content\">\n          <div class=\"current-state\">\n            <strong>Current:</strong> ${suggestion.current}\n          </div>\n          <div class=\"suggested-change\">\n            <strong>Suggested:</strong> ${suggestion.suggested}\n          </div>\n          <div class=\"benefit\">\n            <strong>Benefit:</strong> ${suggestion.benefit}\n          </div>\n        </div>\n        <div class=\"suggestion-actions\">\n          <button class=\"apply-suggestion-btn\" onclick=\"applySuggestion(${index})\">\n            Apply This Change\n          </button>\n        </div>\n      </div>`;\n  });\n\n  html += `\n    </div>\n    \n    <div class=\"suggestions-actions\">\n      <button id=\"apply-all-changes-btn\" class=\"primary-button\" onclick=\"applyAllChanges()\">\n        Apply All Changes\n      </button>\n      <button id=\"dismiss-suggestions-btn\" class=\"secondary-button\" onclick=\"dismissSuggestions()\">\n        Dismiss Suggestions\n      </button>\n    </div>`;\n\n  suggestionsContent.innerHTML = html;\n  suggestionsSection.style.display = \"block\";\n}\n\n// Display contract generation results\nexport function displayContractResults(result) {\n  const resultsContent = document.getElementById(\"results-content\");\n  const resultsSection = document.getElementById(\"results-section\");\n\n  const html = `\n    <div class=\"contract-results\">\n      <h3> Contract Generated Successfully</h3>\n      <div class=\"contract-info\">\n        <p><strong>Contract Type:</strong> ${result.metadata?.template_used || 'Content Management Agreement'}</p>\n        <p><strong>Generated:</strong> ${new Date(result.metadata?.generated_at || new Date()).toLocaleString()}</p>\n        <p><strong>Status:</strong> <span class=\"status-success\">Ready for Review</span></p>\n      </div>\n      \n      <div class=\"contract-actions\">\n        <button id=\"review-contract-btn\" class=\"primary-button\" onclick=\"reviewGeneratedContract()\">\n           Review Contract\n        </button>\n        <button id=\"analyze-new-contract-btn\" class=\"secondary-button\" onclick=\"analyzeContract()\">\n           Analyze Generated Contract\n        </button>\n      </div>\n      \n      <div class=\"next-steps\">\n        <h4>Next Steps:</h4>\n        <ul>\n          <li>Review the generated contract content</li>\n          <li>Run contract analysis to check for risks</li>\n          <li>Make any necessary modifications</li>\n          <li>Save and share with relevant parties</li>\n        </ul>\n      </div>\n    </div>`;\n\n  resultsContent.innerHTML = html;\n  resultsSection.style.display = \"block\";\n}\n","// Event Handlers Module\nimport { APIService } from '../../shared/api-service.js';\nimport { API_CONFIG } from '../../shared/config.js';\nimport { updateStatus, showProgressSection, hideProgressSection, handleError, setButtonLoading, clearResults, clearSuggestions } from '../../shared/utils.js';\nimport { generateDemoAnalysis, generateRiskAnalysis, generateChangeSuggestions } from '../services/contract-analyzer.js';\nimport { handleAgreementTypeChange, handleContentTypeChange, collectFormData, validateFormData, updateContractPreview } from '../services/contract-generator.js';\nimport { displayCombinedAnalysisResults, displayContractResults } from './ui-display.js';\n\n// Initialize API service\nconst apiService = new APIService(API_CONFIG);\n\n// Contract Generation Event Handlers\nexport async function generateContract() {\n  setButtonLoading(\"generate-contract-btn\", true);\n  showProgressSection(\"Generating contract...\");\n  updateStatus(\"Preparing contract generation...\", \"info\");\n\n  try {\n    // Collect and validate form data\n    const formData = collectFormData();\n    \n    if (!validateFormData(formData)) {\n      throw new Error(\"Please fill in all required fields\");\n    }\n\n    updateStatus(\"Generating contract content...\", \"info\");\n\n    // Generate contract using API service\n    const result = await apiService.generateContract(formData);\n\n    // Insert contract into Word document\n    await insertContractIntoDocument(result, formData);\n\n    // Display results\n    displayContractResults(result);\n    \n    updateStatus(\"Contract generated successfully!\", \"success\");\n    hideProgressSection();\n\n  } catch (error) {\n    handleError(error);\n  } finally {\n    setButtonLoading(\"generate-contract-btn\", false);\n  }\n}\n\n// Contract Analysis Event Handlers\nexport async function analyzeContract() {\n  setButtonLoading(\"analyze-contract-btn\", true);\n  showProgressSection(\"Analyzing contract...\");\n  updateStatus(\"Reading document content...\", \"info\");\n\n  try {\n    // Get document text\n    const documentText = await getDocumentText();\n    \n    if (!documentText || documentText.trim().length < 50) {\n      throw new Error(\"Document appears to be empty or too short to analyze. Please ensure you have contract content in the document.\");\n    }\n\n    updateStatus(\"Performing contract analysis...\", \"info\");\n\n    // Perform comprehensive analysis\n    const [analysisResult, riskAnalysis, changeSuggestions] = await Promise.all([\n      generateDemoAnalysis(documentText),\n      generateRiskAnalysis(documentText),\n      generateChangeSuggestions(documentText)\n    ]);\n\n    // Generate executive summary\n    const summaryResult = generateExecutiveSummary(analysisResult, riskAnalysis, changeSuggestions);\n\n    updateStatus(\"Analysis complete!\", \"success\");\n\n    // Display combined results\n    displayCombinedAnalysisResults(analysisResult, riskAnalysis, changeSuggestions, summaryResult);\n    \n    hideProgressSection();\n\n  } catch (error) {\n    handleError(error);\n  } finally {\n    setButtonLoading(\"analyze-contract-btn\", false);\n  }\n}\n\n// Suggestion Application Event Handlers\nexport async function applySuggestion(suggestionIndex) {\n  updateStatus(`Applying suggestion ${suggestionIndex + 1}...`, \"info\");\n  \n  try {\n    // In a real implementation, this would apply the specific suggestion to the document\n    // For demo purposes, we'll just show a success message\n    await new Promise(resolve => setTimeout(resolve, 1000)); // Simulate processing\n    \n    updateStatus(`Suggestion ${suggestionIndex + 1} applied successfully!`, \"success\");\n    \n    // Update the UI to show the suggestion as applied\n    const suggestionCard = document.querySelectorAll('.suggestion-card')[suggestionIndex];\n    if (suggestionCard) {\n      suggestionCard.classList.add('applied');\n      const applyBtn = suggestionCard.querySelector('.apply-suggestion-btn');\n      if (applyBtn) {\n        applyBtn.textContent = ' Applied';\n        applyBtn.disabled = true;\n      }\n    }\n    \n  } catch (error) {\n    handleError(error);\n  }\n}\n\nexport async function applyAllChanges() {\n  setButtonLoading(\"apply-all-changes-btn\", true);\n  updateStatus(\"Applying all suggestions...\", \"info\");\n  \n  try {\n    // In a real implementation, this would apply all suggestions to the document\n    await new Promise(resolve => setTimeout(resolve, 2000)); // Simulate processing\n    \n    updateStatus(\"All suggestions applied successfully!\", \"success\");\n    \n    // Update UI to show all suggestions as applied\n    const suggestionCards = document.querySelectorAll('.suggestion-card');\n    suggestionCards.forEach(card => {\n      card.classList.add('applied');\n      const applyBtn = card.querySelector('.apply-suggestion-btn');\n      if (applyBtn) {\n        applyBtn.textContent = ' Applied';\n        applyBtn.disabled = true;\n      }\n    });\n    \n    // Hide the apply all button\n    document.getElementById(\"apply-all-changes-btn\").style.display = 'none';\n    \n  } catch (error) {\n    handleError(error);\n  } finally {\n    setButtonLoading(\"apply-all-changes-btn\", false);\n  }\n}\n\nexport function dismissSuggestions() {\n  clearSuggestions();\n  updateStatus(\"Suggestions dismissed\", \"info\");\n}\n\n// Utility Functions\nasync function getDocumentText() {\n  // Ensure Word API is available\n  if (typeof Word === 'undefined') {\n    throw new Error('Word API not available. Please ensure you are running this add-in in Microsoft Word.');\n  }\n\n  // Additional check for Office.js initialization\n  if (!Office.context || !Office.context.document) {\n    throw new Error('Office.js not properly initialized. Please refresh the add-in.');\n  }\n\n  return await Word.run(async (context) => {\n    const body = context.document.body;\n    body.load(\"text\");\n    await context.sync();\n    return body.text;\n  });\n}\n\nasync function insertContractIntoDocument(result, formData) {\n  // Ensure Word API is available\n  if (typeof Word === 'undefined') {\n    throw new Error('Word API not available. Please ensure you are running this add-in in Microsoft Word.');\n  }\n\n  // Additional check for Office.js initialization\n  if (!Office.context || !Office.context.document) {\n    throw new Error('Office.js not properly initialized. Please refresh the add-in.');\n  }\n\n  return await Word.run(async (context) => {\n    const body = context.document.body;\n    \n    // Clear existing content\n    body.clear();\n    \n    // Generate contract content based on form data\n    const contractContent = generateContractContent(formData);\n    \n    // Insert the contract\n    body.insertText(contractContent, Word.InsertLocation.start);\n    \n    // Apply formatting\n    const range = body.getRange();\n    range.font.name = \"Calibri\";\n    range.font.size = 11;\n    \n    await context.sync();\n  });\n}\n\nfunction generateContractContent(formData) {\n  // Generate realistic contract content based on form data\n  const templates = {\n    'content-management': {\n      'music': `MUSIC CONTENT MANAGEMENT AGREEMENT\n\nThis Music Content Management Agreement (\"Agreement\") is entered into on ${new Date().toLocaleDateString()} between ${formData.fields.entity_name || 'Starling Music Management LLC'}, a limited liability company (\"Manager\"), and ${formData.fields.content_creator || 'Artist Name'} (\"Artist\").\n\n1. SCOPE OF SERVICES\nManager agrees to provide comprehensive music content management services including:\n- Digital distribution across all major streaming platforms (Spotify, Apple Music, Amazon Music, etc.)\n- Rights management and royalty collection\n- Marketing and promotional campaigns\n- Performance tracking and analytics\n- Playlist pitching and promotion\n\n2. REVENUE SHARING\nArtist and Manager agree to the following revenue split:\n- Artist: ${100 - (formData.fields.revenue_split || 20)}%\n- Manager: ${formData.fields.revenue_split || 20}%\n\n3. TERM AND TERRITORY\nThis Agreement shall remain in effect for ${formData.fields.term_length || '3 years'} and covers ${formData.fields.territory || 'Worldwide'}.\n\n4. RIGHTS GRANTED\nArtist grants Manager the right to manage ${formData.fields.music_rights || 'Master Rights'} for the specified territory and term.\n\n5. ADVANCE\n${formData.fields.advance_amount ? `Manager will provide an advance of $${formData.fields.advance_amount} upon execution of this Agreement.` : 'No advance payment is included in this Agreement.'}\n\n6. TERMINATION\nEither party may terminate this Agreement with ${formData.fields.termination_notice || '60'} days written notice.\n\n7. GOVERNING LAW\nThis Agreement shall be governed by the laws of the State of California.\n\nIN WITNESS WHEREOF, the parties have executed this Agreement as of the date first written above.\n\nMANAGER:                           ARTIST:\n\n_________________________         _________________________\n${formData.fields.entity_name || 'Starling Music Management LLC'}    ${formData.fields.content_creator || 'Artist Name'}\n\nDate: _______________             Date: _______________`,\n\n      'non-music': `CONTENT MANAGEMENT AGREEMENT\n\nThis Content Management Agreement (\"Agreement\") is entered into on ${new Date().toLocaleDateString()} between ${formData.fields.entity_name || 'Digital Content Partners'} (\"Manager\") and ${formData.fields.content_creator || 'Content Creator'} (\"Creator\").\n\n1. CONTENT MANAGEMENT SERVICES\nManager will provide comprehensive content management including:\n- ${formData.fields.content_type || 'Video Content'} optimization and strategy\n- Platform management for ${formData.fields.platform_focus || 'YouTube'}\n- Brand partnership facilitation\n- Revenue optimization and analytics\n- Content scheduling and distribution\n\n2. COMPENSATION\nRevenue sharing arrangement:\n- Creator: ${100 - (formData.fields.revenue_split || 25)}%\n- Manager: ${formData.fields.revenue_split || 25}%\n\n3. TERM AND SCOPE\nDuration: ${formData.fields.term_length || '2 years'}\nTerritory: ${formData.fields.territory || 'North America'}\n\n4. CONTENT RIGHTS\nCreator grants Manager limited rights to manage and distribute content on agreed platforms.\n\n5. TERMINATION\nEither party may terminate with ${formData.fields.termination_notice || '30'} days written notice.\n\n6. GOVERNING LAW\nThis Agreement is governed by applicable state and federal laws.\n\nSIGNATURES:\n\nMANAGER:                           CREATOR:\n\n_________________________         _________________________\n${formData.fields.entity_name || 'Digital Content Partners'}      ${formData.fields.content_creator || 'Content Creator'}\n\nDate: _______________             Date: _______________`\n    }\n  };\n\n  const template = templates[formData.agreement_type]?.[formData.content_type];\n  return template || 'Contract content would be generated here based on your selections.';\n}\n\nfunction generateExecutiveSummary(analysisResult, riskAnalysis, changeSuggestions) {\n  const riskLevel = riskAnalysis.risk_score >= 80 ? 'Low' : \n                   riskAnalysis.risk_score >= 60 ? 'Medium' : 'High';\n  \n  return {\n    title: \" Executive Summary\",\n    overview: `This ${analysisResult.contract_type.toLowerCase()} has been analyzed for compliance, risks, and improvement opportunities. The contract shows a ${riskLevel.toLowerCase()} risk profile with ${riskAnalysis.risks.length} identified areas for attention and ${changeSuggestions.suggestions.length} improvement suggestions.`\n  };\n}\n\n// Export form change handlers\nexport { handleAgreementTypeChange, handleContentTypeChange };\n\n// Export utility functions for global access\nwindow.generateContract = generateContract;\nwindow.analyzeContract = analyzeContract;\nwindow.applySuggestion = applySuggestion;\nwindow.applyAllChanges = applyAllChanges;\nwindow.dismissSuggestions = dismissSuggestions;\nwindow.clearResults = clearResults;\nwindow.clearSuggestions = clearSuggestions;\nwindow.handleAgreementTypeChange = handleAgreementTypeChange;\nwindow.handleContentTypeChange = handleContentTypeChange;\n","// Application Configuration\n\n// API Configuration\nexport const API_CONFIG = {\n  USE_REAL_API: false, // Toggle between real API and demo mode\n  baseUrl: \"https://api.starling-ai.com/v1\",\n  demoMode: true,\n  endpoints: {\n    analyze: \"/analyze-contract\",\n    generate: \"/generate-contract\",\n    suggestions: \"/suggest-changes\"\n  },\n  headers: {\n    'Content-Type': 'application/json',\n    'Accept': 'application/json'\n  }\n};\n\n// Demo Data Configuration\nexport const DEMO_CONFIG = {\n  // Contract templates for generation\n  contractTemplates: {\n    'content-management': {\n      'music': {\n        title: 'Music Content Management Agreement',\n        baseContent: `MUSIC CONTENT MANAGEMENT AGREEMENT\n\nThis Music Content Management Agreement (\"Agreement\") is entered into on [DATE] between [ENTITY_NAME], a limited liability company (\"Manager\"), and [CONTENT_CREATOR] (\"Artist\").\n\n1. SCOPE OF SERVICES\nManager agrees to provide comprehensive music content management services including:\n- Digital distribution across all major streaming platforms\n- Rights management and royalty collection\n- Marketing and promotional campaigns\n- Performance tracking and analytics\n\n2. REVENUE SHARING\nArtist and Manager agree to the following revenue split:\n- Artist: [ARTIST_PERCENTAGE]%\n- Manager: [MANAGER_PERCENTAGE]%\n\n3. TERM AND TERRITORY\nThis Agreement shall remain in effect for [TERM_LENGTH] and covers [TERRITORY].\n\n4. RIGHTS GRANTED\nArtist grants Manager the right to manage [MUSIC_RIGHTS] for the specified territory and term.\n\n5. TERMINATION\nEither party may terminate this Agreement with [TERMINATION_NOTICE] days written notice.\n\nIN WITNESS WHEREOF, the parties have executed this Agreement as of the date first written above.\n\n[SIGNATURE BLOCKS]`\n      },\n      'non-music': {\n        title: 'Content Management Agreement',\n        baseContent: `CONTENT MANAGEMENT AGREEMENT\n\nThis Content Management Agreement (\"Agreement\") is entered into on [DATE] between [ENTITY_NAME] (\"Manager\") and [CONTENT_CREATOR] (\"Creator\").\n\n1. CONTENT MANAGEMENT SERVICES\nManager will provide comprehensive content management including:\n- [CONTENT_TYPE] optimization and strategy\n- Platform management for [PLATFORM_FOCUS]\n- Brand partnership facilitation\n- Revenue optimization and analytics\n\n2. COMPENSATION\nRevenue sharing: Creator [CREATOR_PERCENTAGE]%, Manager [MANAGER_PERCENTAGE]%\n\n3. TERM AND SCOPE\nDuration: [TERM_LENGTH]\nTerritory: [TERRITORY]\n\n4. TERMINATION\n[TERMINATION_NOTICE] days written notice required.\n\n[SIGNATURE BLOCKS]`\n      }\n    }\n  },\n\n  // Analysis response templates\n  analysisTemplates: {\n    risks: [\n      {\n        severity: 'high',\n        category: 'Missing Clause',\n        title: 'No Termination Clause',\n        description: 'Contract lacks clear termination conditions.',\n        suggestion: 'Add comprehensive termination clause with notice periods.'\n      },\n      {\n        severity: 'medium',\n        category: 'Legal Risk',\n        title: 'Liability Limitations',\n        description: 'Consider adding liability limitation clauses.',\n        suggestion: 'Include mutual liability caps and indemnification.'\n      }\n    ],\n    suggestions: [\n      {\n        type: 'Language Improvement',\n        priority: 'medium',\n        title: 'Clarify Payment Terms',\n        current: 'Payment terms are vague',\n        suggested: 'Specify exact payment schedules and methods',\n        benefit: 'Reduces payment disputes and improves cash flow'\n      }\n    ]\n  }\n};\n\n// UI Configuration\nexport const UI_CONFIG = {\n  animations: {\n    fadeInDuration: 300,\n    slideInDuration: 400,\n    progressUpdateInterval: 200\n  },\n  \n  themes: {\n    default: 'office-light',\n    supported: ['office-light', 'office-dark', 'office-colorful']\n  },\n  \n  validation: {\n    maxContractLength: 50000, // characters\n    minContractLength: 100,   // characters\n    requiredFields: ['agreement-type', 'content-type']\n  }\n};\n\n// Feature Flags\nexport const FEATURES = {\n  trackChanges: true,\n  realTimeAnalysis: false,\n  advancedSuggestions: true,\n  contractGeneration: true,\n  riskAnalysis: true\n};\n","// RHEI AI Legal Assistant - Main Taskpane Module\n// Modular architecture for better maintainability\n\n// Import all modules and services\nimport { initializeTheme, updateStatus, clearResults, clearSuggestions, handleError } from '../shared/utils.js';\nimport { \n  generateContract, \n  analyzeContract, \n  handleAgreementTypeChange, \n  handleContentTypeChange \n} from './modules/event-handlers.js';\n\n// Initialize the add-in\nOffice.onReady((info) => {\n  if (info.host === Office.HostApplication.Word) {\n    console.log(\"RHEI AI Legal Assistant loaded successfully\");\n\n    // Check if Word API is available\n    if (typeof Word === 'undefined') {\n      console.error(\"Word API not available\");\n      updateStatus(\"Error: Word API not available. Please refresh the add-in.\", \"error\");\n      return;\n    }\n\n    console.log(\"Word API is available\");\n\n    // Initialize theme\n    initializeTheme();\n\n    // Set up event listeners\n    setupEventListeners();\n\n    // Initialize UI state\n    initializeUI();\n\n    console.log(\"Add-in initialization complete\");\n  } else {\n    console.error(\"This add-in is designed for Microsoft Word only\");\n    updateStatus(\"Error: This add-in requires Microsoft Word\", \"error\");\n  }\n});\n\n// Set up all event listeners\nfunction setupEventListeners() {\n  // Contract generation events\n  const generateBtn = document.getElementById(\"generate-contract\");\n  if (generateBtn) {\n    generateBtn.addEventListener(\"click\", generateContract);\n  }\n\n  // Contract analysis events\n  const analyzeBtn = document.getElementById(\"analyze-contract\");\n  if (analyzeBtn) {\n    analyzeBtn.addEventListener(\"click\", analyzeContract);\n  }\n\n  // Form change events\n  const agreementTypeSelect = document.getElementById(\"agreement-type\");\n  if (agreementTypeSelect) {\n    agreementTypeSelect.addEventListener(\"change\", handleAgreementTypeChange);\n  }\n\n  const contentTypeSelect = document.getElementById(\"content-type\");\n  if (contentTypeSelect) {\n    contentTypeSelect.addEventListener(\"change\", handleContentTypeChange);\n  }\n\n  // Clear buttons\n  const clearResultsBtn = document.getElementById(\"clear-results\");\n  if (clearResultsBtn) {\n    clearResultsBtn.addEventListener(\"click\", clearResults);\n  }\n\n  const clearSuggestionsBtn = document.getElementById(\"clear-suggestions\");\n  if (clearSuggestionsBtn) {\n    clearSuggestionsBtn.addEventListener(\"click\", clearSuggestions);\n  }\n\n  // Additional feature buttons\n  const toggleTrackChangesBtn = document.getElementById(\"toggle-track-changes\");\n  if (toggleTrackChangesBtn) {\n    toggleTrackChangesBtn.addEventListener(\"click\", toggleTrackChanges);\n  }\n\n  const highlightRisksBtn = document.getElementById(\"highlight-risks\");\n  if (highlightRisksBtn) {\n    highlightRisksBtn.addEventListener(\"click\", highlightRisks);\n  }\n\n  const checkComplianceBtn = document.getElementById(\"check-compliance\");\n  if (checkComplianceBtn) {\n    checkComplianceBtn.addEventListener(\"click\", checkCompliance);\n  }\n\n  const suggestChangesBtn = document.getElementById(\"suggest-changes\");\n  if (suggestChangesBtn) {\n    suggestChangesBtn.addEventListener(\"click\", suggestChanges);\n  }\n\n  console.log(\"Event listeners set up successfully\");\n}\n\n// Initialize UI state\nfunction initializeUI() {\n  // Hide dynamic sections initially\n  const dynamicForm = document.getElementById(\"dynamic-form\");\n  const generateButtonGroup = document.getElementById(\"generate-button-group\");\n  const contentTypeGroup = document.getElementById(\"content-type-group\");\n  const resultsSection = document.getElementById(\"results-section\");\n  const suggestionsSection = document.getElementById(\"suggestions-section\");\n  const progressSection = document.getElementById(\"progress-section\");\n\n  if (dynamicForm) dynamicForm.style.display = \"none\";\n  if (generateButtonGroup) generateButtonGroup.style.display = \"none\";\n  if (contentTypeGroup) contentTypeGroup.style.display = \"none\";\n  if (resultsSection) resultsSection.style.display = \"none\";\n  if (suggestionsSection) suggestionsSection.style.display = \"none\";\n  if (progressSection) progressSection.style.display = \"none\";\n\n  // Set initial status\n  updateStatus(\"Ready to generate or analyze contracts\", \"info\");\n\n  console.log(\"UI initialized successfully\");\n}\n\n// Global error handler\nwindow.addEventListener('error', (event) => {\n  console.error('Global error:', event.error);\n  handleError(event.error);\n});\n\n// Global unhandled promise rejection handler\nwindow.addEventListener('unhandledrejection', (event) => {\n  console.error('Unhandled promise rejection:', event.reason);\n  handleError(event.reason);\n});\n\n// Placeholder functions for additional features\nfunction toggleTrackChanges() {\n  updateStatus(\"Toggling track changes...\", \"info\");\n  // Implementation will be added later\n}\n\nfunction highlightRisks() {\n  updateStatus(\"Highlighting risks...\", \"info\");\n  // Implementation will be added later\n}\n\nfunction checkCompliance() {\n  updateStatus(\"Checking compliance...\", \"info\");\n  // Implementation will be added later\n}\n\nfunction suggestChanges() {\n  updateStatus(\"Applying suggested changes...\", \"info\");\n  // Implementation will be added later\n}\n\nconsole.log(\"RHEI AI Legal Assistant module loaded\");\n"],"names":["setButtonLoading","buttonId","isLoading","button","document","getElementById","classList","add","disabled","remove","updateStatus","message","type","arguments","length","undefined","statusElement","textContent","className","concat","setTimeout","showProgressSection","progressBar","progress","interval","style","display","setInterval","Math","random","width","clearInterval","hideProgressSection","handleError","error","console","errorMessage","clearResults","resultsSection","resultsContent","innerHTML","clearSuggestions","suggestionsSection","suggestionsContent","_regeneratorRuntime","r","t","e","Object","prototype","n","hasOwnProperty","o","Symbol","i","iterator","a","asyncIterator","u","toStringTag","c","defineProperty","value","enumerable","configurable","writable","h","Generator","create","Error","done","method","arg","delegate","d","f","sent","_sent","dispatchException","abrupt","s","Context","call","wrap","GeneratorFunction","GeneratorFunctionPrototype","l","p","getPrototypeOf","y","x","v","g","forEach","_invoke","AsyncIterator","_typeof","resolve","__await","then","return","TypeError","next","w","tryEntries","push","m","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","unshift","pop","values","prev","charAt","slice","stop","rval","complete","finish","catch","delegateYield","ownKeys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","apply","_objectSpread","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","asyncGeneratorStep","_asyncToGenerator","_next","_throw","_defineProperties","key","toPrimitive","String","_toPrimitive","APIService","config","_classCallCheck","this","_makeRequest","_callee","endpoint","options","url","requestOptions","response","_args","_context","USE_REAL_API","log","getMockResponse","baseUrl","headers","body","JSON","stringify","fetch","ok","status","statusText","json","t0","_x","includes","getMockAnalysisResponse","getMockGenerationResponse","timestamp","Date","toISOString","requestData","contract_type","compliance_score","summary","risks","severity","description","key_terms","recommendations","contract_text","metadata","template_used","agreement_type","generated_at","_analyzeContract","_callee2","documentText","_context2","makeRequest","document_text","analysis_type","_x2","_generateContract","_callee3","formData","_context3","_x3","_checkHealth","_callee4","_context4","generateDemoAnalysis","_generateDemoAnalysis","_callee5","wordCount","hasSignatureLines","hasParties","hasTermination","hasCompensation","contractType","complianceScore","contractStructure","_context5","split","toLowerCase","parseContractStructureWithChanges","word_count","min","text","terms","lowerText","generateRecommendations","contract_structure","riskCount","hasSignatures","generateRiskAnalysis","category","title","location","suggestion","total_risks","risk_score","calculateRiskScore","score","risk","max","generateChangeSuggestions","suggestions","priority","current","suggested","benefit","total_suggestions","FORM_TEMPLATES","label","required","handleAgreementTypeChange","agreementType","contentTypeGroup","dynamicForm","generateButtonGroup","handleContentTypeChange","contentType","_FORM_TEMPLATES$agree","template","formHTML","field","requiredClass","requiredAttr","option","inputType","generateDynamicForm","displayCombinedAnalysisResults","analysisResult","riskAnalysis","changeSuggestions","summaryResult","structure","modifiedClauses","articles","reduce","count","article","clauses","clause","_clause$changeStatus","changeStatus","isModified","totalClauses","html","number","_clause$changeStatus2","_clause$changeStatus3","statusClass","statusColor","substring","trackChanges","enabled","note","demoMode","overview","severityClass","toUpperCase","priorityClass","term","rec","index","showSuggestionsSection","displayContractResults","result","_result$metadata","_result$metadata2","toLocaleString","apiService","endpoints","analyze","generate","generateContract","demoVariations","content_type","fields","entity_name","content_creator","scope_description","revenue_split","term_length","territory","music_rights","advance_amount","termination_notice","platform_focus","license_fee","floor","insertContractIntoDocument","analyzeContract","_yield$Promise$all","_yield$Promise$all2","getDocumentText","trim","all","generateExecutiveSummary","_applySuggestion","suggestionIndex","suggestionCard","applyBtn","querySelectorAll","querySelector","_applyAllChanges","card","_getDocumentText","_callee6","_context6","Word","Office","context","run","_ref","load","sync","_x4","_insertContractIntoDocument","_callee8","_context8","_ref2","_callee7","contractContent","range","_context7","clear","generateContractContent","insertText","InsertLocation","start","getRange","font","size","_x5","_templates$formData$a","toLocaleDateString","riskLevel","toggleTrackChanges","highlightRisks","checkCompliance","suggestChanges","window","applySuggestion","applyAllChanges","dismissSuggestions","onReady","info","host","HostApplication","officeTheme","theme","bodyBackgroundColor","initializeTheme","generateBtn","addEventListener","analyzeBtn","agreementTypeSelect","contentTypeSelect","clearResultsBtn","clearSuggestionsBtn","toggleTrackChangesBtn","highlightRisksBtn","checkComplianceBtn","suggestChangesBtn","setupEventListeners","progressSection","event","reason"],"sourceRoot":""}