/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";function e(e,t){var n=document.getElementById(e);t?(n.classList.add("loading"),n.disabled=!0):(n.classList.remove("loading"),n.disabled=!1)}function t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.getElementById("status-message");n.textContent=e,n.className="status-message ms-font-s ".concat(t," slide-in"),"success"===t&&(n.classList.add("success-animation"),setTimeout((function(){n.classList.remove("success-animation")}),600))}function n(e){var t,n,r;document.getElementById("progress-section").style.display="block",document.getElementById("progress-text").textContent=e,t=document.getElementById("progress-bar"),n=0,r=setInterval((function(){(n+=15*Math.random())>90&&(n=90),t.style.width=n+"%",n>=90&&clearInterval(r)}),200)}function r(){document.getElementById("progress-section").style.display="none"}function i(e){console.error("Error:",e);var n="An error occurred";e.message?n=e.message:"string"==typeof e&&(n=e),t(n,"error"),r()}function a(){var e=document.getElementById("results-section"),n=document.getElementById("results-content");e.style.display="none",n.innerHTML="",t("Results cleared","info")}function o(){var e=document.getElementById("suggestions-section"),n=document.getElementById("suggestions-content");e.style.display="none",n.innerHTML="",t("Suggestions cleared","info")}var s={contractReview:{systemPrompt:"You are an expert legal AI specialized in contract analysis. Given:\n\nAn active Microsoft Word document containing a commercial or legal contract.\n\nA predefined company standard clauses database (\"Standard Library\") with negotiable and non-negotiable terms clearly marked.\n\nPerform the following tasks step-by-step:\n\nContract Analysis:\n- Identify and extract all Articles and Clauses from the active Word document.\n- Clearly segment the contract into distinct clauses or sections.\n- Use numbers to define each article and clause (e.g. the first article of the first clause would be 1.1, the first sub-clause would be 1.1.1. The second article would be 2, while the first clause of article 2 would be 2.1, and so on)\n\nClause Comparison:\n- Compare each extracted clause against the corresponding clause from the Standard Library.\n- Highlight deviations clearly using Word's Track Changes feature.\n\nDeviation Summary:\n- Provide a concise summary detailing each deviation from the Standard Library.\n- Classify deviations into negotiable (flexible) and non-negotiable (must adhere strictly to the standard).\n\nImprovement Recommendations:\n- Suggest precise language revisions for clauses identified as negotiable to optimize the company's position.\n- For non-negotiable clauses, recommend specific edits that restore compliance with the Standard Library.\n- Quantify risks on current clauses and provide reasons for why the updated clause would be best.\n\nOutput Format:\n- Generate the tracked-changes directly within the Word document.\n- Provide a structured textual summary including:\n  * Clause reference (number/title)\n  * Brief description of the deviation\n  * Negotiable/non-negotiable status\n  * Recommended language improvements or restorations\n\nEnsure the analysis is thorough, professional, and actionable. Maintain accuracy and clarity in recommendations, prioritizing the company's legal and commercial interests. The recommendations must align with best legal practices and strategic objectives defined in the Standard Library.",userPromptTemplate:"Please analyze the following contract document:\n\nCONTRACT TEXT:\n{documentText}\n\nCONTRACT TYPE: {contractType}\n\nPlease provide a comprehensive analysis following the system instructions above, with particular attention to:\n1. Article and clause numbering (1, 1.1, 1.1.1, 2, 2.1, etc.)\n2. Deviation classification (negotiable vs non-negotiable)\n3. Risk quantification for each clause\n4. Specific language recommendations\n\nReturn the analysis in the structured format specified."},riskAssessment:{systemPrompt:"You are a legal risk assessment specialist. Analyze contracts for potential legal, financial, and operational risks.",userPromptTemplate:"Assess the risks in this contract:\n\n{documentText}\n\nFocus on:\n- Legal compliance risks\n- Financial exposure\n- Operational constraints\n- Termination risks\n- Liability issues\n\nProvide risk severity (high/medium/low) and mitigation strategies."},clauseImprovement:{systemPrompt:"You are a contract optimization expert. Suggest improvements to contract language that protect the company's interests while maintaining enforceability.",userPromptTemplate:"Improve the following contract clauses:\n\n{documentText}\n\nFor each clause, provide:\n- Current language assessment\n- Improved language suggestion\n- Business benefit explanation\n- Legal rationale"}};function c(){c=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n,r){Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function d(t,n,r,i){var a=n&&n.prototype instanceof g?n:g,o=Object.create(a.prototype);return u(o,"_invoke",function(t,n,r){var i=1;return function(a,o){if(3===i)throw Error("Generator is already running");if(4===i){if("throw"===a)throw o;return{value:e,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var c=k(s,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===i)throw i=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=3;var l=p(t,n,r);if("normal"===l.type){if(i=r.done?4:2,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=4,r.method="throw",r.arg=l.arg)}}}(t,r,new S(i||[])),!0),o}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var m={};function g(){}function f(){}function h(){}var y={};u(y,a,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(A([])));b&&b!==n&&r.call(b,a)&&(y=b);var _=h.prototype=g.prototype=Object.create(y);function w(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(i,a,o,s){var c=p(e[i],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==l(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(d).then((function(e){u.value=e,o(u)}),(function(e){return n("throw",e,o,s)}))}s(c.arg)}var i;u(this,"_invoke",(function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}),!0)}function k(t,n){var r=n.method,i=t.i[r];if(i===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var a=p(i,t.i,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var o=a.arg;return o?o.done?(n[t.r]=o.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function C(e){this.tryEntries.push(e)}function x(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function S(e){this.tryEntries=[[-1]],e.forEach(C,this),this.reset(!0)}function A(t){if(null!=t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(l(t)+" is not iterable")}return f.prototype=h,u(_,"constructor",h),u(h,"constructor",f),u(h,s,f.displayName="GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,u(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},w(E.prototype),u(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new E(d(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(_),u(_,s,"Generator"),u(_,a,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=A,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(x),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){o.type="throw",o.arg=t,n.next=e}for(var i=n.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a[4],s=this.prev,c=a[1],l=a[2];if(-1===a[0])return r("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<l)return r(l),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var i=r;break}}i&&("break"===e||"continue"===e)&&i[0]<=t&&t<=i[2]&&(i=null);var a=i?i[4]:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i[2],m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),x(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var i=r.arg;x(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:A(t),r:n,n:r},"next"===this.method&&(this.arg=e),m}},t}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){m(a,r,i,o,s,"next",e)}function s(e){m(a,r,i,o,s,"throw",e)}o(void 0)}))}}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}var y=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t},t=[{key:"makeRequest",value:(r=g(c().mark((function e(t){var n,r,i,a,o=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]?o[1]:{},this.config.USE_REAL_API){e.next=4;break}return console.log("[DEMO MODE] Would call API: ".concat(t),n),e.abrupt("return",this.getMockResponse(t,n));case 4:return r="".concat(this.config.baseUrl).concat(t),i=d({method:n.method||"GET",headers:d(d({},this.config.headers),n.headers)},n),n.body&&"object"===l(n.body)&&(i.body=JSON.stringify(n.body)),e.prev=7,e.next=10,fetch(r,i);case 10:if((a=e.sent).ok){e.next=13;break}throw new Error("API Error: ".concat(a.status," ").concat(a.statusText));case 13:return e.next=15,a.json();case 15:return e.abrupt("return",e.sent);case 18:throw e.prev=18,e.t0=e.catch(7),console.error("API Request failed:",e.t0),e.t0;case 22:case"end":return e.stop()}}),e,this,[[7,18]])}))),function(e){return r.apply(this,arguments)})},{key:"getMockResponse",value:function(e,t){return e.includes("/analyze")?this.getMockAnalysisResponse(t.body):e.includes("/generate")?this.getMockGenerationResponse(t.body):e.includes("/health")?{status:"healthy",timestamp:(new Date).toISOString()}:{message:"Mock response",endpoint:e,options:t}}},{key:"getMockAnalysisResponse",value:function(e){return{contract_type:"Content Management Agreement",compliance_score:85,summary:"This contract appears well-structured with standard clauses.",risks:[{severity:"medium",description:"Consider adding force majeure clause"},{severity:"low",description:"Termination notice period could be more specific"}],key_terms:["Payment Terms","Geographic Scope","Rights Management"],recommendations:["Consider legal review before execution","Ensure all parties review terms carefully"]}}},{key:"getMockGenerationResponse",value:function(e){return{contract_text:"Generated contract content would be here...",metadata:{template_used:(null==e?void 0:e.agreement_type)||"content-management",generated_at:(new Date).toISOString()}}}},{key:"analyzeContract",value:function(){var e=g(c().mark((function e(t){var n,r,i=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"general",r=s.contractReview.userPromptTemplate.replace("{documentText}",t).replace("{contractType}",n),e.abrupt("return",this.makeRequest("/contracts/analyze",{method:"POST",body:{document_text:t,contract_type:n,analysis_type:"comprehensive",ai_prompt:{system_prompt:s.contractReview.systemPrompt,user_prompt:r},requirements:{article_numbering:!0,deviation_classification:!0,risk_quantification:!0,track_changes:!0}}}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"generateContract",value:function(){var e=g(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.makeRequest("/contracts/generate",{method:"POST",body:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkHealth",value:(n=g(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.makeRequest("/health"));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}],t&&f(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function b(){b=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n,r){Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(t,n,r,i){var a=n&&n.prototype instanceof p?n:p,o=Object.create(a.prototype);return c(o,"_invoke",function(t,n,r){var i=1;return function(a,o){if(3===i)throw Error("Generator is already running");if(4===i){if("throw"===a)throw o;return{value:e,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var c=k(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===i)throw i=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=3;var l=u(t,n,r);if("normal"===l.type){if(i=r.done?4:2,l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=4,r.method="throw",r.arg=l.arg)}}}(t,r,new S(i||[])),!0),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var d={};function p(){}function m(){}function g(){}var f={};c(f,a,(function(){return this}));var h=Object.getPrototypeOf,y=h&&h(h(A([])));y&&y!==n&&r.call(y,a)&&(f=y);var _=g.prototype=p.prototype=Object.create(f);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(i,a,o,s){var c=u(e[i],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==v(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(d).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}))}s(c.arg)}var i;c(this,"_invoke",(function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}),!0)}function k(t,n){var r=n.method,i=t.i[r];if(i===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var a=u(i,t.i,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,d;var o=a.arg;return o?o.done?(n[t.r]=o.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function C(e){this.tryEntries.push(e)}function x(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function S(e){this.tryEntries=[[-1]],e.forEach(C,this),this.reset(!0)}function A(t){if(null!=t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(v(t)+" is not iterable")}return m.prototype=g,c(_,"constructor",g),c(g,"constructor",m),c(g,s,m.displayName="GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},w(E.prototype),c(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new E(l(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(_),c(_,s,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=A,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(x),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){o.type="throw",o.arg=t,n.next=e}for(var i=n.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a[4],s=this.prev,c=a[1],l=a[2];if(-1===a[0])return r("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<l)return r(l),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var i=r;break}}i&&("break"===e||"continue"===e)&&i[0]<=t&&t<=i[2]&&(i=null);var a=i?i[4]:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i[2],d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),x(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var i=r.arg;x(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:A(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function _(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function k(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){E(a,r,i,o,s,"next",e)}function s(e){E(a,r,i,o,s,"throw",e)}o(void 0)}))}}function C(e){return x.apply(this,arguments)}function x(){return(x=k(b().mark((function e(t){var n,r,i,a,o,c,l,u,d;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Generating analysis using new AI prompt structure..."),n=t.split(/\s+/).length,r=t.includes("_______")||t.includes("DATE:"),i=t.toLowerCase().includes("party")||t.toLowerCase().includes("agreement"),a=t.toLowerCase().includes("termination")||t.toLowerCase().includes("terminate"),o=t.toLowerCase().includes("fee")||t.toLowerCase().includes("payment")||t.toLowerCase().includes("compensation"),console.log("AI Prompt System Message:",s.contractReview.systemPrompt.substring(0,100)+"..."),c="General Agreement",t.toLowerCase().includes("content management")?c="Content Management Agreement":t.toLowerCase().includes("licensing")?c="Licensing Agreement":t.toLowerCase().includes("distribution")?c="Distribution Agreement":t.toLowerCase().includes("talent")&&(c="Talent Agreement"),l=70,r&&(l+=10),i&&(l+=10),a&&(l+=5),o&&(l+=5),u=[],a||u.push("Missing termination clause - consider adding clear termination conditions"),o||u.push("Compensation terms unclear - ensure payment terms are explicitly defined"),n<100&&u.push("Contract appears incomplete - consider adding more detailed terms"),e.next=20,S(t,c);case 20:return d=e.sent,e.t0=c,e.t1=n,e.t2=Math.min(l,100),e.t3="This ".concat(c.toLowerCase()," contains ").concat(n," words and appears to be ").concat(l>=80?"well-structured":"missing some standard clauses",". ").concat(u.length>0?"Several areas need attention.":"The contract structure looks good."),e.t4=u,e.t5=(p=void 0,m=void 0,p=[],((m=t.toLowerCase()).includes("term")||m.includes("duration"))&&p.push("Contract Duration"),(m.includes("fee")||m.includes("payment"))&&p.push("Payment Terms"),(m.includes("territory")||m.includes("worldwide"))&&p.push("Geographic Scope"),(m.includes("intellectual property")||m.includes("rights"))&&p.push("Rights Management"),p.length>0?p:["Standard Contract Terms"]),e.t6=T(u.length,r,a),e.t7=d,e.next=31,parseContractStructureWithChanges(t);case 31:return e.t8=e.sent,e.abrupt("return",{contract_type:e.t0,word_count:e.t1,compliance_score:e.t2,summary:e.t3,risks:e.t4,key_terms:e.t5,recommendations:e.t6,structured_analysis:e.t7,contract_structure:e.t8});case 33:case"end":return e.stop()}var p,m}),e)})))).apply(this,arguments)}function S(e,t){return A.apply(this,arguments)}function A(){return(A=k(b().mark((function e(t,n){var r,i,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Generating structured analysis per AI prompt requirements..."),r=O(t),i=P(r,n),a=N(i),e.abrupt("return",{article_structure:r,deviation_analysis:i,improvement_recommendations:a,ai_prompt_used:"contractReview",analysis_timestamp:(new Date).toISOString()});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,t,n){var r=[];return e>2&&r.push("Consider legal review before execution"),t||r.push("Add proper signature blocks and date fields"),n||r.push("Include clear termination and dispute resolution clauses"),r.push("Ensure all parties review terms carefully"),r.push("Consider adding governing law and jurisdiction clauses"),r}function I(e){var t=[],n=e.toLowerCase();return n.includes("termination")||n.includes("terminate")||t.push({severity:"high",category:"Missing Clause",title:"No Termination Clause",description:"Contract lacks clear termination conditions and procedures.",location:"Document-wide",suggestion:"Add a comprehensive termination clause specifying conditions, notice periods, and post-termination obligations."}),n.includes("liability")||n.includes("damages")||t.push({severity:"critical",category:"Legal Risk",title:"No Liability Limitation",description:"Contract does not address liability limitations or damage caps.",location:"Document-wide",suggestion:"Include liability limitation clauses to protect against excessive damages."}),n.includes("dispute")||n.includes("arbitration")||n.includes("jurisdiction")||t.push({severity:"medium",category:"Dispute Resolution",title:"No Dispute Resolution Mechanism",description:"Contract lacks clear dispute resolution procedures.",location:"Document-wide",suggestion:"Add dispute resolution clause specifying arbitration, mediation, or court jurisdiction."}),n.includes("confidential")||n.includes("proprietary")||t.push({severity:"medium",category:"IP Protection",title:"No Confidentiality Provisions",description:"Contract may not adequately protect confidential information.",location:"Document-wide",suggestion:"Include confidentiality and non-disclosure provisions."}),n.includes("force majeure")||n.includes("act of god")||t.push({severity:"low",category:"Risk Management",title:"No Force Majeure Clause",description:"Contract lacks protection against unforeseeable circumstances.",location:"Document-wide",suggestion:"Consider adding force majeure clause for protection against extraordinary events."}),{total_risks:t.length,risk_score:R(t),risks:t,summary:"Found ".concat(t.length," potential risk areas. ").concat(t.filter((function(e){return"critical"===e.severity})).length," critical, ").concat(t.filter((function(e){return"high"===e.severity})).length," high, ").concat(t.filter((function(e){return"medium"===e.severity})).length," medium, ").concat(t.filter((function(e){return"low"===e.severity})).length," low priority issues.")}}function R(e){var t=100;return e.forEach((function(e){switch(e.severity){case"critical":t-=25;break;case"high":t-=15;break;case"medium":t-=10;break;case"low":t-=5}})),Math.max(t,0)}function M(e){var t=[],n=e.toLowerCase();return n.includes("shall")&&!n.includes("may")&&t.push({type:"Language Improvement",priority:"medium",title:"Balance Mandatory vs Optional Language",current:'Contract uses only mandatory "shall" language',suggested:'Consider using "may" for optional provisions to provide flexibility',benefit:"Provides better balance between obligations and flexibility"}),n.includes("including but not limited to")||n.includes("such as")||t.push({type:"Clarity Enhancement",priority:"low",title:"Add Inclusive Language",current:"Lists may appear exhaustive",suggested:'Add "including but not limited to" before lists to indicate they are not exhaustive',benefit:"Prevents interpretation that lists are complete and exclusive"}),n.includes("reasonable")&&!n.includes("commercially reasonable")&&t.push({type:"Legal Precision",priority:"medium",title:'Clarify "Reasonable" Standards',current:'Uses vague "reasonable" standard',suggested:'Replace with "commercially reasonable" or define specific criteria',benefit:"Reduces ambiguity and potential disputes over reasonableness"}),n.includes("time is of the essence")||t.push({type:"Performance Standards",priority:"low",title:"Add Time Performance Clause",current:"No explicit time performance requirements",suggested:'Add "time is of the essence" clause for critical deadlines',benefit:"Emphasizes importance of meeting deadlines and strengthens enforcement"}),t.push({type:"Modern Practice",priority:"low",title:"Electronic Signature Provision",current:"Traditional signature requirements",suggested:"Add electronic signature acceptance clause",benefit:"Enables faster execution and modern business practices"}),{total_suggestions:t.length,suggestions:t,summary:"Generated ".concat(t.length," improvement suggestions to enhance contract clarity, enforceability, and modern business practices.")}}function O(e){console.log("Extracting articles and clauses with structured numbering...");var t=e.split("\n").filter((function(e){return e.trim().length>0})),n=[],r=0,i=0,a=["article","section","clause","term","provision"],o=["shall","will","must","agrees","obligations"];return t.forEach((function(e,t){var s=e.toLowerCase();if(a.some((function(t){return s.includes(t)&&e.length<100}))||t%8==0&&e.length>50)r++,i=0,n.push({type:"article",number:r.toString(),title:e.trim(),content:e,line_number:t+1,clauses:[]});else if(o.some((function(e){return s.includes(e)}))&&e.length>30){0===r&&(r=1,n.push({type:"article",number:"1",title:"General Provisions",content:"",line_number:1,clauses:[]})),i++;var c="".concat(r,".").concat(i),l=n.findIndex((function(e){return e.number===r.toString()}));l>=0&&n[l].clauses.push({type:"clause",number:c,content:e.trim(),line_number:t+1,sub_clauses:[]})}})),n}function P(e,t){console.log("Comparing against standard library for",t);var n=function(e){var t={"content-management":[{id:"termination",title:"Termination Clause",content:"Either party may terminate this agreement with thirty (30) days written notice.",negotiable:!0,category:"termination"},{id:"payment",title:"Payment Terms",content:"Payment shall be made within thirty (30) days of invoice receipt.",negotiable:!1,category:"financial"},{id:"liability",title:"Limitation of Liability",content:"Neither party shall be liable for indirect, incidental, or consequential damages.",negotiable:!0,category:"liability"}],licensing:[{id:"scope",title:"License Scope",content:"License is granted for the specific territory and duration outlined herein.",negotiable:!1,category:"scope"}]};return t[e]||t["content-management"]}(t),r=[];return e.forEach((function(e){e.clauses.forEach((function(e){var t,i,a=function(e,t){var n=e.content.toLowerCase();return t.find((function(e){var t=e.category;return n.includes(t)||n.includes(e.title.toLowerCase())}))}(e,n);if(a){var o=function(e,t){var n,r,i,a,o,s=e.content.toLowerCase();return n=t.content.toLowerCase(),r=new Set(s.split(" ")),i=new Set(n.split(" ")),a=new Set(_(r).filter((function(e){return i.has(e)}))),o=new Set([].concat(_(r),_(i))),a.size/o.size<.7?{has_deviation:!0,type:"language_deviation",negotiable:t.negotiable,risk_level:t.negotiable?"medium":"high",description:"Current clause deviates from standard ".concat(t.title),business_impact:t.negotiable?"May impact negotiation position":"Critical compliance issue requiring immediate attention"}:{has_deviation:!1}}(e,a);o.has_deviation&&r.push({clause_reference:e.number,clause_title:(t=e.content,i=t.split(" ").slice(0,5),i.join(" ")+"..."),deviation_type:o.type,negotiable_status:o.negotiable?"negotiable":"non-negotiable",risk_level:o.risk_level,current_language:e.content.substring(0,100)+"...",standard_language:a.content.substring(0,100)+"...",deviation_description:o.description,business_impact:o.business_impact})}else r.push({clause_reference:"Missing",clause_title:"Standard Clause Not Found",deviation_type:"missing_clause",negotiable_status:"non-negotiable",risk_level:"high",current_language:"Clause not present in contract",standard_language:"Required standard clause missing",deviation_description:"This contract is missing a standard clause required for this contract type",business_impact:"High risk due to missing legal protection"})}))})),r}function N(e){console.log("Generating improvement recommendations...");var t=[];return e.forEach((function(e){var n,r={clause_reference:e.clause_reference,priority:(n=e.risk_level,{high:"critical",medium:"high",low:"medium"}[n]||"medium"),recommendation_type:"negotiable"===e.negotiable_status?"optimization":"compliance",current_risk_score:L(e),improved_language:j(e),risk_mitigation:G(e),business_benefit:"Business benefit: Implementing this change will improve legal compliance and reduce potential disputes",implementation_notes:B(e)};t.push(r)})),t}function L(e){return{high:85,medium:60,low:30}[e.risk_level]||50}function j(e){return"Recommended revision for ".concat(e.clause_title,": [Specific improved language would be generated here based on standard library and AI analysis]")}function G(e){return"Risk mitigation: Address ".concat(e.deviation_type," to reduce ").concat(e.risk_level," risk exposure")}function B(e){return"Implementation: ".concat("negotiable"===e.negotiable_status?"Can be negotiated with counterparty":"Must be implemented to maintain compliance")}var D={"content-management":{music:[{name:"entity_name",label:"Entity Name",type:"text",required:!0,description:"Name of the contracting entity"},{name:"content_creator",label:"Content Creator",type:"text",required:!0,description:"Name of the content creator/artist"},{name:"scope_description",label:"Scope of Work",type:"textarea",required:!0,description:"Detailed description of content management services"},{name:"revenue_split",label:"Revenue Split (%)",type:"number",required:!0,description:"Percentage split for revenue sharing"},{name:"term_length",label:"Contract Term",type:"select",required:!0,options:["1 year","2 years","3 years","5 years"],description:"Duration of the agreement"},{name:"territory",label:"Territory",type:"select",required:!0,options:["Worldwide","North America","United States","Canada","Other"],description:"Geographic scope of the agreement"},{name:"music_rights",label:"Music Rights",type:"select",required:!0,options:["Master Rights","Publishing Rights","Both","Synchronization Only"],description:"Type of music rights being managed"},{name:"advance_amount",label:"Advance Amount ($)",type:"number",required:!1,description:"Initial advance payment (if applicable)"},{name:"termination_notice",label:"Termination Notice (days)",type:"number",required:!0,description:"Notice period required for termination"}],"non-music":[{name:"entity_name",label:"Entity Name",type:"text",required:!0,description:"Name of the contracting entity"},{name:"content_creator",label:"Content Creator",type:"text",required:!0,description:"Name of the content creator"},{name:"scope_description",label:"Scope of Work",type:"textarea",required:!0,description:"Detailed description of content management services"},{name:"revenue_split",label:"Revenue Split (%)",type:"number",required:!0,description:"Percentage split for revenue sharing"},{name:"term_length",label:"Contract Term",type:"select",required:!0,options:["1 year","2 years","3 years","5 years"],description:"Duration of the agreement"},{name:"territory",label:"Territory",type:"select",required:!0,options:["Worldwide","North America","United States","Canada","Other"],description:"Geographic scope of the agreement"},{name:"content_type",label:"Content Type",type:"select",required:!0,options:["Video Content","Podcast","Written Content","Social Media","Mixed Media"],description:"Type of content being managed"},{name:"platform_focus",label:"Platform Focus",type:"select",required:!0,options:["YouTube","TikTok","Instagram","Multi-Platform","Other"],description:"Primary platform for content distribution"},{name:"termination_notice",label:"Termination Notice (days)",type:"number",required:!0,description:"Notice period required for termination"}],both:[{name:"entity_name",label:"Entity Name",type:"text",required:!0,description:"Name of the contracting entity"},{name:"content_creator",label:"Content Creator",type:"text",required:!0,description:"Name of the content creator/artist"},{name:"scope_description",label:"Scope of Work",type:"textarea",required:!0,description:"Detailed description of content management services"},{name:"revenue_split_music",label:"Music Revenue Split (%)",type:"number",required:!0,description:"Percentage split for music revenue"},{name:"revenue_split_content",label:"Content Revenue Split (%)",type:"number",required:!0,description:"Percentage split for non-music content revenue"},{name:"term_length",label:"Contract Term",type:"select",required:!0,options:["1 year","2 years","3 years","5 years"],description:"Duration of the agreement"},{name:"territory",label:"Territory",type:"select",required:!0,options:["Worldwide","North America","United States","Canada","Other"],description:"Geographic scope of the agreement"},{name:"music_rights",label:"Music Rights",type:"select",required:!0,options:["Master Rights","Publishing Rights","Both","Synchronization Only"],description:"Type of music rights being managed"},{name:"content_platforms",label:"Content Platforms",type:"select",required:!0,options:["YouTube","TikTok","Instagram","Multi-Platform","Other"],description:"Primary platforms for content distribution"},{name:"termination_notice",label:"Termination Notice (days)",type:"number",required:!0,description:"Notice period required for termination"}]}};function q(){var e=document.getElementById("agreement-type").value,t=document.getElementById("content-type-group"),n=document.getElementById("dynamic-form"),r=document.getElementById("generate-button-group");e?(t.style.display="block",document.getElementById("content-type").value="",n.style.display="none",r.style.display="none"):(t.style.display="none",n.style.display="none",r.style.display="none")}function z(){var e=document.getElementById("agreement-type").value,t=document.getElementById("content-type").value,n=document.getElementById("dynamic-form"),r=document.getElementById("generate-button-group");e&&t?(function(e,t){var n,r=document.getElementById("dynamic-form"),i=null===(n=D[e])||void 0===n?void 0:n[t];if(i){var a='<h3 class="ms-font-l">Contract Details</h3>';i.forEach((function(e){var t=e.required?"required-field":"",n=e.required?"required":"";if(a+='<div class="form-field '.concat(t,'">'),a+='<label for="'.concat(e.name,'">').concat(e.label,":</label>"),"textarea"===e.type)a+='<textarea id="'.concat(e.name,'" name="').concat(e.name,'" ').concat(n,' placeholder="Enter ').concat(e.label.toLowerCase(),'"></textarea>');else if("select"===e.type)a+='<select id="'.concat(e.name,'" name="').concat(e.name,'" ').concat(n,">"),a+='<option value="">Select '.concat(e.label,"</option>"),e.options.forEach((function(e){a+='<option value="'.concat(e,'">').concat(e,"</option>")})),a+="</select>";else{var r="number"===e.type?"number":"text";a+='<input type="'.concat(r,'" id="').concat(e.name,'" name="').concat(e.name,'" ').concat(n,' placeholder="Enter ').concat(e.label.toLowerCase(),'">')}e.description&&(a+='<div class="field-description">'.concat(e.description,"</div>")),a+="</div>"})),r.innerHTML=a}else r.innerHTML='<p class="ms-font-s">Form template not available for this combination.</p>'}(e,t),n.style.display="block",r.style.display="block"):(n.style.display="none",r.style.display="none")}function W(e,t,n,r){var i=document.getElementById("results-content"),a=document.getElementById("results-section"),o=e.contract_structure,s=o.articles.reduce((function(e,t){return e+t.clauses.filter((function(e){var t;return null===(t=e.changeStatus)||void 0===t?void 0:t.isModified})).length}),0),c=o.articles.reduce((function(e,t){return e+t.clauses.length}),0),l='\n    <div class="analysis-results">\n      \x3c!-- 1. CONTRACT STRUCTURE BREAKDOWN (FIRST) --\x3e\n      <div class="analysis-section contract-structure">\n        <h3>üìã Contract Structure</h3>\n        <div class="structure-overview">\n          <p><strong>Total Articles:</strong> '.concat(o.articles.length,"</p>\n          <p><strong>Total Clauses:</strong> ").concat(c,'</p>\n        </div>\n        \n        <div class="articles-breakdown">');o.articles.forEach((function(e){l+='\n          <div class="article-item">\n            <h4 class="article-title">'.concat(e.number,". ").concat(e.title,'</h4>\n            <div class="clauses-list">'),e.clauses.forEach((function(e){var t,n,r=null!==(t=e.changeStatus)&&void 0!==t&&t.isModified?"modified":"unmodified",i=null!==(n=e.changeStatus)&&void 0!==n&&n.isModified?"red":"green";l+='\n              <div class="clause-item '.concat(r,'">\n                <span class="clause-number" style="color: ').concat(i,';">').concat(e.number,'</span>\n                <span class="clause-text">').concat(e.text.substring(0,100)).concat(e.text.length>100?"...":"","</span>\n              </div>")})),l+="\n            </div>\n          </div>"})),l+='\n        </div>\n      </div>\n\n      \x3c!-- 2. TRACK CHANGES SUMMARY (AFTER STRUCTURE) --\x3e\n      <div class="analysis-section track-changes-summary">\n        <h3>üîÑ Track Changes Summary</h3>\n        '.concat(o.trackChanges?'\n          <div class="change-tracking-info">\n            <p><strong>Track Changes:</strong> '.concat(o.trackChanges.enabled?"Enabled":"Disabled","</p>\n            ").concat(o.trackChanges.enabled?'\n              <p><strong>Modified Clauses:</strong> <span class="modified-count">'.concat(s,"</span> / ").concat(c,'</p>\n              <p><strong>Unmodified Clauses:</strong> <span class="unmodified-count">').concat(c-s,"</span> / ").concat(c,"</p>\n            "):"","\n            ").concat(o.trackChanges.note?'<p class="track-changes-note"><em>'.concat(o.trackChanges.note,"</em></p>"):"","\n            ").concat(o.trackChanges.demoMode?'<p class="demo-note"><em>Demo mode - simulated changes for testing</em></p>':"","\n          </div>\n          ").concat(o.trackChanges.enabled?'\n            <div class="change-legend">\n              <div class="legend-item">\n                <span class="legend-indicator modified"></span>\n                <span>Modified Clause</span>\n              </div>\n              <div class="legend-item">\n                <span class="legend-indicator unmodified"></span>\n                <span>Unmodified Clause</span>\n              </div>\n            </div>\n          ':"","\n        "):"",'\n      </div>\n\n      \x3c!-- 3. EXECUTIVE SUMMARY SECTION --\x3e\n      <div class="analysis-summary">\n        <h3>').concat(r.title,'</h3>\n        <div class="summary-overview">\n          <p>').concat(r.overview,'</p>\n        </div>\n        \n        <div class="summary-metrics">\n          <div class="metric-item">\n            <span class="metric-label">Contract Type:</span>\n            <span class="metric-value">').concat(e.contract_type,'</span>\n          </div>\n          <div class="metric-item">\n            <span class="metric-label">Word Count:</span>\n            <span class="metric-value">').concat(e.word_count,'</span>\n          </div>\n          <div class="metric-item">\n            <span class="metric-label">Compliance Score:</span>\n            <span class="metric-value compliance-score">').concat(e.compliance_score,'%</span>\n          </div>\n          <div class="metric-item">\n            <span class="metric-label">Risk Score:</span>\n            <span class="metric-value risk-score">').concat(t.risk_score,'%</span>\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- 4. DETAILED ANALYSIS SECTIONS --\x3e\n      <div class="detailed-analysis">\n        \n        \x3c!-- Risk Analysis --\x3e\n        <div class="analysis-section risks">\n          <h3>‚ö†Ô∏è Risk Analysis</h3>\n          <p class="section-summary">').concat(t.summary,'</p>\n          \n          <div class="risks-list">'),t.risks.forEach((function(e){var t="severity-".concat(e.severity);l+='\n            <div class="risk-item '.concat(t,'">\n              <div class="risk-header">\n                <span class="risk-severity">').concat(e.severity.toUpperCase(),'</span>\n                <span class="risk-title">').concat(e.title,'</span>\n              </div>\n              <p class="risk-description">').concat(e.description,'</p>\n              <p class="risk-suggestion"><strong>Suggestion:</strong> ').concat(e.suggestion,"</p>\n            </div>")})),l+='\n          </div>\n        </div>\n\n        \x3c!-- Change Suggestions --\x3e\n        <div class="analysis-section suggestions">\n          <h3>üí° Improvement Suggestions</h3>\n          <p class="section-summary">'.concat(n.summary,'</p>\n          \n          <div class="suggestions-list">'),n.suggestions.forEach((function(e){var t="priority-".concat(e.priority);l+='\n            <div class="suggestion-item '.concat(t,'">\n              <div class="suggestion-header">\n                <span class="suggestion-priority">').concat(e.priority.toUpperCase(),'</span>\n                <span class="suggestion-title">').concat(e.title,'</span>\n              </div>\n              <div class="suggestion-details">\n                <p><strong>Current:</strong> ').concat(e.current,"</p>\n                <p><strong>Suggested:</strong> ").concat(e.suggested,"</p>\n                <p><strong>Benefit:</strong> ").concat(e.benefit,"</p>\n              </div>\n            </div>")})),l+='\n          </div>\n        </div>\n\n        \x3c!-- Key Terms --\x3e\n        <div class="analysis-section key-terms">\n          <h3>üîë Key Terms Identified</h3>\n          <div class="terms-list">',e.key_terms.forEach((function(e){l+='<span class="term-tag">'.concat(e,"</span>")})),l+='\n          </div>\n        </div>\n\n        \x3c!-- Recommendations --\x3e\n        <div class="analysis-section recommendations">\n          <h3>üìù Recommendations</h3>\n          <ul class="recommendations-list">',e.recommendations.forEach((function(e){l+="<li>".concat(e,"</li>")})),l+="\n          </ul>\n        </div>\n      </div>\n    </div>",i.innerHTML=l,a.style.display="block",function(e){var t=document.getElementById("suggestions-section"),n=document.getElementById("suggestions-content"),r='\n    <div class="suggestions-header">\n      <h3>üí° Contract Improvement Suggestions</h3>\n      <p>Review and apply the following suggestions to improve your contract:</p>\n    </div>\n    \n    <div class="suggestions-list">';e.suggestions.forEach((function(e,t){var n="priority-".concat(e.priority);r+='\n      <div class="suggestion-card '.concat(n,'">\n        <div class="suggestion-header">\n          <span class="priority-badge ').concat(e.priority,'">').concat(e.priority.toUpperCase(),"</span>\n          <h4>").concat(e.title,'</h4>\n        </div>\n        <div class="suggestion-content">\n          <div class="current-state">\n            <strong>Current:</strong> ').concat(e.current,'\n          </div>\n          <div class="suggested-change">\n            <strong>Suggested:</strong> ').concat(e.suggested,'\n          </div>\n          <div class="benefit">\n            <strong>Benefit:</strong> ').concat(e.benefit,'\n          </div>\n        </div>\n        <div class="suggestion-actions">\n          <button class="apply-suggestion-btn" onclick="applySuggestion(').concat(t,')">\n            Apply This Change\n          </button>\n        </div>\n      </div>')})),r+='\n    </div>\n    \n    <div class="suggestions-actions">\n      <button id="apply-all-changes-btn" class="primary-button" onclick="applyAllChanges()">\n        Apply All Changes\n      </button>\n      <button id="dismiss-suggestions-btn" class="secondary-button" onclick="dismissSuggestions()">\n        Dismiss Suggestions\n      </button>\n    </div>',n.innerHTML=r,t.style.display="block"}(n)}function U(e){var t,n,r=document.getElementById("results-content"),i=document.getElementById("results-section"),a='\n    <div class="contract-results">\n      <h3>‚úÖ Contract Generated Successfully</h3>\n      <div class="contract-info">\n        <p><strong>Contract Type:</strong> '.concat((null===(t=e.metadata)||void 0===t?void 0:t.template_used)||"Content Management Agreement","</p>\n        <p><strong>Generated:</strong> ").concat(new Date((null===(n=e.metadata)||void 0===n?void 0:n.generated_at)||new Date).toLocaleString(),'</p>\n        <p><strong>Status:</strong> <span class="status-success">Ready for Review</span></p>\n      </div>\n      \n      <div class="contract-actions">\n        <button id="review-contract-btn" class="primary-button" onclick="reviewGeneratedContract()">\n          üìã Review Contract\n        </button>\n        <button id="analyze-new-contract-btn" class="secondary-button" onclick="analyzeContract()">\n          üîç Analyze Generated Contract\n        </button>\n      </div>\n      \n      <div class="next-steps">\n        <h4>Next Steps:</h4>\n        <ul>\n          <li>Review the generated contract content</li>\n          <li>Run contract analysis to check for risks</li>\n          <li>Make any necessary modifications</li>\n          <li>Save and share with relevant parties</li>\n        </ul>\n      </div>\n    </div>');r.innerHTML=a,i.style.display="block"}function F(e){var t=document.getElementById("results-content"),n=document.getElementById("results-section");if(e.structured_analysis){var r=e.structured_analysis,i='\n    <div class="structured-analysis-results">\n      <div class="analysis-header">\n        <h2>üìã AI Contract Analysis Report</h2>\n        <div class="analysis-meta">\n          <p><strong>Contract Type:</strong> '.concat(e.contract_type,"</p>\n          <p><strong>Analysis Date:</strong> ").concat(new Date(r.analysis_timestamp).toLocaleString(),"</p>\n          <p><strong>AI Prompt:</strong> ").concat(r.ai_prompt_used,'</p>\n        </div>\n      </div>\n\n      \x3c!-- 1. ARTICLE STRUCTURE (Following numbering: 1, 1.1, 1.1.1, 2, 2.1, etc.) --\x3e\n      <div class="analysis-section article-structure">\n        <h3>üìë Contract Structure Analysis</h3>\n        <div class="structure-summary">\n          <p>Articles identified and numbered according to legal standards:</p>\n        </div>\n\n        <div class="articles-breakdown">');r.article_structure.forEach((function(e){i+='\n          <div class="article-container">\n            <div class="article-header">\n              <h4 class="article-number">Article '.concat(e.number,'</h4>\n              <h5 class="article-title">').concat(e.title,'</h5>\n            </div>\n\n            <div class="clauses-container">'),e.clauses.forEach((function(e){i+='\n              <div class="clause-item">\n                <span class="clause-number">'.concat(e.number,'</span>\n                <div class="clause-content">\n                  <p>').concat(e.content,'</p>\n                  <small class="line-reference">Line ').concat(e.line_number,"</small>\n                </div>\n              </div>")})),i+="\n            </div>\n          </div>"})),i+='\n        </div>\n      </div>\n\n      \x3c!-- 2. DEVIATION ANALYSIS --\x3e\n      <div class="analysis-section deviation-analysis">\n        <h3>‚öñÔ∏è Standard Library Comparison</h3>\n        <div class="deviations-summary">\n          <p>Deviations from company standard clauses:</p>\n        </div>\n\n        <div class="deviations-list">',r.deviation_analysis.forEach((function(e){var t="negotiable"===e.negotiable_status?"negotiable":"non-negotiable",n="risk-".concat(e.risk_level);i+='\n          <div class="deviation-item '.concat(t," ").concat(n,'">\n            <div class="deviation-header">\n              <span class="clause-ref">Clause ').concat(e.clause_reference,'</span>\n              <span class="negotiable-badge ').concat(e.negotiable_status,'">\n                ').concat(e.negotiable_status.toUpperCase(),'\n              </span>\n              <span class="risk-badge ').concat(e.risk_level,'">\n                ').concat(e.risk_level.toUpperCase(),' RISK\n              </span>\n            </div>\n\n            <div class="deviation-content">\n              <h5>').concat(e.clause_title,'</h5>\n              <p class="deviation-description">').concat(e.deviation_description,'</p>\n\n              <div class="language-comparison">\n                <div class="current-language">\n                  <strong>Current Language:</strong>\n                  <p>').concat(e.current_language,'</p>\n                </div>\n                <div class="standard-language">\n                  <strong>Standard Library:</strong>\n                  <p>').concat(e.standard_language,'</p>\n                </div>\n              </div>\n\n              <div class="business-impact">\n                <strong>Business Impact:</strong> ').concat(e.business_impact,"\n              </div>\n            </div>\n          </div>")})),i+='\n        </div>\n      </div>\n\n      \x3c!-- 3. IMPROVEMENT RECOMMENDATIONS --\x3e\n      <div class="analysis-section improvement-recommendations">\n        <h3>üí° Improvement Recommendations</h3>\n        <div class="recommendations-summary">\n          <p>Specific language revisions and compliance recommendations:</p>\n        </div>\n\n        <div class="recommendations-list">',r.improvement_recommendations.forEach((function(e){var t="priority-".concat(e.priority),n="type-".concat(e.recommendation_type);i+='\n          <div class="recommendation-item '.concat(t," ").concat(n,'">\n            <div class="recommendation-header">\n              <span class="clause-ref">Clause ').concat(e.clause_reference,'</span>\n              <span class="priority-badge ').concat(e.priority,'">\n                ').concat(e.priority.toUpperCase(),'\n              </span>\n              <span class="type-badge ').concat(e.recommendation_type,'">\n                ').concat(e.recommendation_type.toUpperCase(),'\n              </span>\n            </div>\n\n            <div class="recommendation-content">\n              <div class="risk-score">\n                <strong>Current Risk Score:</strong>\n                <span class="score">').concat(e.current_risk_score,'/100</span>\n              </div>\n\n              <div class="improved-language">\n                <strong>Recommended Language:</strong>\n                <p>').concat(e.improved_language,'</p>\n              </div>\n\n              <div class="benefits">\n                <div class="risk-mitigation">\n                  <strong>Risk Mitigation:</strong> ').concat(e.risk_mitigation,'\n                </div>\n                <div class="business-benefit">\n                  <strong>Business Benefit:</strong> ').concat(e.business_benefit,'\n                </div>\n              </div>\n\n              <div class="implementation">\n                <strong>Implementation Notes:</strong> ').concat(e.implementation_notes,"\n              </div>\n            </div>\n          </div>")})),i+='\n        </div>\n      </div>\n\n      \x3c!-- 4. SUMMARY METRICS --\x3e\n      <div class="analysis-section summary-metrics">\n        <h3>üìä Analysis Summary</h3>\n        <div class="metrics-grid">\n          <div class="metric-card">\n            <span class="metric-label">Total Articles</span>\n            <span class="metric-value">'.concat(r.article_structure.length,'</span>\n          </div>\n          <div class="metric-card">\n            <span class="metric-label">Deviations Found</span>\n            <span class="metric-value">').concat(r.deviation_analysis.length,'</span>\n          </div>\n          <div class="metric-card">\n            <span class="metric-label">Recommendations</span>\n            <span class="metric-value">').concat(r.improvement_recommendations.length,'</span>\n          </div>\n          <div class="metric-card">\n            <span class="metric-label">Compliance Score</span>\n            <span class="metric-value">').concat(e.compliance_score,"%</span>\n          </div>\n        </div>\n      </div>\n    </div>"),t.innerHTML=i,n.style.display="block",r.improvement_recommendations.length>0&&function(e){var t=document.getElementById("suggestions-section"),n=document.getElementById("suggestions-content"),r='\n    <div class="structured-suggestions-header">\n      <h3>üîß Apply Recommended Changes</h3>\n      <p>Review and apply AI-recommended improvements to optimize your contract:</p>\n    </div>\n\n    <div class="structured-suggestions-list">';e.forEach((function(e,t){var n="priority-".concat(e.priority),i="type-".concat(e.recommendation_type);r+='\n      <div class="structured-suggestion-card '.concat(n," ").concat(i,'">\n        <div class="suggestion-header">\n          <span class="clause-ref">Clause ').concat(e.clause_reference,'</span>\n          <span class="priority-badge ').concat(e.priority,'">').concat(e.priority.toUpperCase(),'</span>\n          <span class="type-badge ').concat(e.recommendation_type,'">').concat(e.recommendation_type.toUpperCase(),'</span>\n        </div>\n        <div class="suggestion-content">\n          <div class="risk-info">\n            <strong>Current Risk Score:</strong> <span class="risk-score">').concat(e.current_risk_score,'/100</span>\n          </div>\n          <div class="improved-language">\n            <strong>Recommended Language:</strong>\n            <p>').concat(e.improved_language,'</p>\n          </div>\n          <div class="benefits">\n            <p><strong>Business Benefit:</strong> ').concat(e.business_benefit,'</p>\n          </div>\n        </div>\n        <div class="suggestion-actions">\n          <button class="apply-structured-suggestion-btn" onclick="applyStructuredSuggestion(').concat(t,')">\n            Apply This Change\n          </button>\n        </div>\n      </div>')})),r+='\n    </div>\n\n    <div class="structured-suggestions-actions">\n      <button id="apply-all-structured-changes-btn" class="primary-button" onclick="applyAllStructuredChanges()">\n        Apply All Recommendations\n      </button>\n      <button id="dismiss-structured-suggestions-btn" class="secondary-button" onclick="dismissSuggestions()">\n        Dismiss Suggestions\n      </button>\n    </div>',n.innerHTML=r,t.style.display="block"}(r.improvement_recommendations)}else console.log("No structured analysis found, using legacy display")}function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function V(){V=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n,r){Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(t,n,r,i){var a=n&&n.prototype instanceof p?n:p,o=Object.create(a.prototype);return c(o,"_invoke",function(t,n,r){var i=1;return function(a,o){if(3===i)throw Error("Generator is already running");if(4===i){if("throw"===a)throw o;return{value:e,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var c=w(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===i)throw i=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=3;var l=u(t,n,r);if("normal"===l.type){if(i=r.done?4:2,l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=4,r.method="throw",r.arg=l.arg)}}}(t,r,new C(i||[])),!0),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var d={};function p(){}function m(){}function g(){}var f={};c(f,a,(function(){return this}));var h=Object.getPrototypeOf,y=h&&h(h(x([])));y&&y!==n&&r.call(y,a)&&(f=y);var v=g.prototype=p.prototype=Object.create(f);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(i,a,o,s){var c=u(e[i],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==H(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(d).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}))}s(c.arg)}var i;c(this,"_invoke",(function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}),!0)}function w(t,n){var r=n.method,i=t.i[r];if(i===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,w(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var a=u(i,t.i,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,d;var o=a.arg;return o?o.done?(n[t.r]=o.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function E(e){this.tryEntries.push(e)}function k(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function C(e){this.tryEntries=[[-1]],e.forEach(E,this),this.reset(!0)}function x(t){if(null!=t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(H(t)+" is not iterable")}return m.prototype=g,c(v,"constructor",g),c(g,"constructor",m),c(g,s,m.displayName="GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},b(_.prototype),c(_.prototype,o,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new _(l(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},b(v),c(v,s,"Generator"),c(v,a,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=x,C.prototype={constructor:C,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){o.type="throw",o.arg=t,n.next=e}for(var i=n.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a[4],s=this.prev,c=a[1],l=a[2];if(-1===a[0])return r("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<l)return r(l),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var i=r;break}}i&&("break"===e||"continue"===e)&&i[0]<=t&&t<=i[2]&&(i=null);var a=i?i[4]:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i[2],d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),k(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var i=r.arg;k(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:x(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function K(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function $(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){K(a,r,i,o,s,"next",e)}function s(e){K(a,r,i,o,s,"throw",e)}o(void 0)}))}}var J=new y({USE_REAL_API:!1,baseUrl:"https://api.starling-ai.com/v1",demoMode:!0,endpoints:{analyze:"/analyze-contract",generate:"/generate-contract",suggestions:"/suggest-changes"},headers:{"Content-Type":"application/json",Accept:"application/json"}});function X(){return Q.apply(this,arguments)}function Q(){return(Q=$(V().mark((function a(){var o,s;return V().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e("generate-contract-btn",!0),n("Generating contract..."),t("Preparing contract generation...","info"),a.prev=3,void 0,o=(c=[{agreement_type:"content-management",content_type:"music",fields:{entity_name:"Starling Music Management LLC",content_creator:"Alex Rivera",scope_description:"Comprehensive music content management including digital distribution across all major platforms, rights management, marketing campaigns, and revenue collection services.",revenue_split:"20",term_length:"3 years",territory:"Worldwide",music_rights:"Master Rights",advance_amount:"15000",termination_notice:"60"}},{agreement_type:"content-management",content_type:"non-music",fields:{entity_name:"Digital Content Partners",content_creator:"Jordan Smith",scope_description:"Full-service content management for video content including YouTube optimization, brand partnerships, content strategy, and monetization.",revenue_split:"25",term_length:"2 years",territory:"North America",content_type:"Video Content",platform_focus:"YouTube",termination_notice:"30"}},{agreement_type:"licensing",content_type:"music",fields:{entity_name:"Harmony Licensing Group",content_creator:"Taylor Music Productions",scope_description:"Licensing agreement for synchronization rights in film, television, and digital media.",license_fee:"5000",term_length:"5 years",territory:"Worldwide",music_rights:"Synchronization Rights",termination_notice:"90"}}])[Math.floor(Math.random()*c.length)],a.next=7;break;case 7:return t("Generating contract content...","info"),a.next=10,J.generateContract(o);case 10:return s=a.sent,a.next=13,ae(s,o);case 13:U(s),t("Contract generated successfully!","success"),r(),a.next=21;break;case 18:a.prev=18,a.t0=a.catch(3),i(a.t0);case 21:return a.prev=21,e("generate-contract-btn",!1),a.finish(21);case 24:case"end":return a.stop()}var c}),a,null,[[3,18,21,24]])})))).apply(this,arguments)}function Z(){return ee.apply(this,arguments)}function ee(){return(ee=$(V().mark((function a(){var o,s,c,l,u,d,p;return V().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e("analyze-contract-btn",!0),n("Analyzing contract..."),t("Reading document content...","info"),a.prev=3,a.next=6,re();case 6:if((o=a.sent)&&!(o.trim().length<50)){a.next=9;break}throw new Error("Document appears to be empty or too short to analyze. Please ensure you have contract content in the document.");case 9:return t("Performing contract analysis...","info"),a.next=12,Promise.all([C(o),I(o),M(o)]);case 12:s=a.sent,g=3,c=function(e){if(Array.isArray(e))return e}(m=s)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(m,g)||function(e,t){if(e){if("string"==typeof e)return Y(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(e,t):void 0}}(m,g)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),l=c[0],u=c[1],d=c[2],p=ce(l,u,d),t("Analysis complete!","success"),l.structured_analysis?(console.log("Displaying structured analysis results using new AI prompt format"),F(l)):(console.log("Displaying legacy analysis results"),W(l,u,d,p)),r(),a.next=26;break;case 23:a.prev=23,a.t0=a.catch(3),i(a.t0);case 26:return a.prev=26,e("analyze-contract-btn",!1),a.finish(26);case 29:case"end":return a.stop()}var m,g}),a,null,[[3,23,26,29]])})))).apply(this,arguments)}function te(){return(te=$(V().mark((function e(n){var r,a;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t("Applying suggestion ".concat(n+1,"..."),"info"),e.prev=1,e.next=4,new Promise((function(e){return setTimeout(e,1e3)}));case 4:t("Suggestion ".concat(n+1," applied successfully!"),"success"),(r=document.querySelectorAll(".suggestion-card")[n])&&(r.classList.add("applied"),(a=r.querySelector(".apply-suggestion-btn"))&&(a.textContent="‚úì Applied",a.disabled=!0)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),i(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function ne(){return(ne=$(V().mark((function n(){return V().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e("apply-all-changes-btn",!0),t("Applying all suggestions...","info"),n.prev=2,n.next=5,new Promise((function(e){return setTimeout(e,2e3)}));case 5:t("All suggestions applied successfully!","success"),document.querySelectorAll(".suggestion-card").forEach((function(e){e.classList.add("applied");var t=e.querySelector(".apply-suggestion-btn");t&&(t.textContent="‚úì Applied",t.disabled=!0)})),document.getElementById("apply-all-changes-btn").style.display="none",n.next=14;break;case 11:n.prev=11,n.t0=n.catch(2),i(n.t0);case 14:return n.prev=14,e("apply-all-changes-btn",!1),n.finish(14);case 17:case"end":return n.stop()}}),n,null,[[2,11,14,17]])})))).apply(this,arguments)}function re(){return ie.apply(this,arguments)}function ie(){return ie=$(V().mark((function e(){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!=typeof Word){e.next=2;break}throw new Error("Word API not available. Please ensure you are running this add-in in Microsoft Word.");case 2:if(Office.context&&Office.context.document){e.next=4;break}throw new Error("Office.js not properly initialized. Please refresh the add-in.");case 4:return e.next=6,Word.run(function(){var e=$(V().mark((function e(t){var n;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.body).load("text"),e.next=4,t.sync();case 4:return e.abrupt("return",n.text);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)}))),ie.apply(this,arguments)}function ae(e,t){return oe.apply(this,arguments)}function oe(){return oe=$(V().mark((function e(t,n){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!=typeof Word){e.next=2;break}throw new Error("Word API not available. Please ensure you are running this add-in in Microsoft Word.");case 2:if(Office.context&&Office.context.document){e.next=4;break}throw new Error("Office.js not properly initialized. Please refresh the add-in.");case 4:return e.next=6,Word.run(function(){var e=$(V().mark((function e(t){var r,i,a;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.document.body).clear(),i=se(n),r.insertText(i,Word.InsertLocation.start),(a=r.getRange()).font.name="Calibri",a.font.size=11,e.next=9,t.sync();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)}))),oe.apply(this,arguments)}function se(e){var t;return(null===(t={"content-management":{music:'MUSIC CONTENT MANAGEMENT AGREEMENT\n\nThis Music Content Management Agreement ("Agreement") is entered into on '.concat((new Date).toLocaleDateString()," between ").concat(e.fields.entity_name||"Starling Music Management LLC",', a limited liability company ("Manager"), and ').concat(e.fields.content_creator||"Artist Name",' ("Artist").\n\n1. SCOPE OF SERVICES\nManager agrees to provide comprehensive music content management services including:\n- Digital distribution across all major streaming platforms (Spotify, Apple Music, Amazon Music, etc.)\n- Rights management and royalty collection\n- Marketing and promotional campaigns\n- Performance tracking and analytics\n- Playlist pitching and promotion\n\n2. REVENUE SHARING\nArtist and Manager agree to the following revenue split:\n- Artist: ').concat(100-(e.fields.revenue_split||20),"%\n- Manager: ").concat(e.fields.revenue_split||20,"%\n\n3. TERM AND TERRITORY\nThis Agreement shall remain in effect for ").concat(e.fields.term_length||"3 years"," and covers ").concat(e.fields.territory||"Worldwide",".\n\n4. RIGHTS GRANTED\nArtist grants Manager the right to manage ").concat(e.fields.music_rights||"Master Rights"," for the specified territory and term.\n\n5. ADVANCE\n").concat(e.fields.advance_amount?"Manager will provide an advance of $".concat(e.fields.advance_amount," upon execution of this Agreement."):"No advance payment is included in this Agreement.","\n\n6. TERMINATION\nEither party may terminate this Agreement with ").concat(e.fields.termination_notice||"60"," days written notice.\n\n7. GOVERNING LAW\nThis Agreement shall be governed by the laws of the State of California.\n\nIN WITNESS WHEREOF, the parties have executed this Agreement as of the date first written above.\n\nMANAGER:                           ARTIST:\n\n_________________________         _________________________\n").concat(e.fields.entity_name||"Starling Music Management LLC","    ").concat(e.fields.content_creator||"Artist Name","\n\nDate: _______________             Date: _______________"),"non-music":'CONTENT MANAGEMENT AGREEMENT\n\nThis Content Management Agreement ("Agreement") is entered into on '.concat((new Date).toLocaleDateString()," between ").concat(e.fields.entity_name||"Digital Content Partners",' ("Manager") and ').concat(e.fields.content_creator||"Content Creator",' ("Creator").\n\n1. CONTENT MANAGEMENT SERVICES\nManager will provide comprehensive content management including:\n- ').concat(e.fields.content_type||"Video Content"," optimization and strategy\n- Platform management for ").concat(e.fields.platform_focus||"YouTube","\n- Brand partnership facilitation\n- Revenue optimization and analytics\n- Content scheduling and distribution\n\n2. COMPENSATION\nRevenue sharing arrangement:\n- Creator: ").concat(100-(e.fields.revenue_split||25),"%\n- Manager: ").concat(e.fields.revenue_split||25,"%\n\n3. TERM AND SCOPE\nDuration: ").concat(e.fields.term_length||"2 years","\nTerritory: ").concat(e.fields.territory||"North America","\n\n4. CONTENT RIGHTS\nCreator grants Manager limited rights to manage and distribute content on agreed platforms.\n\n5. TERMINATION\nEither party may terminate with ").concat(e.fields.termination_notice||"30"," days written notice.\n\n6. GOVERNING LAW\nThis Agreement is governed by applicable state and federal laws.\n\nSIGNATURES:\n\nMANAGER:                           CREATOR:\n\n_________________________         _________________________\n").concat(e.fields.entity_name||"Digital Content Partners","      ").concat(e.fields.content_creator||"Content Creator","\n\nDate: _______________             Date: _______________")}}[e.agreement_type])||void 0===t?void 0:t[e.content_type])||"Contract content would be generated here based on your selections."}function ce(e,t,n){var r=t.risk_score>=80?"Low":t.risk_score>=60?"Medium":"High";return{title:"üìä Executive Summary",overview:"This ".concat(e.contract_type.toLowerCase()," has been analyzed for compliance, risks, and improvement opportunities. The contract shows a ").concat(r.toLowerCase()," risk profile with ").concat(t.risks.length," identified areas for attention and ").concat(n.suggestions.length," improvement suggestions.")}}function le(){t("Toggling track changes...","info")}function ue(){t("Highlighting risks...","info")}function de(){t("Checking compliance...","info")}function pe(){t("Applying suggested changes...","info")}window.generateContract=X,window.analyzeContract=Z,window.applySuggestion=function(e){return te.apply(this,arguments)},window.applyAllChanges=function(){return ne.apply(this,arguments)},window.dismissSuggestions=function(){o(),t("Suggestions dismissed","info")},window.clearResults=a,window.clearSuggestions=o,window.handleAgreementTypeChange=q,window.handleContentTypeChange=z,Office.onReady((function(e){if(e.host===Office.HostApplication.Word){if(console.log("RHEI AI Legal Assistant loaded successfully"),"undefined"==typeof Word)return console.error("Word API not available"),void t("Error: Word API not available. Please refresh the add-in.","error");console.log("Word API is available"),function(){if(Office.context&&Office.context.officeTheme){var e=Office.context.officeTheme;document.body.className="office-theme-".concat(e.bodyBackgroundColor)}}(),function(){var e=document.getElementById("generate-contract");e&&e.addEventListener("click",X);var t=document.getElementById("analyze-contract");t&&t.addEventListener("click",Z);var n=document.getElementById("agreement-type");n&&n.addEventListener("change",q);var r=document.getElementById("content-type");r&&r.addEventListener("change",z);var i=document.getElementById("clear-results");i&&i.addEventListener("click",a);var s=document.getElementById("clear-suggestions");s&&s.addEventListener("click",o);var c=document.getElementById("toggle-track-changes");c&&c.addEventListener("click",le);var l=document.getElementById("highlight-risks");l&&l.addEventListener("click",ue);var u=document.getElementById("check-compliance");u&&u.addEventListener("click",de);var d=document.getElementById("suggest-changes");d&&d.addEventListener("click",pe),console.log("Event listeners set up successfully")}(),n=document.getElementById("dynamic-form"),r=document.getElementById("generate-button-group"),i=document.getElementById("content-type-group"),s=document.getElementById("results-section"),c=document.getElementById("suggestions-section"),l=document.getElementById("progress-section"),n&&(n.style.display="none"),r&&(r.style.display="none"),i&&(i.style.display="none"),s&&(s.style.display="none"),c&&(c.style.display="none"),l&&(l.style.display="none"),t("Ready to generate or analyze contracts","info"),console.log("UI initialized successfully"),console.log("Add-in initialization complete")}else console.error("This add-in is designed for Microsoft Word only"),t("Error: This add-in requires Microsoft Word","error");var n,r,i,s,c,l})),window.addEventListener("error",(function(e){console.error("Global error:",e.error),i(e.error)})),window.addEventListener("unhandledrejection",(function(e){console.error("Unhandled promise rejection:",e.reason),i(e.reason)})),console.log("RHEI AI Legal Assistant module loaded")}();
//# sourceMappingURL=taskpane.js.map