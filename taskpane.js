/*! For license information please see taskpane.js.LICENSE.txt */
!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){"use strict";t=function(){return r};var n,r={},o=Object.prototype,i=o.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,n,r){Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{l({},"")}catch(n){l=function(e,t,n){return e[t]=n}}function p(e,t,r,o){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype);return l(a,"_invoke",function(e,t,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:n,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=_(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=d(e,t,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new q(o||[])),!0),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=p;var f={};function m(){}function y(){}function h(){}var g={};l(g,c,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(S([])));b&&b!==o&&i.call(b,c)&&(g=b);var w=h.prototype=m.prototype=Object.create(g);function x(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(t,n){function r(o,a,c,s){var u=d(t[o],t,a);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==e(p)&&i.call(p,"__await")?n.resolve(p.__await).then((function(e){r("next",e,c,s)}),(function(e){r("throw",e,c,s)})):n.resolve(p).then((function(e){l.value=e,c(l)}),(function(e){return r("throw",e,c,s)}))}s(u.arg)}var o;l(this,"_invoke",(function(e,t){function i(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(i,i):i()}),!0)}function _(e,t){var r=t.method,o=e.i[r];if(o===n)return t.delegate=null,"throw"===r&&e.i.return&&(t.method="return",t.arg=n,_(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=d(o,e.i,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,f;var a=i.arg;return a?a.done?(t[e.r]=a.value,t.next=e.n,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function k(e){this.tryEntries.push(e)}function I(e){var t=e[4]||{};t.type="normal",t.arg=n,e[4]=t}function q(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function S(t){if(null!=t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(i.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=n,e.done=!0,e};return a.next=a}}throw new TypeError(e(t)+" is not iterable")}return y.prototype=h,l(w,"constructor",h),l(h,"constructor",y),l(h,u,y.displayName="GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,l(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},r.awrap=function(e){return{__await:e}},x(E.prototype),l(E.prototype,s,(function(){return this})),r.AsyncIterator=E,r.async=function(e,t,n,o,i){void 0===i&&(i=Promise);var a=new E(p(e,t,n,o),i);return r.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(w),l(w,u,"Generator"),l(w,c,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},r.values=S,q.prototype={constructor:q,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n){a.type="throw",a.arg=e,t.next=n}for(var o=t.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=n,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),I(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;I(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={i:S(e),r:t,n:r},"next"===this.method&&(this.arg=n),f}},r}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var a=e.apply(t,n);function c(e){r(a,o,i,c,s,"next",e)}function s(e){r(a,o,i,c,s,"throw",e)}c(void 0)}))}}var i={baseUrl:"https://starling.yourdomain.com/api/v1",timeout:3e4,headers:{"Content-Type":"application/json",Authorization:"Bearer dev-token"}},a={"content-management":{music:[{name:"entity_name",label:"Entity Name",type:"text",required:!0,description:"Name of the contracting entity"},{name:"content_creator",label:"Content Creator",type:"text",required:!0,description:"Name of the content creator/artist"},{name:"scope_description",label:"Scope of Work",type:"textarea",required:!0,description:"Detailed description of content management services"},{name:"revenue_split",label:"Revenue Split (%)",type:"number",required:!0,description:"Percentage split for revenue sharing"},{name:"term_length",label:"Contract Term",type:"select",required:!0,options:["1 year","2 years","3 years","5 years"],description:"Duration of the agreement"},{name:"territory",label:"Territory",type:"select",required:!0,options:["Worldwide","North America","United States","Canada","Other"],description:"Geographic scope of the agreement"},{name:"music_rights",label:"Music Rights",type:"select",required:!0,options:["Master Rights","Publishing Rights","Both","Synchronization Only"],description:"Type of music rights being managed"},{name:"advance_amount",label:"Advance Amount ($)",type:"number",required:!1,description:"Initial advance payment (if applicable)"},{name:"termination_notice",label:"Termination Notice (days)",type:"number",required:!0,description:"Notice period required for termination"}],"non-music":[{name:"entity_name",label:"Entity Name",type:"text",required:!0,description:"Name of the contracting entity"},{name:"content_creator",label:"Content Creator",type:"text",required:!0,description:"Name of the content creator"},{name:"scope_description",label:"Scope of Work",type:"textarea",required:!0,description:"Detailed description of content management services"},{name:"revenue_split",label:"Revenue Split (%)",type:"number",required:!0,description:"Percentage split for revenue sharing"},{name:"term_length",label:"Contract Term",type:"select",required:!0,options:["1 year","2 years","3 years","5 years"],description:"Duration of the agreement"},{name:"territory",label:"Territory",type:"select",required:!0,options:["Worldwide","North America","United States","Canada","Other"],description:"Geographic scope of the agreement"},{name:"content_type",label:"Content Type",type:"select",required:!0,options:["Video Content","Podcast","Written Content","Social Media","Mixed Media"],description:"Type of content being managed"},{name:"platform_focus",label:"Platform Focus",type:"select",required:!0,options:["YouTube","TikTok","Instagram","Multi-Platform","Other"],description:"Primary platform for content distribution"},{name:"termination_notice",label:"Termination Notice (days)",type:"number",required:!0,description:"Notice period required for termination"}],both:[{name:"entity_name",label:"Entity Name",type:"text",required:!0,description:"Name of the contracting entity"},{name:"content_creator",label:"Content Creator",type:"text",required:!0,description:"Name of the content creator/artist"},{name:"scope_description",label:"Scope of Work",type:"textarea",required:!0,description:"Detailed description of content management services"},{name:"revenue_split_music",label:"Music Revenue Split (%)",type:"number",required:!0,description:"Percentage split for music revenue"},{name:"revenue_split_content",label:"Content Revenue Split (%)",type:"number",required:!0,description:"Percentage split for non-music content revenue"},{name:"term_length",label:"Contract Term",type:"select",required:!0,options:["1 year","2 years","3 years","5 years"],description:"Duration of the agreement"},{name:"territory",label:"Territory",type:"select",required:!0,options:["Worldwide","North America","United States","Canada","Other"],description:"Geographic scope of the agreement"},{name:"music_rights",label:"Music Rights",type:"select",required:!0,options:["Master Rights","Publishing Rights","Both","Synchronization Only"],description:"Type of music rights being managed"},{name:"content_platforms",label:"Content Platforms",type:"select",required:!0,options:["YouTube","TikTok","Instagram","Multi-Platform","Other"],description:"Primary platforms for content distribution"},{name:"termination_notice",label:"Termination Notice (days)",type:"number",required:!0,description:"Notice period required for termination"}]}};function c(){var e=document.getElementById("agreement-type").value,t=document.getElementById("content-type-group"),n=document.getElementById("dynamic-form"),r=document.getElementById("generate-button-group");e?(t.style.display="block",document.getElementById("content-type").value="",n.style.display="none",r.style.display="none"):(t.style.display="none",n.style.display="none",r.style.display="none")}function s(){var e=document.getElementById("agreement-type").value,t=document.getElementById("content-type").value,n=document.getElementById("dynamic-form"),r=document.getElementById("generate-button-group");e&&t?(function(e,t){var n,r=document.getElementById("dynamic-form"),o=null===(n=a[e])||void 0===n?void 0:n[t];if(o){var i='<h3 class="ms-font-l">Contract Details</h3>';o.forEach((function(e){var t=e.required?"required-field":"",n=e.required?"required":"";if(i+='<div class="form-field '.concat(t,'">'),i+='<label for="'.concat(e.name,'">').concat(e.label,":</label>"),"textarea"===e.type)i+='<textarea id="'.concat(e.name,'" name="').concat(e.name,'" ').concat(n,' placeholder="Enter ').concat(e.label.toLowerCase(),'"></textarea>');else if("select"===e.type)i+='<select id="'.concat(e.name,'" name="').concat(e.name,'" ').concat(n,">"),i+='<option value="">Select '.concat(e.label,"</option>"),e.options.forEach((function(e){i+='<option value="'.concat(e,'">').concat(e,"</option>")})),i+="</select>";else{var r="number"===e.type?"number":"text";i+='<input type="'.concat(r,'" id="').concat(e.name,'" name="').concat(e.name,'" ').concat(n,' placeholder="Enter ').concat(e.label.toLowerCase(),'">')}e.description&&(i+='<div class="field-description">'.concat(e.description,"</div>")),i+="</div>"})),r.innerHTML=i}else r.innerHTML='<p class="ms-font-s">Form template not available for this combination.</p>'}(e,t),n.style.display="block",r.style.display="block"):(n.style.display="none",r.style.display="none")}function u(){return l.apply(this,arguments)}function l(){return(l=o(t().mark((function e(){var n,r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g("Generating contract...","info"),v("Collecting form data..."),e.prev=2,d(n=p())){e.next=6;break}throw new Error("Please fill in all required fields");case 6:return v("Generating contract with AI..."),e.next=9,f(n);case 9:return r=e.sent,e.next=12,y(r.contract_text);case 12:g("Contract generated successfully!","success"),b(),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),w(e.t0);case 19:case"end":return e.stop()}}),e,null,[[2,16]])})))).apply(this,arguments)}function p(){var e=document.getElementById("agreement-type").value,t=document.getElementById("content-type").value,n=document.getElementById("dynamic-form"),r={agreement_type:e,content_type:t,fields:{}};return n.querySelectorAll("input, textarea, select").forEach((function(e){e.name&&(r.fields[e.name]=e.value)})),r}function d(e){var t,r=null===(t=a[e.agreement_type])||void 0===t?void 0:t[e.content_type];if(!r)return!1;var o,i=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw a}}}}(r);try{for(i.s();!(o=i.n()).done;){var c=o.value;if(c.required&&(!e.fields[c.name]||""===e.fields[c.name].trim()))return g("Please fill in the required field: ".concat(c.label),"error"),!1}}catch(e){i.e(e)}finally{i.f()}return!0}function f(e){return m.apply(this,arguments)}function m(){return(m=o(t().mark((function e(n){var r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(i.baseUrl,"/generate-contract"),{method:"POST",headers:i.headers,body:JSON.stringify(n)});case 2:if((r=e.sent).ok){e.next=5;break}throw new Error("Contract generation failed: ".concat(r.status," ").concat(r.statusText));case 5:return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return h.apply(this,arguments)}function h(){return h=o(t().mark((function e(n){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=o(t().mark((function e(r){var o,i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=r.document.body).clear(),o.insertText(n,Word.InsertLocation.start),(i=o.getRange()).font.name="Calibri",i.font.size=11,i.paragraphFormat.lineSpacing=1.15,e.next=9,r.sync();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.getElementById("status-message");n.textContent=e,n.className="status-message ms-font-s ".concat(t)}function v(e){var t,n,r;document.getElementById("progress-section").style.display="block",document.getElementById("progress-text").textContent=e,t=0,n=document.getElementById("progress-fill"),r=setInterval((function(){t>=100?clearInterval(r):(t+=5,n.style.width=t+"%")}),100)}function b(){document.getElementById("progress-section").style.display="none"}function w(e){console.error(e),g("Error: ".concat(e.message),"error"),b()}function x(){return E.apply(this,arguments)}function E(){return E=o(t().mark((function e(){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g("Analyzing contract...","info"),v("Extracting document content..."),e.prev=2,e.next=5,Word.run(function(){var e=o(t().mark((function e(n){var r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=n.document.body).load("text"),e.next=4,n.sync();case 4:return e.abrupt("return",r.text);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:if((n=e.sent)&&0!==n.trim().length){e.next=8;break}throw new Error("No content found in document");case 8:return v("Sending to AI for analysis..."),e.next=11,_(n);case 11:r=e.sent,i=void 0,a=void 0,c=void 0,i=document.getElementById("results-section"),a=document.getElementById("results-content"),c='\n    <div class="analysis-summary">\n      <h3>Analysis Summary</h3>\n      <p>'.concat(r.summary,"</p>\n      <p><strong>Compliance Score:</strong> ").concat(r.compliance_score,"/100</p>\n    </div>"),i.style.display="block",a.innerHTML=c,g("Analysis complete","success"),b(),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2),w(e.t0);case 20:case"end":return e.stop()}var r,i,a,c}),e,null,[[2,17]])}))),E.apply(this,arguments)}function _(e){return k.apply(this,arguments)}function k(){return(k=o(t().mark((function e(n){var r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(i.baseUrl,"/analyze"),{method:"POST",headers:i.headers,body:JSON.stringify({content:n,analysis_type:"comprehensive"})});case 2:if((r=e.sent).ok){e.next=5;break}throw new Error("API call failed: ".concat(r.status," ").concat(r.statusText));case 5:return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){g("Generating summary...","info")}function q(){g("Highlighting risks...","info")}function S(){g("Suggesting changes...","info")}function T(){g("Checking compliance...","info")}Office.onReady((function(e){e.host===Office.HostType.Word&&(document.getElementById("agreement-type").onchange=c,document.getElementById("content-type").onchange=s,document.getElementById("generate-contract").onclick=u,document.getElementById("analyze-contract").onclick=x,document.getElementById("generate-summary").onclick=I,document.getElementById("highlight-risks").onclick=q,document.getElementById("suggest-changes").onclick=S,document.getElementById("check-compliance").onclick=T,g("Ready to generate or analyze contracts","info"))}))}();
//# sourceMappingURL=taskpane.js.map