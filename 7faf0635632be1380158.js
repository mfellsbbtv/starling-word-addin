import{initializeTheme,updateStatus,clearResults,clearSuggestions,handleError}from"../shared/utils.js";import{generateContract,analyzeContract,handleAgreementTypeChange,handleContentTypeChange}from"./modules/event-handlers.js";function setupEventListeners(){var e=document.getElementById("generate-contract");e&&e.addEventListener("click",generateContract);var t=document.getElementById("analyze-contract");t&&t.addEventListener("click",analyzeContract);var n=document.getElementById("agreement-type");n&&n.addEventListener("change",handleAgreementTypeChange);var o=document.getElementById("content-type");o&&o.addEventListener("change",handleContentTypeChange);var a=document.getElementById("clear-results");a&&a.addEventListener("click",clearResults);var s=document.getElementById("clear-suggestions");s&&s.addEventListener("click",clearSuggestions);var r=document.getElementById("toggle-track-changes");r&&r.addEventListener("click",toggleTrackChanges);var i=document.getElementById("highlight-risks");i&&i.addEventListener("click",highlightRisks);var l=document.getElementById("check-compliance");l&&l.addEventListener("click",checkCompliance);var d=document.getElementById("suggest-changes");d&&d.addEventListener("click",suggestChanges),console.log("Event listeners set up successfully")}function initializeUI(){var e=document.getElementById("dynamic-form"),t=document.getElementById("generate-button-group"),n=document.getElementById("content-type-group"),o=document.getElementById("results-section"),a=document.getElementById("suggestions-section"),s=document.getElementById("progress-section");e&&(e.style.display="none"),t&&(t.style.display="none"),n&&(n.style.display="none"),o&&(o.style.display="none"),a&&(a.style.display="none"),s&&(s.style.display="none"),updateStatus("Ready to generate or analyze contracts","info"),console.log("UI initialized successfully")}function toggleTrackChanges(){updateStatus("Toggling track changes...","info")}function highlightRisks(){updateStatus("Highlighting risks...","info")}function checkCompliance(){updateStatus("Checking compliance...","info")}function suggestChanges(){updateStatus("Applying suggested changes...","info")}Office.onReady((function(e){if(e.host===Office.HostApplication.Word){if(console.log("RHEI AI Legal Assistant loaded successfully"),"undefined"==typeof Word)return console.error("Word API not available"),void updateStatus("Error: Word API not available. Please refresh the add-in.","error");console.log("Word API is available"),initializeTheme(),setupEventListeners(),initializeUI(),console.log("Add-in initialization complete")}else console.error("This add-in is designed for Microsoft Word only"),updateStatus("Error: This add-in requires Microsoft Word","error")})),window.addEventListener("error",(function(e){console.error("Global error:",e.error),handleError(e.error)})),window.addEventListener("unhandledrejection",(function(e){console.error("Unhandled promise rejection:",e.reason),handleError(e.reason)})),console.log("RHEI AI Legal Assistant module loaded");